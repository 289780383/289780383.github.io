GE.ShowUi=function(t){this.graph=new GE.Graph(t,null,null,null),this.graph.setTooltips(!1),this.graph.setCellsEditable(!1),this.graph.setCellsSelectable(!1),this.graph.setConnectable(!1),this.graph.setCellsMovable(!1),this.graph.setCellsResizable(!1),this.graph.setEnabled(!1),this.graph.setPanning(!1),this.graph.autoScroll=!1,this.graph.centerZoom=!1,this.afterZoomOp={},this.graph.extCellProcess=((t,e)=>!!this.extCellProcess&&this.extCellProcess(t,e));let e=null;const l=new mxCellTracker(this.graph,null,mxUtils.bind(this,function(t){var s=mxCellMarker.prototype.getCell.apply(l,arguments);let o=null;return s&&(o=s.isSub?s.parent:s),e!==o?(e&&e.bindProperties&&this.onMouseLeave&&this.onMouseLeave(e),o&&o.bindProperties&&this.onMouseEnter&&this.onMouseEnter(o),e=o):this.onMouseOver&&o&&o.bindProperties&&this.onMouseOver(o),GE.HIGHLIGHT&&o&&o.bindProperties?o:null}));this.graph.addListener(mxEvent.CLICK,mxUtils.bind(this,function(t,e){if(!this.onClick)return;const l=e.properties.event.button;var s=e.getProperty("cell");if(s)if(s.isSub){if(s.inactive)return;const t=s.parent;t.bindProperties&&t.bindProperties.onClick&&t.bindProperties.onClick(s)&&this.onClick(l,t)}else if(s.bindProperties){if(s.inactive)return;this.onClick(l,s)}}))},GE.ShowUi.prototype.zoom=function(t){if(1===t)this.graph.zoomActual(),this.graph.container.style.width=this.width+"px",this.graph.container.style.height=this.height+"px";else{this.graph.zoomTo(t);const e=this.graph.view.scale;this.graph.container.style.width=this.width*e+"px",this.graph.container.style.height=this.height*e+"px"}for(const t in this.afterZoomOp)this.afterZoomOp[t]()},GE.ShowUi.prototype.zoomWidth=function(t){const e=t/this.width;this.zoom(e);for(const t in this.afterZoomOp)this.afterZoomOp[t]()},GE.ShowUi.prototype.zoomHeight=function(t){const e=t/this.height;this.zoom(e);for(const t in this.afterZoomOp)this.afterZoomOp[t]()},GE.ShowUi.prototype.setGraphXml=function(t,e,l){if(this.afterZoomOp={},this.readableVarCells={},this.graph.getModel().clear(),!t||0===t.length)return;const s=mxUtils.parseXml(t).documentElement,o=s.getAttribute("pageWidth");null!=o&&(this.width=o,this.graph.container.style.width=o+"px");const r=s.getAttribute("pageHeight");null!=r&&(this.height=r,this.graph.container.style.height=r+"px");const a=s.getAttribute("background"),n=s.getAttribute("backgroundImage");l?l(this.graph.container,a,n):(null!=n&&n.length>0?(this.graph.container.style.backgroundImage="url("+n+")",this.graph.container.style.backgroundSize="100% 100%"):this.graph.container.style.backgroundImage="",null!=a&&a.length>0?this.graph.container.style.backgroundColor=a:this.graph.container.style.backgroundColor="#FFF");const i=t=>{const l=t.bindProperties;if("变量"===t.type1){let s=!1,o="";switch(t.type2){case"指针表1":s=!0,o=l.mr0;break;case"风扇1":s=!0,o=l.rotateValue?1-l.rotateValue:0,l.state=0;break;case"文本1":{s=!0,o=t.value;const e=this.graph.getCellStyle(t);l.color.normal={border:mxUtils.getValue(e,mxConstants.STYLE_STROKECOLOR,null),font:mxUtils.getValue(e,mxConstants.STYLE_FONTCOLOR,null),fill:mxUtils.getValue(e,mxConstants.STYLE_FILLCOLOR,null),fill2:mxUtils.getValue(e,mxConstants.STYLE_GRADIENTCOLOR,null)},l.state=0}break;case"选项二1":{s=!0;const e=t.children[0],r=t.children[1];o=l.defaultSel,l.curSel=0;let a=this.graph.getCellStyle(e);const n={border:mxUtils.getValue(a,mxConstants.STYLE_STROKECOLOR,"#99F"),font:mxUtils.getValue(a,mxConstants.STYLE_FONTCOLOR,"#99F"),fill:mxUtils.getValue(a,mxConstants.STYLE_FILLCOLOR,"none")};a=this.graph.getCellStyle(r);const i={border:mxUtils.getValue(a,mxConstants.STYLE_STROKECOLOR,"#99F"),font:mxUtils.getValue(a,mxConstants.STYLE_FONTCOLOR,"#FFF"),fill:mxUtils.getValue(a,mxConstants.STYLE_FILLCOLOR,"#99F")};l.onClick=(e=>{for(let s=0;s<2;s++)if(e===t.children[s]){if(l.curSel!==s)return l.changeOption(),!0;break}return!1}),l.changeOption=(()=>{const e=t.children[l.curSel],s=t.children[1-l.curSel];e.style=mxUtils.setStyle(e.style,mxConstants.STYLE_STROKECOLOR,i.border),e.style=mxUtils.setStyle(e.style,mxConstants.STYLE_FONTCOLOR,i.font),e.style=mxUtils.setStyle(e.style,mxConstants.STYLE_FILLCOLOR,i.fill),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,n.border),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FONTCOLOR,n.font),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,n.fill),this.graph.refreshs([e,s]),l.curSel=1-l.curSel}),l.defaultSel&&l.changeOption()}break;case"水浸绳1":{if(s=!0,o="0.00",l.lens){const t=l.lens;l.lens=[];for(let e=0;e<t.length;e++)l.lens.push(parseFloat(t[e]))}const e=this.graph.getCellStyle(t);l.color.normal={fill:mxUtils.getValue(e,mxConstants.STYLE_FILLCOLOR,"#CC0"),line:mxUtils.getValue(e,mxConstants.STYLE_STROKECOLOR,"#000")},t.water=t.children[0],t.parent.insert(t.water),t.water.visible=!1,t.water.geometry.relative=!1,t.water.geometry.offset.x=0,t.water.geometry.offset.y=0,this.graph.refresh(t.water),l.state=0,l.flag=t.water.value}break;case"流动1":{s=!0;const e=this.graph.getCellStyle(t);l.color.normal=mxUtils.getValue(e,mxConstants.STYLE_STROKECOLOR,"#0F0"),o=l.flowValue?1-l.flowValue:0,l.flow=0,l.state=0}break;case"流动2":{s=!0;const e=this.graph.getCellStyle(t);l.color.normal={fill:mxUtils.getValue(e,mxConstants.STYLE_FILLCOLOR,"#FF0"),line:mxUtils.getValue(e,mxConstants.STYLE_STROKECOLOR,"#00F")};const r=this.graph.view.getState(t).shape.node.getElementsByTagName("path");r[r.length-1].setAttribute("visibility","hidden"),o=l.flowValue?1-l.flowValue:0,l.flow=0,l.state=0}break;case"进度条1":s=!0,o=(Number(l.mr0)+Number(l.mr1))/2}s&&l.varGuid&&(this.readableVarCells[l.varGuid]?this.readableVarCells[l.varGuid].push(t):(e&&e(l.varGuid,o),this.readableVarCells[l.varGuid]=[t]))}else"日期时间"===t.type1&&(t.value=(new Date).format(l.format),this.graph.refresh(t),l.timer=setInterval(()=>{t.value=(new Date).format(l.format),this.graph.refresh(t)},1e3),l.dispose=function(){clearInterval(l.timer)})},m=t=>{if(t.children&&t.children.length>0){const e=t.children;for(let t=0;t<e.length;t++)"group"===e[t].style?m(e[t]):i(e[t])}};this.cells=this.graph.importGraphModel(s,0,0,!1),this.cells&&this.cells.forEach(t=>{"group"===t.style?m(t):i(t)})},GE.ShowUi.prototype.dispose=function(){this.cells&&this.cells.forEach(t=>{const e=t.bindProperties;e&&e.dispose&&e.dispose()})};const createKeyframesRule=function(t,e){var l=Array.from(document.styleSheets).filter(function(t){return!t.href||t.href.startsWith(window.location.origin)});if(0===l.length){const t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),void t.insertRule(e)}for(var s=0;s<l.length;++s)for(var o=0;o<l[s].cssRules.length;++o)if(l[s].cssRules[o].type===window.CSSRule.KEYFRAMES_RULE&&l[s].cssRules[o].name===t)return;l[0].insertRule(e)};GE.ShowUi.prototype.setVarData=function(t){if(!this.readableVarCells)return!1;const e=this.readableVarCells[t.guid];if(!e)return!1;for(let l=0;l<e.length;l++){const s=e[l],o=s.bindProperties;switch(s.type2){case"指针表1":{if(t.value&&s.value!==t.value){s.value=t.value;const e=()=>{const t=this.graph.view.getState(s);document.getElementById(t.JAID+"_V").innerHTML=s.value;const e=document.getElementById(t.JAID+"_C"),l=e.getAttribute("cx"),r=e.getAttribute("cy");let a=Number(s.value);const n=Number(o.mr0),i=Number(o.mr1);let m;isNaN(a)&&(a=n),s.type3&&1!==s.type3?2===s.type3&&(m=203.5):m=270;var h=(a-n)*(m/Math.abs(i-n)),c=null;c=a<n?"rotate(0 "+l+" "+r+") ":a>i?"rotate("+m+" "+l+" "+r+") ":"rotate("+h+" "+l+" "+r+") ",s.type3<2&&(o.oldTransfrom||(o.oldTransfrom=document.getElementById(t.JAID+"_P").getAttribute("transform")),c+=o.oldTransfrom),document.getElementById(t.JAID+"_P").setAttribute("transform",c)};e(),this.afterZoomOp[s.id]=e}let e=0;if(t.alarm&&t.alarm.level>0?e=1:t.commErr&&(e=2),o.state!==e)if(o.state=e,1===e){const t=()=>{const t=this.graph.view.getState(s),e=document.getElementById(t.JAID+"_V"),l=document.getElementById(t.JAID+"_VB");o.color.normal||(o.color.normal={border:l.getAttribute("stroke"),fill:l.getAttribute("fill"),font:e.getAttribute("fill")}),l.setAttribute("stroke",o.color.alarm.border),l.setAttribute("fill",o.color.alarm.fill),e.setAttribute("fill",o.color.alarm.font);const r=document.getElementById(t.JAID+"_A");r.setAttribute("repeatCount","indefinite"),r.setAttribute("restart","always"),r.beginElement()};t(),this.afterZoomOp["C"+s.id]=t}else if(2===e){const t=()=>{const t=this.graph.view.getState(s),e=document.getElementById(t.JAID+"_V"),l=document.getElementById(t.JAID+"_VB");o.color.normal||(o.color.normal={border:l.getAttribute("stroke"),fill:l.getAttribute("fill"),font:e.getAttribute("fill")}),l.setAttribute("stroke",o.color.commErr.border),l.setAttribute("fill",o.color.commErr.fill),e.setAttribute("fill",o.color.commErr.font);const r=document.getElementById(t.JAID+"_A");r.setAttribute("repeatCount",""),r.setAttribute("restart",""),r.beginElement()};t(),this.afterZoomOp["C"+s.id]=t}else{const t=this.graph.view.getState(s);if(o.color.normal){const e=document.getElementById(t.JAID+"_V"),l=document.getElementById(t.JAID+"_VB");l.setAttribute("stroke",o.color.normal.border),l.setAttribute("fill",o.color.normal.fill),e.setAttribute("fill",o.color.normal.font)}const e=document.getElementById(t.JAID+"_A");e.setAttribute("repeatCount",""),e.setAttribute("restart",""),e.beginElement(),this.afterZoomOp["C"+s.id]&&delete this.afterZoomOp["C"+s.id]}}break;case"风扇1":if(t.value)if(t.guid.startsWith("@")){if(1==t.value&&1!==o.rotate){const t=()=>{const t=this.graph.view.getState(s),e=document.getElementById(t.JAID);createKeyframesRule("varfan1","@keyframes varfan1 {\n              0%{\n                transform: rotate(0deg);\n                transform-origin: 50% 50%;\n              }\n              100%{\n                transform: rotate(360deg);\n                transform-origin: 50% 50%;\n              }\n            }"),e.style.animation="varfan1 2s linear 0s infinite"};t(),this.afterZoomOp[s.id]=t,o.rotate=1}else if(-1==t.value&&-1!==o.rotate){const t=()=>{const t=this.graph.view.getState(s),e=document.getElementById(t.JAID);createKeyframesRule("varfan-1","@keyframes varfan-1 {\n              0%{\n                transform: rotate(360deg);\n                transform-origin: 50% 50%;\n              }\n              100%{\n                transform: rotate(0deg);\n                transform-origin: 50% 50%;\n              }\n            }"),e.style.animation="varfan-1 2s linear 0s infinite"};t(),this.afterZoomOp[s.id]=t,o.rotate=1}else if(0==t.value&&0!==o.rotate){const t=this.graph.view.getState(s);document.getElementById(t.JAID).style.animation="",this.afterZoomOp[s.id]&&delete this.afterZoomOp[s.id],o.rotate=0}}else if(t.value==o.rotateValue&&1!==o.rotate){const t=()=>{const t=this.graph.view.getState(s),e=document.getElementById(t.JAID);createKeyframesRule("varfan1","@keyframes varfan1 {\n              0%{\n                transform: rotate(0deg);\n                transform-origin: 50% 50%;\n              }\n              100%{\n                transform: rotate(360deg);\n                transform-origin: 50% 50%;\n              }\n            }"),e.style.animation="varfan1 2s linear 0s infinite"};t(),this.afterZoomOp[s.id]=t,o.rotate=1}else if(t.value!=o.rotateValue&&1===o.rotate){const t=this.graph.view.getState(s);document.getElementById(t.JAID).style.animation="",this.afterZoomOp[s.id]&&delete this.afterZoomOp[s.id],o.rotate=0}break;case"文本1":{let e=!1;t.description?s.value!==t.description&&(s.value=t.description,e=!0):t.value&&s.value!==t.value&&(s.value=t.value,e=!0);let l=0;t.alarm&&t.alarm.level>0?l=1:t.commErr&&(l=2),o.state!==l&&(1===l?(o.color.alarm.border&&"none"!==o.color.alarm.border?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.alarm.border):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,null),o.color.alarm.font&&"none"!==o.color.alarm.font?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FONTCOLOR,o.color.alarm.font):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FONTCOLOR,null),o.color.alarm.fill&&"none"!==o.color.alarm.fill?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.alarm.fill):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,null),o.color.alarm.fill2&&"none"!==o.color.alarm.fill2?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_GRADIENTCOLOR,o.color.alarm.fill2):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_GRADIENTCOLOR,null)):2===l?(o.color.commErr.border&&"none"!==o.color.commErr.border?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.commErr.border):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,null),o.color.commErr.font&&"none"!==o.color.commErr.font?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FONTCOLOR,o.color.commErr.font):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FONTCOLOR,null),o.color.commErr.fill&&"none"!==o.color.commErr.fill?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.commErr.fill):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,null),o.color.commErr.fill2&&"none"!==o.color.commErr.fill2?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_GRADIENTCOLOR,o.color.commErr.fill2):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_GRADIENTCOLOR,null)):(o.color.normal.border&&"none"!==o.color.normal.border?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.normal.border):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,null),o.color.normal.font&&"none"!==o.color.normal.font?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FONTCOLOR,o.color.normal.font):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FONTCOLOR,null),o.color.normal.fill&&"none"!==o.color.normal.fill?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.normal.fill):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,null),o.color.normal.fill2&&"none"!==o.color.normal.fill2?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_GRADIENTCOLOR,o.color.normal.fill2):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_GRADIENTCOLOR,null)),o.state=l,e=!0),t.color&&(t.color.border&&("none"!==t.color.border?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,t.color.border):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,null),e=!0),t.color.font&&("none"!==t.color.font?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FONTCOLOR,t.color.font):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FONTCOLOR,null),e=!0),t.color.fill&&("none"!==t.color.fill?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,t.color.fill):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,null),e=!0),t.color.fill2&&("none"!==t.color.fill2?s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_GRADIENTCOLOR,t.color.fill2):s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_GRADIENTCOLOR,null),e=!0)),e&&this.graph.refresh(s)}break;case"选项二1":t.value&&o.curSel!=t.value&&o.changeOption();break;case"水浸绳1":{const e=s.water;let l=!1,r=!1,a=0;if(t.alarm&&t.alarm.level>0?a=1:t.commErr&&(a=2),1===a&&t.value&&t.value!==o.value){o.value=t.value;const r=o.lens,a=parseFloat(t.value);if(a>=r[r.length-1])e.geometry.x=s.geometry.targetPoint.x-e.geometry.width/2,e.geometry.y=s.geometry.targetPoint.y-e.geometry.height/2;else if(a<=0)e.geometry.x=s.geometry.sourcePoint.x-e.geometry.width/2,e.geometry.y=s.geometry.sourcePoint.y-e.geometry.height/2;else{let t=s.geometry.sourcePoint,l=0,o=!1;for(let n=0;n<r.length-1;n++){if(a<=r[n]){const i=s.geometry.points[n];e.geometry.x=(i.x-t.x)*(a-l)/(r[n]-l)+t.x-e.geometry.width/2,e.geometry.y=(i.y-t.y)*(a-l)/(r[n]-l)+t.y-e.geometry.height/2,o=!0;break}t=s.geometry.points[n],l=r[n]}if(!o){const o=s.geometry.targetPoint;e.geometry.x=(o.x-t.x)*(a-l)/(r[r.length-1]-l)+t.x-e.geometry.width/2,e.geometry.y=(o.y-t.y)*(a-l)/(r[r.length-1]-l)+t.y-e.geometry.height/2}}e.visible=!0,l=!0}if(a!==o.state){switch(1===o.state?(e.visible=!1,l=!0):1===a&&(e.visible=!0,l=!0),a){case 0:o.timer&&(clearInterval(o.timer),o.timer=null,o.dispose=null),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.normal.fill),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.normal.line),r=!0;break;case 1:e.value="",s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.alarm.fill),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.alarm.line),o.timer&&clearInterval(o.timer),o.twinkle=!1,o.timer=setInterval(()=>{o.twinkle?(e.value="",s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.alarm.fill),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.alarm.line)):(e.value=o.flag,s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.normal.fill),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.normal.line)),this.graph.refreshs([e,s]),o.twinkle=!o.twinkle},500),o.dispose=function(){clearInterval(o.timer)},r=!0,l=!0;break;case 2:s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.commErr.fill),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.commErr.line),o.timer&&clearInterval(o.timer),o.twinkle=!1,o.timer=setInterval(()=>{o.twinkle?(s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.commErr.fill),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.commErr.line)):(s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.normal.fill),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.normal.line)),this.graph.refresh(s),o.twinkle=!o.twinkle},500),o.dispose=function(){clearInterval(o.timer)},r=!0}o.state=a}l&&r?this.graph.refreshs([e,s]):l?this.graph.refresh(e):r&&this.graph.refresh(s)}break;case"流动1":{let e=0;if(t.alarm&&t.alarm.level>0?e=1:t.commErr&&(e=2),e!==o.state){switch(e){case 0:s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.normal);break;case 1:s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.alarm);break;case 2:s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.commErr)}this.graph.refresh(s),this.afterZoomOp[s.id]&&this.afterZoomOp[s.id](),o.state=e}if(t.value)if(t.guid.startsWith("@")){if(1==t.value&&1!==o.flow){const t=()=>{const t=this.graph.view.getState(s).shape.node.getElementsByTagName("path")[1],e=parseInt(t.getTotalLength());createKeyframesRule("varflow-"+e+"-"+o.speed,"@keyframes varflow-"+e+" {to{ stroke-dashoffset: -"+e*o.speed+";}}"),t.style.strokeDashoffset=0,t.style.animation="varflow-"+e+" "+e+"s linear",t.style.animationIterationCount="infinite"};t(),this.afterZoomOp[s.id]=t,o.flow=1}else if(-1==t.value&&-1!==o.flow){const t=()=>{const t=this.graph.view.getState(s).shape.node.getElementsByTagName("path")[1],e=parseInt(t.getTotalLength());createKeyframesRule("varflow"+e+"-"+o.speed,"@keyframes varflow"+e+" {to{ stroke-dashoffset: "+e*o.speed+";}}"),t.style.strokeDashoffset=0,t.style.animation="varflow"+e+" "+e+"s linear",t.style.animationIterationCount="infinite"};t(),this.afterZoomOp[s.id]=t,o.flow=-1}else if(0==t.value&&0!==o.flow){this.graph.view.getState(s).shape.node.getElementsByTagName("path")[1].style.animation="",this.afterZoomOp[s.id]&&delete this.afterZoomOp[s.id],o.flow=0}}else if(t.value==o.flowValue&&1!==o.flow){const t=()=>{const t=this.graph.view.getState(s).shape.node.getElementsByTagName("path")[1],e=parseInt(t.getTotalLength());createKeyframesRule("varflow-"+e+"-"+o.speed,"@keyframes varflow-"+e+" {to{ stroke-dashoffset: -"+e*o.speed+";}}"),t.style.strokeDashoffset=0,t.style.animation="varflow-"+e+" "+e+"s linear",t.style.animationIterationCount="infinite"};t(),this.afterZoomOp[s.id]=t,o.flow=1}else if(t.value!=o.flowValue&&1===o.flow){this.graph.view.getState(s).shape.node.getElementsByTagName("path")[1].style.animation="",this.afterZoomOp[s.id]&&delete this.afterZoomOp[s.id],o.flow=0}t.color&&(s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,t.color),this.graph.refresh(s),this.afterZoomOp[s.id]&&this.afterZoomOp[s.id]())}break;case"流动2":{let e=0;if(t.alarm&&t.alarm.level>0?e=1:t.commErr&&(e=2),e!==o.state){switch(e){case 0:s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.normal.fill),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.normal.line);break;case 1:s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.alarm.fill),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.alarm.line);break;case 2:s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,o.color.commErr.fill),s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,o.color.commErr.line)}this.graph.refresh(s),this.afterZoomOp[s.id]&&this.afterZoomOp[s.id](),o.state=e}if(t.value)if(t.guid.startsWith("@")){if(1==t.value&&1!==o.flow){const t=()=>{const t=this.graph.view.getState(s).shape.node.getElementsByTagName("path"),e=t[t.length-1];e.setAttribute("visibility","visible");const l=parseInt(e.getTotalLength()),r="varflow-"+l+"-"+o.speed;createKeyframesRule(r,"@keyframes "+r+" {to{ stroke-dashoffset: -"+l*o.speed+";}}"),e.style.strokeDashoffset=0,e.style.animation=r+" "+l+"s linear",e.style.animationIterationCount="infinite"};t(),this.afterZoomOp[s.id]=t,o.flow=1}else if(-1==t.value&&-1!==o.flow){const t=()=>{const t=this.graph.view.getState(s).shape.node.getElementsByTagName("path"),e=t[t.length-1];e.setAttribute("visibility","visible");const l=parseInt(e.getTotalLength()),r="varflow"+l+"-"+o.speed;createKeyframesRule(r,"@keyframes "+r+" {to{ stroke-dashoffset: "+l*o.speed+";}}"),e.style.strokeDashoffset=0,e.style.animation=r+" "+l+"s linear",e.style.animationIterationCount="infinite"};t(),this.afterZoomOp[s.id]=t,o.flow=-1}else if(0==t.value&&0!==o.flow){const t=this.graph.view.getState(s).shape.node.getElementsByTagName("path"),e=t[t.length-1];e.setAttribute("visibility","hidden"),e.style.animation="",this.afterZoomOp[s.id]&&delete this.afterZoomOp[s.id],o.flow=0}}else if(t.value==o.flowValue&&1!==o.flow){const t=()=>{const t=this.graph.view.getState(s).shape.node.getElementsByTagName("path"),e=t[t.length-1];e.setAttribute("visibility","visible");const l=parseInt(e.getTotalLength()),r="varflow-"+l+"-"+o.speed;createKeyframesRule(r,"@keyframes "+r+" {to{ stroke-dashoffset: -"+l*o.speed+";}}"),e.style.strokeDashoffset=0,e.style.animation=r+" "+l+"s linear",e.style.animationIterationCount="infinite"};t(),this.afterZoomOp[s.id]=t,o.flow=1}else if(t.value!=o.flowValue&&1===o.flow){const t=this.graph.view.getState(s).shape.node.getElementsByTagName("path"),e=t[t.length-1];e.setAttribute("visibility","hidden"),e.style.animation="",this.afterZoomOp[s.id]&&delete this.afterZoomOp[s.id],o.flow=0}if(t.color){let e=!1;t.color.fill&&(s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_FILLCOLOR,t.color.fill),e=!0),t.color.line&&(s.style=mxUtils.setStyle(s.style,mxConstants.STYLE_STROKECOLOR,t.color.line),e=!0),e&&(this.graph.refresh(s),this.afterZoomOp[s.id]&&this.afterZoomOp[s.id]())}}break;case"进度条1":if(t.value&&o.value!==t.value){o.value=t.value;const e=parseFloat(o.mr0),l=parseFloat(o.mr1);let r=Number(t.value);isNaN(r)&&(r=0);let a=0;a=r<=e?0:r>=l?1:(r-e)/(l-e),s.style=mxUtils.setStyle(s.style,"size",a),o.showType?s.value=t.value:s.value=Math.round(100*a)+"%",this.graph.refresh(s)}}}return!0};