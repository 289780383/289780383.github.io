(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-60063045"],{"04e4":function(e,t,a){"use strict";a("2ee3")},"062d":function(e,t,a){"use strict";a.d(t,"a",function(){return o});var i=a("303e"),r=a("acf6");a("1d43"),a("6cd0");function s(e,t){return t.startsWith("@")?t:e.$coreData.g.getVarQualifiedName(t)}var n={"普通":function(e,t,a){if(1===a.custom.type)e.$message.success("跳转到目标页面: "+a.jumpToPage);else if(2===a.custom.type)return void e.$comm.$emit("showDialog",a)},"变量":{"指针表1":function(e,t,a){e.$message.success("click "+t+" 指针表1: "+s(e,a.varGuid))},"风扇1":function(e,t,a){e.$message.success("click "+t+" 风扇1: "+s(e,a.varGuid)+"->"+a.rotateValue)},"文本1":function(e,t,a){a.varGuid&&e.$comm.$emit("showHistory",a)},"水浸绳1":function(e,t,a){e.$message.success("click "+t+" 水浸绳1: "+s(e,a.varGuid))},"流动1":function(e,t,a){e.$message.success("click "+t+" 流动1: "+s(e,a.varGuid)+"->"+a.flowValue)},"遥控1":function(e,t,a){e.$message.success("click "+t+" 遥控1: "+s(e,a.varGuid)+"->"+a.ykValue)},"进度条1":function(e,t,a){e.$message.success("click "+t+" 进度条1: "+s(e,a.varGuid))},"选项二1":function(e,t,a){e.$message.success("click "+t+" 选项二1: "+s(e,a.varGuid)+"->"+a.curSel)}},"外部扩展":function(e,t,a){e.$message.success("click "+t+" 外部扩展: "+a.name)}};var o=function(){function e(t,a){var r=this;Object(i.a)(this,e),this.self=a,a.isInteractive?this.enableMouseEvent=!0:this.enableMouseEvent=!1,this.showUi=new GE.ShowUi(t),this.extCells={},this.showUi.extCellProcess=function(e,t){var a=t.name,i=r.extCells[a];return!i&&(r.extCells[a]=i={name:a},!1)},this.showUi.onClick=function(e,t){var a;r.enableMouseEvent&&(2!=e&&(t.type1?(a=n[t.type1],t.type2&&(a=a[t.type2])):a=n.普通,a&&a(r.self,e,t.bindProperties)))}}return Object(r.a)(e,[{key:"zoom",value:function(e){this.showUi.zoom(e)}},{key:"zoomWidth",value:function(e){this.showUi.zoomWidth(e)}},{key:"zoomHeight",value:function(e){this.showUi.zoomHeight(e)}},{key:"setGraphXml",value:function(e,t){this.dispose(),this.showUi.setGraphXml(e,t)}},{key:"setVarData",value:function(e){this.showUi.setVarData(e)}},{key:"dispose",value:function(){for(var e in this.showUi.dispose(),this.extCells){var t=this.extCells[e];t.dispose&&t.dispose(),delete this.extCells[e]}}}]),e}()},"0925":function(t,a,i){"use strict";i.r(a);i("5b12"),i("9b5f");var r=i("3785"),s=(i("e3b5"),i("b3b0"),i("a5f8"),i("1d43"),i("3bae"),i("3de1")),n={data:function(){return{city:"",cityArr:[],companyName:"",companyArr:[],dataSourceArr:[{name:"所有来源",value:"1,2"},{name:"自动采集",value:"1"},{name:"手动上报",value:"2"}],dataSource:"1,2",organizeName:"",organizeArr:[],progressType:"进行中",progressTypeArr:["进行中","已完结","未开始"],searchValue:"",tableLoading:!1,tableData:[],pageSize:10,currentPage:1,alarnNumJson:{}}},mounted:function(){window.onresize=function(){}},created:function(){},activated:function(){this.getProjectList()},methods:{tableRowClass:function(e){return e.rowIndex%2==1?"rowClass":""},tableRowStyle:function(e){return e.row.riskLevel?{background:e.row.riskLevel}:{background:"#FFFFFF"}},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},searchTableData:function(){var e=this;this.filterData=this.filterData.filter(function(t){return!e.searchValue||t.projectName.toLowerCase().includes(e.searchValue.toLowerCase())})},getProjectList:function(){var e=this;this.$axios({method:"get",headers:{},url:"web/project/queryProject"}).then(function(t){var a=t.data;if(0==a.code){for(var i,n,o=a.info,l=[],c=[],u=[],d=0;d<o.length;d++)if(o[d].stationGuid){e.alarnNumJson[o[d].stationGuid]?o[d].alarmNum=e.alarnNumJson[o[d].stationGuid]:o[d].alarmNum=0,o[d].city?-1==l.indexOf(o[d].city)&&l.push(o[d].city):o[d].city="-";var m=o[d].organizes;o[d].companyName="-";for(var h=0;h<m.length;h++)if(1!=m[h].pId&&0!=m[h].pId&&1==m[h].type){o[d].company=JSON.parse(JSON.stringify(m[h])),o[d].companyName=JSON.parse(JSON.stringify(m[h].name));break}"-"!=o[d].companyName&&-1==c.indexOf(o[d].companyName)&&c.push(o[d].companyName);var p=void 0,f=void 0;if(o[d].realityStartTime&&o[d].realityEndTime?(p=parseInt(new Date(o[d].realityStartTime).getTime()/1e3),f=parseInt(new Date(o[d].realityEndTime).getTime()/1e3)):o[d].planStartTime&&o[d].planEndTime?(p=parseInt(new Date(o[d].planStartTime).getTime()/1e3),f=parseInt(new Date(o[d].planEndTime).getTime()/1e3)):(p=o[d].startTime,f=o[d].endTime),p&&f){var g=Object(s.f)(p,f);o[d].progress=g,o[d].progressType=g<100&&g>0?"进行中":100==g?"已完结":"未开始"}else o[d].progress="无",o[d].progressType="未开始",arr2.push(o[d]);var v=o[d].allTime;if(v){var b=e.doSteps(JSON.parse(v));o[d].steps=b.steps,o[d].currentStep=b.currentStep,7==b.currentStep&&(o[d].progress=100,o[d].progressType="已完结")}else o[d].steps=[{name:"进场",time:"",step:0},{name:"结束",time:"",step:6}],o[d].currentStep=-1;o[d].projectName||(o[d].projectName="-"),u.push(o[d])}var y=u.sort(function(e,t){return e.companyName.localeCompare(t.companyName)});e.tableData=y.sort(function(e,t){return e.companyName==t.companyName?e.city.localeCompare(t.city):0}),e.cityArr=(i=l,Object(r.a)(i),i),e.companyArr=(n=c,Object(r.a)(n),n),e.getAlarmNum()}}).catch(function(e){})},getAlarmNum:function(){var e=this.$store.state.g_currentAlarmVar;for(var t in e)this.alarnNumJson[t]=e[t].length;if(this.tableData.length>0)for(var a=0;a<this.tableData.length;a++){var i=this.tableData[a];this.alarnNumJson[i.stationGuid]?i.alarmNum=this.alarnNumJson[i.stationGuid]:i.alarmNum=0,this.$set(this.tableData,a,i)}},doSteps:function(e){for(var t=-1,a=[],i=(new Date).getTime(),r=e.length-1;r>=0;r--)if(e[r].time&&i>=new Date(e[r].time).getTime()){t=r+1;break}return t-1>0&&t-1<e.length-1?(a=[e[0],e[t-1],e[e.length-1]],t=2):a=[e[0],e[e.length-1]],{steps:a,currentStep:t}},tableRowDbclick:function(e,t,a){var i,r;e.stationGuid&&e.projectId?(e.projectFun.forEach(function(e){1==e.type&&(i=e.value)}),e.allTime&&(r=JSON.parse(e.allTime)[2].time),this.$store.commit("set_freezenStation",{id:e.projectId,name:e.projectName,stationGuid:e.stationGuid,rights:i,realityStartTime:e.realityStartTime,freezeTime:r,startTime:Object(s.b)(parseInt(e.startTime+"000")),riskLevel:e.riskLevel?e.riskLevel:"#FFFFFF",dataSource:e.dataSource}),this.$emit("changeComponent","displayBoard")):this.$message({message:"该项目未绑定站点",type:"warning"})},indexMethod:function(e){return this.pageSize*(this.currentPage-1)+e+1},tableSortChange:function(e){"city"==e.prop&&(this.tableData=this.tableData.sort(function(t,a){var i=t.city.localeCompare(a.city);return"descending"==e.order&&0!=i&&(i=i>0?-1:1),i}))}}},o=(i("c72d"),i("5d22")),l=Object(o.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"freezeData"},[a("div",{staticClass:"contentDiv"},[a("div",{staticClass:"topDiv"},[a("el-select",{staticClass:"selectDiv",staticStyle:{"margin-left":"0"},attrs:{clearable:"",placeholder:"城市"},model:{value:e.city,callback:function(t){e.city=t},expression:"city"}},e._l(e.cityArr,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1),a("el-select",{staticClass:"selectDiv",attrs:{clearable:"",placeholder:"单位"},model:{value:e.companyName,callback:function(t){e.companyName=t},expression:"companyName"}},e._l(e.companyArr,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1),a("el-select",{staticClass:"selectDiv",attrs:{clearable:"",placeholder:"进度"},model:{value:e.progressType,callback:function(t){e.progressType=t},expression:"progressType"}},e._l(e.progressTypeArr,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1),a("el-select",{staticClass:"selectDiv",attrs:{placeholder:"数据来源"},model:{value:e.dataSource,callback:function(t){e.dataSource=t},expression:"dataSource"}},e._l(e.dataSourceArr,function(e,t){return a("el-option",{key:e.name+t,attrs:{label:e.name,value:e.value}})}),1),a("el-input",{staticStyle:{width:"20%",float:"right"},attrs:{placeholder:"请输入搜索内容"},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),a("div",{staticClass:"tableDiv"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"stationListTable",staticStyle:{width:"100%",cursor:"pointer"},attrs:{data:e.tableData.filter(function(t){return t.city.toLowerCase().includes(e.city.toLowerCase())&&t.progressType.toLowerCase().includes(e.progressType.toLowerCase())&&t.projectName.toLowerCase().includes(e.searchValue.toLowerCase())&&t.companyName.toLowerCase().includes(e.companyName.toLowerCase())&&e.dataSource.includes(t.dataSource.toString())}).slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),"header-cell-style":{background:"rgb(23, 115, 225)",color:"white"},"row-style":e.tableRowStyle,height:"90%"},on:{"row-dblclick":e.tableRowDbclick,"sort-change":e.tableSortChange}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,align:"center",width:"50",label:"序号"}}),a("el-table-column",{attrs:{align:"center",label:"城市",prop:"city",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.city))]}}])}),a("el-table-column",{attrs:{align:"center",label:"单位",prop:"companyName",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.companyName))]}}])}),a("el-table-column",{attrs:{align:"center",label:"项目名称",prop:"projectName",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center"}},[2==t.row.dataSource?a("span",{staticClass:"el-icon-thumb"}):e._e(),a("span",[e._v(e._s(t.row.projectName))]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.row.alarmNum>0,expression:"scope.row.alarmNum > 0"}],staticStyle:{color:"red"}},[e._v("("+e._s(t.row.alarmNum)+")")])])]}}])}),a("el-table-column",{attrs:{align:"center",label:"进度",sortable:"",prop:"progress"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{display:"flex",flex:"1 1 0%","align-items":"center","justify-content":"center"}},[a("span",{staticStyle:{height:"23px",flex:"0.1"}},[e._v(e._s(t.row.progress)+"%")]),t.row.steps.length>0?a("el-steps",{staticStyle:{flex:"0.9"},attrs:{active:t.row.currentStep,"align-center":""}},e._l(t.row.steps,function(e,t){return a("el-step",{key:e.name+t,attrs:{title:e.name,description:e.time}})}),1):e._e()],1)]}}])})],1),a("el-pagination",{staticStyle:{float:"right","margin-top":"0.1rem"},attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.tableData.filter(function(t){return t.city.toLowerCase().includes(e.city.toLowerCase())&&t.progressType.toLowerCase().includes(e.progressType.toLowerCase())&&t.projectName.toLowerCase().includes(e.searchValue.toLowerCase())&&t.companyName.toLowerCase().includes(e.companyName.toLowerCase())&&e.dataSource.includes(t.dataSource.toString())}).length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])])},[],!1,null,null,null).exports,c=i("58c8"),u=(i("62f9"),i("27ae"),i("d447"),i("bf2f"),i("3337"),i("16ca"),{data:function(){return{station:{id:"",name:"",stationGuid:""},varList:[],config:{},leftValveData:[],rightValveData:[],frontTemperatureData:[],backTemperatureData:[],goTemperature:{data:{v:"0.00"}},comeTemperature:{data:{v:"0.00"}},temperatureChart:null,imgUrl:{front:"",back:""},chartDialogVisible:!1,defaultChart:null,defaultVarArr:[],defaultXData:[],defaultLegendData:[],defaultSeriesData:[],dialogChart:null,queryTimeRange:["",""],timeEditable:!1,pickerOptions:{disabledDate:function(e){return e.getTime()>(new Date).getTime()}},selectedVarArr:[],timeSpanArr:[],xData:[],legendData:[],seriesData:[],isRefreshDialog:!1,spaceType:3600,spaceTypeArr:[{value:3600,label:"整点"},{value:600,label:"全部"},{value:86400,label:"整天"}],alarmData:{},alarmStateJson:{3:"报警",4:"报警确认"},defauldVarGuids:"",modifyDialogVisible:!1,displayNameObj:{leftValveName:"左阀",rightValveName:"右阀",frontSideName:"左线测温孔",backSideName:"右线测温孔"},modifyName:{name:"",key:""},currentAlarmObj:{}}},computed:{webSocketData:function(){return this.$store.state.g_newRealData}},watch:{webSocketData:function(e,t){if(this.station.stationGuid==e.stationGuid){var a={v:e.value,vTime:e.valueTime?Object(s.c)(parseInt(e.valueTime+"000")):"",commStateTime:e.commStateTime?Object(s.c)(parseInt(e.commStateTime+"000")):"",commState:e.commState,commStateClass:1!=e.commState?"commStateError":""},i=!1;e.alarmState>2&&(a.alarmStateTime=e.alarmStateTime>2?Object(s.c)(parseInt(e.alarmStateTime+"000")):"",a.alarmStateDes=this.alarmStateJson[e.alarmState],i=!0),this.updateData(i,a,e.varGuid)}},newAlarmData:function(e,t){if(this.station.id==e.stationGuid){e.recordState;e.recordStateDes=this.recordState[e.recordState],e.alarmTime=Object(s.c)(parseInt(e.alarmTime+"000")),e.confirmTime&&(e.confirmTime=Object(s.c)(parseInt(e.confirmTime+"000")));var a={isAlarm:e.recordState<3,alarmInfo:e};this.updateData(!0,a,e.varGuid)}}},mounted:function(){var e=this;this.station=this.$store.state.freezenStation;var t=this.$store.state.g_currentAlarmVar[this.station.stationGuid];t&&t.length>0&&t.forEach(function(t){e.currentAlarmObj[t.varGuid]=t}),this.getProjectConfig(),this.getDisplayName(),this.imgUrl.front="/uploadFile/"+this.station.id+"/img/front.jpg?_t="+(new Date).getTime(),this.imgUrl.back="/uploadFile/"+this.station.id+"/img/back.jpg?_t="+(new Date).getTime(),this.queryTimeRange[0]=this.getLateDays(1),this.queryTimeRange[1]=this.getLateDays(0),this.front},methods:{updateData:function(e,t,a){for(var i=0;i<this.leftValveData.length;i++)if(this.leftValveData[i].varGuid==a){var r=this.leftValveData[i];Object.assign(r.data,t),r.isAlarm=e,this.$set(this.leftValveData,i,r);break}for(var s=0;s<this.rightValveData.length;s++)if(this.rightValveData[s].varGuid==a){var n=this.rightValveData[s];Object.assign(n.data,t),n.isAlarm=e,this.$set(this.rightValveData,s,n);break}for(var o=0;o<this.frontTemperatureData.length;o++)for(var l=this.frontTemperatureData[o].varData,c=0;c<l.length;c++)if(l[c].varGuid==a){var u=l[c];Object.assign(u.data,t),u.isAlarm=e,this.$set(this.frontTemperatureData[o].varData,c,u);break}for(var d=0;d<this.backTemperatureData.length;d++)for(var m=this.backTemperatureData[d].varData,h=0;h<m.length;h++)if(m[h].varGuid==a){var p=m[h];Object.assign(p.data,t),p.isAlarm=e,this.$set(this.backTemperatureData[d].varData,h,p);break}if(this.goTemperature.varGuid==a){var f=JSON.parse(JSON.stringify(this.goTemperature));f.isAlarm=e,Object.assign(f.data,t),this.goTemperature=f}if(this.comeTemperature.varGuid==a){var g=JSON.parse(JSON.stringify(this.comeTemperature));g.isAlarm=e,Object.assign(g.data,t),this.comeTemperature=g}},getProjectConfig:function(){var e=this;this.$axios({method:"get",headers:{},url:"web/project/queryProjectConfig",params:{projectId:this.station.id,type:1}}).then(function(t){var a=t.data;if(0==a.code&&a.info){var i=JSON.parse(a.info);i.goSide&&i.goSide.varGuid&&e.defaultVarArr.push({varGuid:i.goSide.varGuid,varName:"去路温度",devName:""}),i.comeSide&&i.comeSide.varGuid&&e.defaultVarArr.push({varGuid:i.comeSide.varGuid,varName:"回路温度",devName:""}),e.getRealDataByConfig(i);var r="";e.defaultVarArr.forEach(function(e){r=r+e.varGuid+","}),r=r.substring(0,r.length-1),e.getDefaultChartData(r),e.defauldVarGuids=r}}).catch(function(e){})},getManualProjectData:function(e){this.$axios({method:"get",headers:{},url:"web/realdata/getManualHisData",params:{stationGuid:this.station.stationGuid}}).then(function(e){e.data.code}).catch(function(e){})},getRealDataByConfig:function(e){var t,a,i,n,o=JSON.parse(JSON.stringify(this.$store.state.g_realData.devs[this.station.stationGuid])),l=[],c=[],u=[],d=Object.keys(e.frontVarsJson),m=[],h=Object.keys(e.backVarsJson);if(o&&o.length>0)for(var p=0;p<o.length;p++){o[p].varData=[];var f=d.indexOf(o[p].devGuid);-1!=f&&(u[f]=o[p]);var g=h.indexOf(o[p].devGuid);-1!=g&&(m[g]=o[p])}var v=JSON.parse(JSON.stringify(this.$store.state.g_realData.vars[this.station.stationGuid])),b=[],y=[],w=e.leftVarsArr,S=e.rightVarsArr,C=e.frontVarsJson,T=e.backVarsJson;if(v&&v.length>0){for(var D,k=0;k<v.length;k++){v[k].aliasVarName&&(v[k].varName=v[k].aliasVarName);var _=v[k].devGuid,x=v[k].varGuid;v[k].data.alarmState>2?(v[k].isAlarm=!0,v[k].data.alarmStateDes=this.alarmStateJson[v[k].data.alarmState],v[k].data.alarmContent=this.currentAlarmObj[v[k].varGuid]?this.currentAlarmObj[v[k].varGuid].content:"",v[k].data.alarmStateTime&&(v[k].data.alarmStateTime=Object(s.c)(parseInt(v[k].data.alarmStateTime+"000")))):v[k].isAlarm=!1,v[k].data.vtime&&(v[k].data.vTime=Object(s.c)(parseInt(v[k].data.vtime+"000"))),1!=v[k].data.commState?(v[k].data.commStateClass="commStateError",this.station.dataSource&&2==this.station.dataSource&&(v[k].data.commStateClass="")):v[k].data.commStateClass="",x==e.goSide.varGuid&&(this.goTemperature=v[k]),x==e.comeSide.varGuid&&(this.comeTemperature=v[k]),_==e.leftSide&&-1!=(D=w.indexOf(x))&&(l[D]=v[k]),_==e.rightSide&&-1!=(D=S.indexOf(x))&&(c[D]=v[k]);var N=d.indexOf(_);-1!=N&&u[N]&&-1!=(D=C[_].indexOf(x))&&(u[N].varData[D]=v[k]);var j=h.indexOf(_);-1!=j&&m[j]&&-1!=(D=T[_].indexOf(x))&&(m[j].varData[D]=v[k])}for(var $=0;$<u.length;$++)if(u[$]){var F=u[$].varData;if(F.length>6)for(var G=0;G<F.length;G++){if(G%6==0){var O={devName:u[$].devName,devGuid:u[$].devGuid,varData:[]};b.push(O)}b[b.length-1].varData.push(F[G])}else b.push(u[$])}b.forEach(function(e,t){var a=e.varData.length;if(e.varData[0].toString(),a<6)for(var i=0;i<6-a;i++){var r={varGuid:(new Date).getTime()+i+"frontData",data:{commStateClass:""}};e.varData.push(r)}});for(var I=0;I<m.length;I++)if(m[I]){var A=m[I].varData;if(A.length>6)for(var V=0;V<A.length;V++){if(V%6==0){var P={devName:m[I].devName,devGuid:m[I].devGuid,varData:[]};y.push(P)}y[y.length-1].varData.push(A[V])}else y.push(m[I])}y.forEach(function(e,t){var a=e.varData.length;if(e.varData[0].toString(),a<6)for(var i=0;i<6-a;i++){var r={varGuid:(new Date).getTime()+i+"backData",data:{commStateClass:""}};e.varData.push(r)}})}this.leftValveData=(t=l,Object(r.a)(t),t),this.rightValveData=(a=c,Object(r.a)(a),a),this.frontTemperatureData=(i=b,Object(r.a)(i),i),this.backTemperatureData=(n=y,Object(r.a)(n),n),this.frontTemperatureData},varSelect:function(e,t,a){if(!e.includes("Data")&&e){0==this.chartDialogVisible&&(this.chartDialogVisible=!0);for(var i=0;i<this.selectedVarArr.length;i++)if(this.selectedVarArr[i].varGuid==e)return void!0;this.selectedVarArr.push({varGuid:e,varName:t,devName:a}),this.isRefreshDialog=!0,this.getChartData(e)}},deleteVar:function(e){for(var t,a=0;a<this.selectedVarArr.length;a++)if(this.selectedVarArr[a].varGuid==e){t=a,this.selectedVarArr.splice(a,1);break}t>=0&&(this.legendData.splice(t,1),this.seriesData.splice(t,1),this.showChart())},queryData:function(){if(0!=this.selectedVarArr.length){var e="";this.selectedVarArr.forEach(function(t){e=e+t.varGuid+","}),e=e.substring(0,e.length-1),this.xData=[],this.legendData=[],this.seriesData=[],this.getChartData(e)}else Object(s.j)("warning","请选择变量")},chartBtnClick:function(e){if(!this.chartBtnArr[e].active){for(var t=0;t<this.chartBtnArr.length;t++)this.chartBtnArr[t].active=t==e;this.getChartData(this.defauldVarGuids,this.chartBtnArr[e].value)}},getChartData:function(e,t){var a=this,i={};if(t){this.isRefreshDialog=!1;var r=(new Date).getTime(),n=Object(s.c)(r);i={timeFrom:Object(s.c)(r-24*t*60*60*1e3),timeTo:n,varGuids:e,timeSpan:3600,stationGuid:this.station.stationGuid}}else{if(0==this.queryTimeRange[0].length)return void Object(s.j)("warning","请选择开始时间");if(0==this.queryTimeRange[1].length)return void Object(s.j)("warning","请选择结束时间");if(new Date(this.queryTimeRange[1]).getTime()>(new Date).getTime())return void Object(s.j)("warning","所选时间不能大于当前时间");i={timeFrom:this.queryTimeRange[0],timeTo:this.queryTimeRange[1],varGuids:e,timeSpan:this.spaceType,stationGuid:this.station.stationGuid}}this.$axios({method:"get",url:"/web/hisdata/queryHisDataByTimeSpan",params:i}).then(function(i){var r=i.data;0==r.code&&(t?a.doDefaultChart(e,r.info.times,r.info.vars):(a.timeSpanArr=r.info.times,a.formatChartData(e,r.info.vars)))}).catch(function(e){})},formatChartData:function(e,t){var a=this,i=e.split(",");this.selectedVarArr.forEach(function(e){for(var t=0;t<i.length;t++)if(i[t]==e.varGuid){a.legendData.push({name:e.devName?e.devName+"/"+e.varName:e.varName});var r={name:e.devName?e.devName+"/"+e.varName:e.varName,data:[],type:"line",smooth:!0,connectNulls:!0};a.seriesData.push(r)}});var r=[];this.timeSpanArr.forEach(function(e){r.push(Object(s.c)(1e3*e));for(var t=0;t<a.seriesData.length;t++)a.seriesData[t].data.push(null)}),this.xData=r,t.forEach(function(e){for(var t,i=0;i<a.selectedVarArr.length;i++)e.guid==a.selectedVarArr[i].varGuid&&(t=i);var r=a.timeSpanArr.indexOf(e.breaktime);a.seriesData[t].data[r]=e.value}),this.showChart()},showChart:function(){document.getElementById("dialogChart")&&!this.dialogChart&&(this.dialogChart=this.$echarts.init(document.getElementById("dialogChart")));var e={xAxis:{data:this.xData},yAxis:{type:"value"},dataZoom:[{type:"slider",xAxisIndex:0,filterMode:"empty"},{type:"slider",yAxisIndex:0,filterMode:"empty"}],tooltip:{show:!0,trigger:"axis"},legend:{left:"right",data:this.legendData},series:this.seriesData};this.dialogChart.setOption(e,!0)},chartDialogOpenedHandle:function(){},dialogClose:function(){this.selectedVarArr=[],this.xData=[],this.legendData=[],this.seriesData=[]},getLateDays:function(e){var t=new Date,a=new Date(t.getTime()-864e5*e),i="";return i+=a.getFullYear()+"-",i+=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,i+="-",i+=a.getDate()<10?"0"+a.getDate():a.getDate(),i+=" ",i+=a.getHours()<10?"0"+a.getHours():a.getHours(),i+=":",i+=a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes(),i+=":",i+=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds()},getDisplayName:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/project/queryProjectConfig",params:{projectId:this.station.id,type:3}}).then(function(t){0==t.data.code&&t.data.info&&(e.displayNameObj=JSON.parse(t.data.info))})},modifyDisdplayName:function(e){this.modifyDialogVisible=!0,this.modifyName.name=JSON.parse(JSON.stringify(this.displayNameObj[e])),this.modifyName.key=e},saveModifyName:function(){var e=this;if(this.modifyName.name){var t=JSON.parse(JSON.stringify(this.displayNameObj));t[this.modifyName.key]=this.modifyName.name,this.$axios({method:"post",headers:{},data:{projectId:this.station.id,type:3,content:t},url:"web/project/updateProjectShowName"}).then(function(t){0==t.data.code&&(e.displayNameObj[e.modifyName.key]=e.modifyName.name,e.modifyDialogVisible=!1,Object(s.j)("success","修改成功"))})}else Object(s.j)("error","名称不能为空")},getDefaultChartData:function(e){var t=this;this.$axios({method:"post",headers:{},data:{varGuids:e.toString(),proGuid:this.station.stationGuid},url:"web/projectdisplay/getHistDataCurve"}).then(function(e){0==e.data.code&&t.doDefaultChart(e.data.info)})},doDefaultChart:function(e){var t;this.station.freezeTime&&(t=this.station.freezeTime);var a=e[this.defaultVarArr[0].varGuid].map(function(e){return e.time}),i=!0;t&&-1==a.indexOf(t)&&(a=[t].concat(Object(c.a)(a)),i=!1);for(var r=1;r<a.length;r++)a[r]=Object(s.d)(a[0],a[r])+"天";for(var n=[{name:this.defaultVarArr[0].varName,type:"line",data:[],varGuid:this.defaultVarArr[0].varGuid},{name:this.defaultVarArr[1].varName,type:"line",data:[],varGuid:this.defaultVarArr[1].varGuid}],o=0;o<this.defaultVarArr.length;o++){var l=e[this.defaultVarArr[o].varGuid].map(function(e){return e.value});i||l.unshift(""),n[o].data=l}var u=this.$echarts.init(document.getElementById("defaultChart")),d={xAxis:{data:a},yAxis:{type:"value"},tooltip:{show:!0,trigger:"axis"},legend:{left:"right",data:this.defaultVarArr.map(function(e){return e.varName})},series:n};u.setOption(d)}}}),d=(i("4052"),Object(o.a)(u,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"realData"},[a("div",{staticClass:"leftContent"},[a("div",{staticClass:"leftTopDiv"},[e._m(0),a("div",{staticClass:"leftContentDiv"},[a("div",{staticClass:"valveDiv",on:{dblclick:function(t){return e.modifyDisdplayName("leftValveName")}}},[e._v(" "+e._s(e.displayNameObj.leftValveName)+" ")]),e._l(e.leftValveData,function(t){return a("div",{key:t.varGuid+"leftSide",staticClass:"varDiv",on:{click:function(a){return e.varSelect(t.varGuid,t.varName,"左阀")}}},[a("div",{staticClass:"varTitle",staticStyle:{"background-color":"rgb(50, 116, 251)","border-right":"1px solid rgb(50, 116, 251)"}},[e._v(" "+e._s(t.varName)+" "),t.isAlarm?a("el-popover",{staticStyle:{"white-space":"pre"},attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("状态："+e._s(t.data.alarmStateDes))]),a("p",[e._v("内容："+e._s(t.data.alarmContent))]),a("p",[e._v("报警时间："+e._s(t.data.alarmStateTime))]),a("p",[e._v("采集时间："+e._s(t.data.vTime))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("span",[e._v(" "),a("i",{staticClass:"el-icon-warning-outline",staticStyle:{color:"red"}})])])]):e._e()],1),a("div",{staticClass:"varValue leftValBorder",class:t.data.commStateClass},[e._v(" "+e._s(t.data.v)+"℃ ")])])}),a("div",{staticClass:"valveDiv",staticStyle:{"margin-left":"15px"},on:{dblclick:function(t){return e.modifyDisdplayName("rightValveName")}}},[e._v(" "+e._s(e.displayNameObj.rightValveName)+" ")]),e._l(e.rightValveData,function(t){return a("div",{key:t.varGuid+"rightSide",staticClass:"varDiv",on:{click:function(a){return e.varSelect(t.varGuid,t.varName,"右阀")}}},[a("div",{staticClass:"varTitle",staticStyle:{"background-color":"rgb(13, 169, 234)","border-right":"1px solid rgb(50, 192, 251)"}},[e._v(" "+e._s(t.varName)+" "),t.isAlarm?a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("状态："+e._s(t.data.alarmStateDes))]),a("p",[e._v("内容："+e._s(t.data.alarmContent))]),a("p",[e._v("报警时间："+e._s(t.data.alarmStateTime))]),a("p",[e._v("采集时间："+e._s(t.data.vTime))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("span",[e._v(" "),a("i",{staticClass:"el-icon-warning-outline",staticStyle:{color:"red"}})])])]):e._e()],1),a("div",{staticClass:"varValue rightValBorder",class:t.data.commStateClass},[e._v(" "+e._s(t.data.v)+"℃ ")])])})],2)]),a("div",{staticClass:"leftBottomDiv"},[e._m(1),a("div",{staticClass:"leftBottomContent"},[a("div",{staticClass:"temperatureTitle",on:{dblclick:function(t){return e.modifyDisdplayName("frontSideName")}}},[e._v(" "+e._s(e.displayNameObj.frontSideName)+" ")]),e._l(e.frontTemperatureData,function(t,i){return a("div",{key:"front"+i,staticClass:"teperatureDataDiv"},[a("div",{staticClass:"temperatureDev"},[e._v(e._s(t.devName))]),e._l(t.varData,function(i,r){return a("div",{key:i.varGuid+r,staticClass:"temperatureItem",class:[i?i.data.commStateClass:"clickForbidden",i.data.v?"temperatureItemLine":""],on:{click:function(a){return e.varSelect(i.varGuid,i.varName,t.devName)}}},[a("div",[e._v(" "+e._s(i?i.varName:"")+" "),i&&i.isAlarm?a("el-popover",{staticStyle:{display:"inline-block","margin-left":"4px"},attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("状态："+e._s(i.data.alarmStateDes))]),a("p",[e._v("内容："+e._s(i.data.alarmContent))]),a("p",[e._v("报警时间："+e._s(i.data.alarmStateTime))]),a("p",[e._v("采集时间："+e._s(i.data.vTime))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("span",[e._v(" "),a("i",{staticClass:"el-icon-warning-outline",staticStyle:{color:"red"}})])])]):e._e()],1),a("div",[e._v(" "+e._s(i.data.v?i.data.v+"℃":"")+" ")])])})],2)}),a("div",{staticStyle:{width:"100%"}}),a("div",{staticClass:"temperatureTitle",on:{dblclick:function(t){return e.modifyDisdplayName("backSideName")}}},[e._v(" "+e._s(e.displayNameObj.backSideName)+" ")]),e._l(e.backTemperatureData,function(t,i){return a("div",{key:"back"+i,staticClass:"teperatureDataDiv"},[a("div",{staticClass:"temperatureDev"},[e._v(e._s(t.devName))]),e._l(t.varData,function(i,r){return a("div",{key:i.varGuid+r,staticClass:"temperatureItem",class:[i?i.data.commStateClass:"clickForbidden",i.data.v?"temperatureItemLine":""],on:{click:function(a){return e.varSelect(i.varGuid,i.varName,t.devName)}}},[a("div",[e._v(" "+e._s(i?i.varName:"")+" "),i&&i.isAlarm?a("el-popover",{staticStyle:{display:"inline-block","margin-left":"4px"},attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("状态："+e._s(i.data.alarmStateDes))]),a("p",[e._v("内容："+e._s(i.data.alarmContent))]),a("p",[e._v("报警时间："+e._s(i.data.alarmStateTime))]),a("p",[e._v("采集时间："+e._s(i.data.vTime))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("span",[e._v(" "),a("i",{staticClass:"el-icon-warning-outline",staticStyle:{color:"red"}})])])]):e._e()],1),a("div",[e._v(" "+e._s(i.data.v?i.data.v+"℃":"")+" ")])])})],2)})],2)])]),a("div",{staticClass:"rightContent"},[a("div",{staticClass:"rightBack rightTop"},[a("div",{staticClass:"rightTopContent",staticStyle:{background:"rgb(13, 128, 213)"},on:{click:function(t){return e.varSelect(e.goTemperature.varGuid,"去路温度","")}}},[e._v(" 去路温度 "),e.goTemperature.isAlarm?a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("状态："+e._s(e.goTemperature.data.alarmStateDes))]),a("p",[e._v("内容："+e._s(e.goTemperature.data.alarmContent))]),a("p",[e._v("报警时间："+e._s(e.goTemperature.data.alarmStateTime))]),a("p",[e._v("采集时间："+e._s(e.goTemperature.data.vTime))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[e._v(" "),a("span",{staticClass:"el-icon-warning-outline",staticStyle:{color:"red","font-size":"larger"}})])]):e._e()],1),a("div",{staticClass:"rightTopContent",staticStyle:{color:"rgb(13, 128, 213)"},on:{click:function(t){return e.varSelect(e.goTemperature.varGuid,"去路温度","")}}},[e._v(" "+e._s(e.goTemperature.data.v)+"℃ ")]),a("div",{staticClass:"rightTopContent",staticStyle:{background:"rgb(15, 184, 225)"},on:{click:function(t){return e.varSelect(e.comeTemperature.varGuid,"回路温度","")}}},[e._v(" 回路温度 "),e.comeTemperature.isAlarm?a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("状态："+e._s(e.comeTemperature.data.alarmStateDes))]),a("p",[e._v("内容："+e._s(e.comeTemperature.data.alarmContent))]),a("p",[e._v("报警时间："+e._s(e.comeTemperature.data.alarmStateTime))]),a("p",[e._v("采集时间："+e._s(e.comeTemperature.data.vTime))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("span",[e._v(" "),a("i",{staticClass:"el-icon-warning-outline",staticStyle:{color:"red","font-size":"larger"}})])])]):e._e()],1),a("div",{staticClass:"rightTopContent",staticStyle:{color:"rgb(15, 184, 225)"},on:{click:function(t){return e.varSelect(e.comeTemperature.varGuid,"回路温度","")}}},[e._v(" "+e._s(e.comeTemperature.data.v)+"℃ ")])]),a("div",{staticClass:"rightBack rightMiddle",staticStyle:{overflow:"hidden"}},[e._m(2),a("div",{staticClass:"rightMiddleContent"},[a("div",{staticClass:"chart",style:{height:"100%",width:"100%"},attrs:{id:"defaultChart"}})])]),a("div",{staticClass:"rightBottom"},[a("div",{staticClass:"rightBack rightBottomContent"},[e._m(3),a("img",{staticStyle:{height:"90%"},attrs:{src:e.imgUrl.front,alt:""}})]),a("div",{staticClass:"rightBack rightBottomContent",staticStyle:{"margin-left":"10px"}},[e._m(4),a("img",{staticStyle:{height:"90%"},attrs:{src:e.imgUrl.back,alt:""}})])])]),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{id:"chartDialog",title:"历史曲线",visible:e.chartDialogVisible,width:"45%",top:"13%",modal:!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.chartDialogVisible=t},opened:e.chartDialogOpenedHandle,close:e.dialogClose}},[a("div",{staticStyle:{width:"100%",height:"480px"}},[a("div",{staticClass:"dialogVars",staticStyle:{height:"50px","overflow-y":"auto"}},e._l(e.selectedVarArr,function(t){return a("el-tag",{key:t.varGuid,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.deleteVar(t.varGuid)}}},[e._v(e._s(t.devName?t.devName+"/"+t.varName:t.varName))])}),1),a("div",{staticClass:"dialogVars"},[a("p",{staticStyle:{"margin-left":"0.05rem"}},[e._v("开始：")]),a("el-date-picker",{attrs:{type:"datetime","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center",editable:!1,clearable:!1},model:{value:e.queryTimeRange[0],callback:function(t){e.$set(e.queryTimeRange,0,t)},expression:"queryTimeRange[0]"}}),a("p",{staticStyle:{"margin-left":"0.1rem"}},[e._v("结束：")]),a("el-date-picker",{attrs:{type:"datetime","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center",editable:!1,clearable:!1},model:{value:e.queryTimeRange[1],callback:function(t){e.$set(e.queryTimeRange,1,t)},expression:"queryTimeRange[1]"}}),a("p",{staticStyle:{"margin-left":"0.2rem"}},[e._v("间隔：")]),a("el-select",{staticStyle:{width:"0.9rem"},attrs:{placeholder:"请选择"},model:{value:e.spaceType,callback:function(t){e.spaceType=t},expression:"spaceType"}},e._l(e.spaceTypeArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:e.queryData}},[e._v("查询")])],1),a("div",{staticStyle:{height:"360px",width:"100%"},attrs:{id:"dialogChart"}})])]),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{id:"modifyDialog",title:"修改",visible:e.modifyDialogVisible,width:"30%",top:"13%","close-on-click-modal":!0},on:{"update:visible":function(t){e.modifyDialogVisible=t},close:e.dialogClose}},[a("div",{staticClass:"modifyContent"},[a("p",{staticStyle:{"margin-left":"19%"}},[e._v("名称：")]),a("el-input",{staticStyle:{width:"60%","text-align":"center"},model:{value:e.modifyName.name,callback:function(t){e.$set(e.modifyName,"name",t)},expression:"modifyName.name"}})],1),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.modifyDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveModifyName}},[e._v("保 存")])],1)])],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"leftTitle"},[t("span",[this._v("冻结回水阀门")]),t("div",{staticClass:"titleIcon"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"leftTitle",staticStyle:{flex:"0.1"}},[t("span",[this._v("测温孔温度")]),t("div",{staticClass:"titleIcon"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"rightMiddleTitle"},[t("span",[this._v("温度曲线")]),t("div",{staticClass:"titleIcon",staticStyle:{"margin-right":"20px"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"rightMiddleTitle"},[t("span",[this._v("正面展示")]),t("div",{staticClass:"titleIcon"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"rightMiddleTitle"},[t("span",[this._v("背面展示")]),t("div",{staticClass:"titleIcon"})])}],!1,null,null,null).exports),m=i("6abc"),h={components:{freezeTemplate1:i("2a6f").a},data:function(){return{station:{id:"",name:""},freezeConfigArr:[],freezeTableConfig:{isShow:"true",tableData:[]},configFreezeTemplate:1,configVarIndex:0,configStatus:0}},created:function(){this.station=this.$store.state.freezenStation,this.getProjectFreezeConfig()},computed:{webSocketData:function(){return this.$store.state.g_newRealData}},watch:{webSocketData:function(e,t){if(this.station.stationGuid==e.stationGuid){for(var a=e,i=a.varGuid,r=0;r<this.freezeConfigArr.length;r++){if(this.freezeConfigArr[r].varGuid==i){this.freezeConfigArr[r].value=a.value;break}}for(r=0;r<this.freezeTableConfig.tableData.length;r++){if(this.freezeTableConfig.tableData[r].varGuid==i){var s=Object(m.a)({},this.freezeTableConfig.tableData[r]);s.value=a.value,this.$set(this.freezeTableConfig.tableData,r,s);break}}}}},mounted:function(){},methods:{getProjectFreezeConfig:function(){var e=this;this.$axios({method:"get",headers:{},url:"web/project/queryProjectConfig",params:{projectId:this.station.id,type:2}}).then(function(t){var a=t.data;if(0==a.code&&a.info){var i=JSON.parse(a.info);e.configFreezeTemplate=i.configFreezeTemplate,e.freezeConfigArr=i.freezeConfigArr,e.freezeTableConfig=i.freezeTableConfig,e.getRealDataByConfig()}}).catch(function(e){})},getRealDataByConfig:function(){JSON.parse(JSON.stringify(this.$store.state.g_realData.devs[this.station.stationGuid]));var e=Object(c.a)(this.freezeConfigArr),t=Object(m.a)({},this.freezeTableConfig),a=JSON.parse(JSON.stringify(this.$store.state.g_realData.vars[this.station.stationGuid]));if(a&&a.length>0)for(var i=0;i<a.length;i++){for(var r=a[i].varGuid,s=0;s<e.length;s++){if(e[s].varGuid==r){e[s].value=a[i].data.v;break}}for(s=0;s<t.tableData.length;s++){if(t.tableData[s].varGuid==r){t.tableData[s].value=a[i].data.v;break}}}this.freezeConfigArr=e,this.freezeTableConfig=t}}},p=(i("3f7d"),Object(o.a)(h,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"station-device"},[1==e.configFreezeTemplate?a("freezeTemplate1",{attrs:{freezeConfigArr:e.freezeConfigArr,configVarIndex:e.configVarIndex,configStatus:e.configStatus,freezeTableConfig:e.freezeTableConfig},on:{"update:freezeConfigArr":function(t){e.freezeConfigArr=t},"update:freeze-config-arr":function(t){e.freezeConfigArr=t},"update:freezeTableConfig":function(t){e.freezeTableConfig=t},"update:freeze-table-config":function(t){e.freezeTableConfig=t}}}):e._e()],1)},[],!1,null,null,null).exports),f={components:{videoPlayer:i("e001").a},data:function(){return{station:{id:"",name:"",stationGuid:"",rights:""},comName:"videoPlayer",videoArr:[],queryScreenShotsNum:0}},created:function(){this.station=this.$store.state.freezenStation,this.getAccessToken(),this.station.id&&this.getStationVideoList()},mounted:function(){},methods:{getStationVideoList:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/video/queryVideos",params:{projectId:this.station.id}}).then(function(t){var a=t.data;if(0==a.code){for(var i=0;i<a.info.length;i++)a.info[i].selected=!1,a.info[i].imgUrl="";e.videoArr=a.info,e.accessToken&&(e.queryScreenShotsNum=0,e.getVideoScreenShots())}}).catch(function(e){})},getVideoScreenShots:function(){var e=this;if(this.videoArr[this.queryScreenShotsNum]){var t={accessToken:this.accessToken.toString(),deviceSerial:this.videoArr[this.queryScreenShotsNum].serialNum,channelNo:this.videoArr[this.queryScreenShotsNum].channelNum};this.$axios({method:"post",url:"https://open.ys7.com/api/lapp/device/capture",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$qs.stringify(t)}).then(function(t){var a=t.data;if(200==a.code){var i=e.videoArr[e.queryScreenShotsNum];i.imgUrl=a.data.picUrl,e.$set(e.videoArr,e.queryScreenShotsNum,i)}e.queryScreenShotsNum++,e.getVideoScreenShots()}).catch(function(t){e.queryScreenShotsNum++,e.getVideoScreenShots()})}},videoListClick:function(e){for(var t=0;t<this.videoArr.length;t++)t==e?(this.videoArr[t].selected=!0,this.videoArr[t].projectId=this.station.id,this.videoArr[t].accessToken=this.accessToken,this.$set(this.videoArr,t,this.videoArr[t]),this.$store.commit("set_g_videoInfo",this.videoArr[t])):this.videoArr[t].selected=!1},initSwiper:function(){this.swiper=new Swiper(".swiper-container",{direction:"vertical",slidesPerView:7,spaceBetween:15,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},observer:!0,observeParents:!0,on:{resize:function(){this.swiper.changeDirection("vertical")}}}),this.swiper.on.resize()},getAccessToken:function(){var e=this;this.$axios({method:"get",headers:{},params:{projectId:this.station.id},url:"/web/video/getAccessToken"}).then(function(t){var a=t.data;0==a.code&&(e.accessToken=a.info,e.videoArr.length>0&&(e.queryScreenShotsNum=0,e.getVideoScreenShots()))}).catch(function(e){})}}},g=(i("a90e"),Object(o.a)(f,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"programVideo"},[a("div",{staticClass:"leftDiv"},e._l(e.videoArr,function(t,i){return a("div",{key:i,staticClass:"videoShot",class:{active:t.selected},on:{click:function(t){return e.videoListClick(i)}}},[a("el-image",{staticClass:"imgClass",attrs:{src:t.imgUrl}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])]),a("div",{staticClass:"videoNameDiv"},[e._v(e._s(t.videoName))])],1)}),0),a("div",{staticClass:"rightDiv"},[a(e.comName,{tag:"component",staticClass:"videoComponent"})],1)])},[],!1,null,null,null).exports),v={data:function(){return{station:{id:"",name:""},previewExcelUrl:""}},created:function(){this.station=this.$store.state.freezenStation,this.previewExcel()},methods:{previewExcel:function(){var e=this,t={projectId:this.station.id};this.$axios({method:"get",headers:{},url:"/web/project/previewExcel",params:t}).then(function(t){t.data;var a=t.data;if(0==a.code){var i=a.info;e.previewExcelUrl=i}else e.$showMessage("error","预览失败："+a.msg)}).catch(function(t){e.$showMessage("error",t)})}}},b=Object(o.a)(v,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{width:"100%"}},[t("iframe",{staticStyle:{width:"100%",height:"99%",overflow:"auto",background:"white"},attrs:{src:this.previewExcelUrl,frameborder:"0"}})])},[],!1,null,null,null).exports,y={data:function(){return{stationInfo:{name:"",id:"",stationGuid:""},reportList:[{name:"日报表",selected:!0,type:"day"},{name:"涨降值报表",selected:!1,type:"rise"},{name:"周期报表",selected:!1,type:"cycle"}],reportType:"day",reportTypeName:"日报表",dayTime:Object(s.c)(new Date),riseDownTime:Object(s.c)(new Date),riseDownRefTime:"",periodTimeRange:["",""],periodSpaceTime:1,periodSpaceType:60,periodSpaceTypeArr:[{value:1440,label:"天"},{value:60,label:"时"},{value:1,label:"分"}],pickerOptions:{disabledDate:function(e){return e.getTime()>(new Date).getTime()}},fileList:[],previewUrl:""}},created:function(){this.stationInfo=this.$store.state.freezenStation,this.periodTimeRange[0]=this.getLateDays(1),this.periodTimeRange[1]=this.getLateDays(0),this.riseDownRefTime=this.getLateDays(1)},watch:{},methods:{leftLiClick:function(e){if(!this.reportList[e].selected)for(var t=0;t<this.reportList.length;t++)t==e?(this.reportList[t].selected=!0,this.reportType=this.reportList[t].type,this.reportTypeName=this.reportList[t].name,this.previewUrl=""):this.reportList[t].selected=!1},previewOrDownloadExcel:function(e){var t=this;if("day"!=this.reportType||this.dayTime){if("rise"==this.reportType){if(!this.riseDownTime||!this.riseDownRefTime)return void Object(s.j)("warning","请选择时间");if(new Date(this.riseDownRefTime).getTime()>new Date(this.riseDownTime).getTime())return void Object(s.j)("warning","参考时间不能大于选择时间");if(new Date(this.riseDownTime).getTime()>(new Date).getTime())return void Object(s.j)("warning","所选时间不能大于当前时间")}if("cycle"==this.reportType){if(!this.periodTimeRange[0]||!this.periodTimeRange[1])return void Object(s.j)("warning","请选择时间");if(new Date(this.periodTimeRange[1]).getTime()>(new Date).getTime())return void Object(s.j)("warning","所选时间不能大于当前时间");if(0==e){var a=parseInt(new Date(this.periodTimeRange[1]).getTime()/1e3)-parseInt(new Date(this.periodTimeRange[0]).getTime()/1e3);if(a<0)return void Object(s.j)("warning","结束时间不能小于开始时间");var i=a/60,r=this.periodSpaceTime*this.periodSpaceType;if(i/r>200){var n,o=Math.ceil(i/200/r);return this.periodSpaceTypeArr.forEach(function(e){e.value==t.periodSpaceType&&(n=e.label)}),void Object(s.j)("warning","间隔周期超出EXCEL的限制，建议周期为"+o+n+"以上")}}}var l="cycle"==this.reportType?this.periodTimeRange[0]:this.riseDownTime,c="cycle"==this.reportType?this.periodTimeRange[1]:this.riseDownRefTime;if(0==e)this.previewUrl="",this.$axios({method:"get",headers:{},url:"web/report/exportExcel",params:{reportName:this.reportType,time:this.dayTime,timeBegin:l,timeEnd:c,cycleByMin:this.periodSpaceTime*this.periodSpaceType,stationGuid:this.stationInfo.stationGuid,projectId:this.stationInfo.id,flag:e}}).then(function(e){var a=e.data;0==a.code?t.previewUrl=a.info+"?_t="+(new Date).getTime():Object(s.j)("warning",a.msg)}).catch(function(e){Object(s.j)("error",e)});else{var u="/web/report/exportExcel?reportName="+this.reportType+"&time="+this.dayTime+"&timeBegin="+l+"&timeEnd="+c+"&cycleByMin="+this.periodSpaceTime*this.periodSpaceType+"&stationGuid="+this.stationInfo.stationGuid+"&projectId="+this.stationInfo.id+"&flag="+e;window.open(u)}}else Object(s.j)("warning","请选择时间")},downloadExcelTemplate:function(){var e="/web/report/downExcel?reportName="+this.reportType+"&projectId="+this.stationInfo.id;window.open(e)},changeCurrentReportType:function(e,t){this.reportType=e,this.reportTypeName=t},uploadError:function(e,t,a){this.$message({message:"上传失败",type:"error"})},uploadSuccess:function(e,t,a){0==e.code?this.$message({message:"上传成功",type:"success"}):this.$message({message:e.msg,type:"error"})},getLateDays:function(e){var t=new Date,a=new Date(t.getTime()-864e5*e),i="";return i+=a.getFullYear()+"-",i+=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,i+="-",i+=a.getDate()<10?"0"+a.getDate():a.getDate(),i+=" ",i+=a.getHours()<10?"0"+a.getHours():a.getHours(),i+=":",i+=a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes(),i+=":",i+=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds()}}},w=(i("4e54"),Object(o.a)(y,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"projectReport"},[a("div",{staticClass:"leftDiv"},[a("ul",{staticClass:"leftUl"},e._l(e.reportList,function(t,i){return a("li",{key:i,staticClass:"leftLi",class:t.selected?"active":"",on:{click:function(t){return e.leftLiClick(i)}}},[e._v(" "+e._s(t.name)+" ")])}),0)]),a("div",{staticClass:"rightDiv"},[a("div",{staticClass:"reportConditionDiv"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"day"==e.reportType,expression:"reportType == 'day'"}],staticClass:"subCoonditionDiv",staticStyle:{flex:"0.8"}},[a("p",[e._v("选择时间")]),a("el-date-picker",{staticClass:"timeInput",attrs:{type:"datetime",placeholder:"请选择时间",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center"},model:{value:e.dayTime,callback:function(t){e.dayTime=t},expression:"dayTime"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:!e.stationInfo.stationGuid},on:{click:function(t){return e.previewOrDownloadExcel(0)}}},[e._v("预览")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:!e.stationInfo.stationGuid},on:{click:function(t){return e.previewOrDownloadExcel(1)}}},[e._v("导出")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"rise"==e.reportType,expression:"reportType == 'rise'"}],staticClass:"subCoonditionDiv",staticStyle:{flex:"0.8"}},[a("p",[e._v("选择时间")]),a("el-date-picker",{staticStyle:{"margin-left":"10px"},attrs:{type:"datetime",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择时间"},model:{value:e.riseDownTime,callback:function(t){e.riseDownTime=t},expression:"riseDownTime"}}),a("p",{staticStyle:{"margin-left":"10px"}},[e._v("参考时间")]),a("el-date-picker",{staticStyle:{"margin-left":"10px"},attrs:{type:"datetime",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择时间"},model:{value:e.riseDownRefTime,callback:function(t){e.riseDownRefTime=t},expression:"riseDownRefTime"}}),a("el-button",{attrs:{type:"primary",disabled:!e.stationInfo.stationGuid},on:{click:function(t){return e.previewOrDownloadExcel(0)}}},[e._v("预览")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:!e.stationInfo.stationGuid},on:{click:function(t){return e.previewOrDownloadExcel(1)}}},[e._v("导出")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"cycle"==e.reportType,expression:"reportType == 'cycle'"}],staticClass:"subCoonditionDiv",staticStyle:{flex:"0.8"}},[a("p",[e._v("开始：")]),a("el-date-picker",{staticStyle:{"margin-left":"10px"},attrs:{type:"datetime",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center"},model:{value:e.periodTimeRange[0],callback:function(t){e.$set(e.periodTimeRange,0,t)},expression:"periodTimeRange[0]"}}),a("p",{staticStyle:{"margin-left":"10px"}},[e._v("结束：")]),a("el-date-picker",{attrs:{type:"datetime",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center"},model:{value:e.periodTimeRange[1],callback:function(t){e.$set(e.periodTimeRange,1,t)},expression:"periodTimeRange[1]"}}),a("p",{staticStyle:{"margin-left":"0.1rem"}},[e._v("间隔：")]),a("el-input",{staticStyle:{width:"1rem"},model:{value:e.periodSpaceTime,callback:function(t){e.periodSpaceTime=t},expression:"periodSpaceTime"}}),a("el-select",{staticStyle:{width:"0.9rem"},attrs:{placeholder:"请选择"},model:{value:e.periodSpaceType,callback:function(t){e.periodSpaceType=t},expression:"periodSpaceType"}},e._l(e.periodSpaceTypeArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),a("el-button",{attrs:{type:"primary",disabled:!e.stationInfo.stationGuid},on:{click:function(t){return e.previewOrDownloadExcel(0)}}},[e._v("预览")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(t){return e.previewOrDownloadExcel(1)}}},[e._v("导出")])],1),a("div",{staticClass:"subCoonditionDiv",staticStyle:{flex:"0.4","justify-content":"flex-end"}},[a("p",[e._v(e._s(e.reportTypeName)+"模板")]),a("el-upload",{staticClass:"upload",attrs:{action:"/web/report/uploadExcel?excelName="+e.reportType+"&projectId="+e.stationInfo.id,"on-error":e.uploadError,"on-success":e.uploadSuccess,accept:".xlsx","file-list":e.fileList,"show-file-list":!1}},[a("el-button",{attrs:{type:"success",disabled:!e.stationInfo.stationGuid}},[e._v("上传")])],1),a("el-button",{attrs:{type:"success",icon:"el-icon-download",disabled:!e.stationInfo.stationGuid},on:{click:e.downloadExcelTemplate}},[e._v("下载")])],1)]),a("div",{ref:"hisTable",staticClass:"tableDiv"},[a("iframe",{attrs:{src:e.previewUrl,frameborder:"0",width:"100%",height:"100%"}})])])])},[],!1,null,null,null).exports),S=(i("01e5"),i("e487"),i("b846")),C=i("49ca"),T=i("062d"),D={name:"GraphShowPage",components:{graphPopup:S.a,graphHistoryCurve:C.a},data:function(){return{isInteractive:!0,station:{id:"",name:"",stationGuid:""},zoomFactor:.6,graphShow:null,readableVarList:[],curGraph:{xml:""},images:null,timer:null,searchText:"",treeData:[],defaultProps:{children:"children",label:"name"},expandedKeys:[],variables:[],realVarDataToTable:[],loadObj:null}},created:function(){this.station=this.$store.state.freezenStation,this.$coreData.getAll(this.station.stationGuid)},computed:{webSocketData:function(){return this.$store.state.g_newRealData}},watch:{webSocketData:function(e,t){this.station.stationGuid==e.stationGuid&&(this.renderGraphData([e]),this.realVarDataToTable.map(function(t){if(t.varGuid==e.varGuid)return Object.assign(t,e),t}))},searchText:function(e){this.$refs.tree.filter(e)}},mounted:function(){var e=this;this.queryProjectPageByProjectId(),this.$erd.listenTo(this.$refs.graphWarp,function(t){e.showGraph()}),window.document.oncontextmenu=function(){return!1}},beforeDestroy:function(){this.graphShow&&this.graphShow.dispose(),window.document.oncontextmenu=function(){return!0}},methods:{getRealVarData:function(){if(void 0==this.$store.state.g_realData.vars)return this.$message.error("实时数据未找到,请重新登录"),!1;var e=JSON.parse(JSON.stringify(this.$store.state.g_realData.vars[this.station.stationGuid])).map(function(e){return e.value=e.data.v,e.alarmLevel=e.data.alarmState,e.alarmState=e.data.alarmState,e.commState=e.data.commState,e.desc="",e});this.renderGraphData(e),this.realVarDataToTable=e},queryProjectPageByProjectId:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/projectPage/queryProjectPageByProjectId",params:{projectId:this.station.id}}).then(function(t){var a=t.data;0==a.code&&a.info[0].id?(e.treeData=a.info,e.$nextTick(function(){e.$refs.tree&&(e.$refs.tree.setCurrentKey(e.treeData[0].id),e.getXml(e.treeData[0].id))})):e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t.message)})},getXml:function(e){var t=this,a=this.$loading({lock:!0,target:this.$refs.graphShow,text:"Loading",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.7)"}),i={projectId:this.station.id,pageId:e};this.$axios({method:"get",headers:{},url:"/web/projectPage/getXml",params:i}).then(function(e){a.close(),0==e.data.code?t.curGraph.xml=e.data.info:(t.$message({message:"未找到组态页面",type:"warning"}),t.curGraph.xml=""),t.showGraph()})},showGraph:function(){var e=this;this.graphShow?this.graphShow.dispose():this.graphShow=new T.a(this.$refs.graphShow,this),this.graphShow.setGraphXml(this.curGraph.xml,this.addReadableVar),this.$nextTick(function(){if(e.$refs.graphWarp){var t=e.$refs.graphWarp.offsetHeight,a=e.$refs.graphWarp.offsetWidth;a/t<1.8?e.graphShow.zoomWidth(a):e.graphShow.zoomHeight(t),e.getRealVarData()}})},addReadableVar:function(e,t){var a=this.$coreData.g.getVar(e);if(a){var i={guid:e,name:this.$coreData.g.getVarQualifiedName(a),value:t,alarm:{level:0,text:"无报警"},commErr:!1},r=this.$coreData.v.getVarDescription(a);r&&(i.description=[{value:0,label:r[0]},{value:1,label:r[1]}]),this.readableVarList.push(i)}},renderGraphData:function(e){var t=this;0==this.readableVarList.length?setTimeout(function(){t.showRealData(e)},1e3):this.showRealData(e)},showRealData:function(e){var t=this,a={"-1":"初始状态",1:"正常状态",2:"预警状态",3:"报警状态",4:"报警确认",5:"预警确认"};this.readableVarList.forEach(function(i){e.forEach(function(e){i.guid==e.varGuid&&t.graphShow.setVarData({guid:i.guid,name:i.name,value:e.value,alarm:{level:e.alarmState,text:a[e.alarmState]},commErr:1==e.commState})})})},treeFilterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},handleNodeClick:function(e,t){var a=e.id;this.getXml(a)}}},k=(i("a35e"),Object(o.a)(D,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"GraphShowPage"},[a("div",{staticClass:"leftDiv"},[a("el-input",{staticClass:"searchInput",attrs:{placeholder:"页面搜索","prefix-icon":"el-icon-search"},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}}),a("div",{staticClass:"programTreeDiv tree-container"},[a("el-tree",{ref:"tree",staticClass:"tree filter-tree programTree",attrs:{data:e.treeData,"node-key":"id","default-expanded-keys":e.expandedKeys,props:e.defaultProps,"filter-node-method":e.treeFilterNode,"highlight-current":""},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node;return a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{staticClass:"el-tree-page"}),e._v(" "+e._s(i.label)+" ")])])}}])})],1)],1),a("div",{ref:"graphWarp",staticClass:"rightDiv"},[a("div",{staticStyle:{height:"100%",width:"100%",display:"flex","justify-content":"center","align-items":"center"}},[a("div",{ref:"graphShow",staticStyle:{background:"transparent"}})])]),a("graphPopup",{ref:"graphPopup",attrs:{realVarDataToTable:e.realVarDataToTable}}),a("graphHistoryCurve",{ref:"graphHistoryCurve"})],1)},[],!1,null,null,null).exports),_={data:function(){return{projectInfo:{name:"",riskLevel:"#FFFFFF"},predefineColors:["#FFFFFF","#FFFF00","#FFC000","#FF0000"],currentStep:-1,steps:[{name:"进场",time:"",step:0,space:0},{name:"打钻",time:"",step:1,space:0},{name:"冻结",time:"",step:2,space:0},{name:"开挖",time:"",step:3,space:0},{name:"结构",time:"",step:4,space:0},{name:"注浆",time:"",step:5,space:0},{name:"结束",time:"",step:6}],planTime:{start:"",end:""},buildUnits:[{unitName:"",projectManager:"",contact:"",unitType:1}],mainContractorUnits:[{unitName:"",projectManager:"",contact:"",unitType:2}],supervisingUnits:[{unitName:"",projectManager:"",contact:"",unitType:3}],designUnits:[{unitName:"",projectManager:"",contact:"",unitType:4}],explorationUnits:[{unitName:"",projectManager:"",contact:"",unitType:5}],managers:[{name:"",contact:""}]}},activated:function(){this.getProjectInfo()},mounted:function(){this.projectInfo=this.$store.state.freezenStation,this.getProjectInfo()},created:function(){},methods:{doSteps:function(){var e=this.projectInfo.info;if(e.steps){this.steps=JSON.parse(e.steps);for(var t=(new Date).getTime(),a=this.steps.length-1;a>=0;a--)if(this.steps[a].time&&t>=new Date(this.steps[a].time).getTime()){this.currentStep=a+1;break}this.doSpaceTime()}this.planTime.start=e.planStartTime,this.planTime.end=e.planEndTime},doSpaceTime:function(){for(var e=0;e<this.steps.length-1;e++)if(this.steps[e].space=0,this.steps[e].time){if(!(e<this.currentStep))break;if(e==this.currentStep-1){var t=Object(s.b)((new Date).getTime());this.steps[e].space=Object(s.d)(this.steps[e].time,t)}else this.steps[e+1].time&&(this.steps[e].space=Object(s.d)(this.steps[e].time,this.steps[e+1].time))}},unitsAndmangers:function(){var e=this.projectInfo.info.units;if(e.length>0)for(var t=0;t<e.length;t++)switch(e[t].unitType){case 1:this.buildUnits[0].unitName||this.buildUnits.splice(0,1),this.buildUnits.push(e[t]);break;case 2:this.mainContractorUnits[0].unitName||this.mainContractorUnits.splice(0,1),this.mainContractorUnits.push(e[t]);break;case 3:this.supervisingUnits[0].unitName||this.supervisingUnits.splice(0,1),this.supervisingUnits.push(e[t]);break;case 4:this.designUnits[0].unitName||this.designUnits.splice(0,1),this.designUnits.push(e[t]);break;case 5:this.explorationUnits[0].unitName||this.explorationUnits.splice(0,1),this.explorationUnits.push(e[t])}var a=this.projectInfo.info.projectManager;if(a&&JSON.parse(a)&&JSON.parse(a).length>0){var i=JSON.parse(a);this.managers=i}},getProjectInfo:function(){var e=this;this.$axios({method:"get",headers:{},params:{projectId:this.projectInfo.id},url:"web/project/queryProject"}).then(function(t){if(0==t.data.code){var a=t.data.info[0],i={steps:a.allTime,planStartTime:a.planStartTime,planEndTime:a.planEndTime,units:a.unit,projectManager:a.projectManager};e.projectInfo.info=i,e.doSteps(),e.unitsAndmangers()}})}}},x=(i("77b8"),Object(o.a)(_,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"programInfo"},[a("div",{staticClass:"topDiv"},[a("div",{staticClass:"spaceTimeDiv"},e._l(e.steps,function(t,i){return a("label",{directives:[{name:"show",rawName:"v-show",value:i<6,expression:"index < 6"}],key:t.name+i+"space",class:{hide:0==t.space,textBlack:i==e.currentStep-1}},[e._v(e._s(t.space)+"天")])}),0),a("el-steps",{staticStyle:{width:"85%"},attrs:{active:e.currentStep,"align-center":""}},e._l(e.steps,function(e,t){return a("el-step",{key:e.name+t,attrs:{title:e.name,description:e.time}})}),1)],1),a("div",{staticClass:"bottomDiv"},[a("el-form",{staticStyle:{width:"55%","pointer-events":"none"},attrs:{"label-width":"130px"}},[a("el-form-item",{attrs:{label:"风险等级"}},[a("el-color-picker",{staticStyle:{width:"100%"},attrs:{predefine:e.predefineColors},model:{value:e.projectInfo.riskLevel,callback:function(t){e.$set(e.projectInfo,"riskLevel",t)},expression:"projectInfo.riskLevel"}})],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"计划起止时间"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.planTime.start,callback:function(t){e.$set(e.planTime,"start",t)},expression:"planTime.start"}})],1)],1),a("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),a("el-col",{attrs:{span:11}},[a("el-form-item",[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"选择日期",type:"date","value-format":"yyyy-MM-dd",editable:!1},model:{value:e.planTime.end,callback:function(t){e.$set(e.planTime,"end",t)},expression:"planTime.end"}})],1)],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"实际起止时间"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",editable:!1},model:{value:e.steps[0].time,callback:function(t){e.$set(e.steps[0],"time",t)},expression:"steps[0].time"}})],1)],1),a("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"planEndTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"选择日期",type:"date","value-format":"yyyy-MM-dd",editable:!1},model:{value:e.steps[6].time,callback:function(t){e.$set(e.steps[6],"time",t)},expression:"steps[6].time"}})],1)],1)],1)],1),e._l(e.buildUnits,function(t,i){return a("el-col",{key:"buildUnits"+i,attrs:{span:12}},[a("el-form-item",{attrs:{label:0==i?"建设单位":""}},[a("el-input",{model:{value:t.unitName,callback:function(a){e.$set(t,"unitName",a)},expression:"item.unitName"}})],1)],1)}),e.buildUnits.length%2==1&&e.buildUnits.length+e.mainContractorUnits.length>2?a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{staticStyle:{visibility:"hidden"}})],1)],1):e._e(),e._l(e.mainContractorUnits,function(t,i){return a("el-col",{key:"mainContractorUnits"+i,attrs:{span:12}},[a("el-form-item",{attrs:{label:0==i?"总包单位":""}},[a("el-input",{model:{value:t.unitName,callback:function(a){e.$set(t,"unitName",a)},expression:"item.unitName"}})],1)],1)}),e.mainContractorUnits.length%2==1&&e.supervisingUnits.length+e.mainContractorUnits.length>2?a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{staticStyle:{visibility:"hidden"}})],1)],1):e._e(),e._l(e.supervisingUnits,function(t,i){return a("el-col",{key:"supervisingUnits"+i,attrs:{span:12}},[a("el-form-item",{attrs:{label:0==i?"监理单位":""}},[a("el-input",{model:{value:t.unitName,callback:function(a){e.$set(t,"unitName",a)},expression:"item.unitName"}})],1)],1)}),e.supervisingUnits.length%2==1&&e.supervisingUnits.length+e.designUnits.length>2?a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{staticStyle:{visibility:"hidden"}})],1)],1):e._e(),e._l(e.designUnits,function(t,i){return a("el-col",{key:"designUnits"+i,attrs:{span:12}},[a("el-form-item",{attrs:{label:0==i?"设计单位":""}},[a("el-input",{model:{value:t.unitName,callback:function(a){e.$set(t,"unitName",a)},expression:"item.unitName"}})],1)],1)}),e.designUnits.length%2==1&&e.designUnits.length+e.explorationUnits.length>2?a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{staticStyle:{visibility:"hidden"}})],1)],1):e._e(),e._l(e.explorationUnits,function(t,i){return a("el-col",{key:"explorationUnits"+i,attrs:{span:12}},[a("el-form-item",{attrs:{label:0==i?"勘察单位":""}},[a("el-input",{model:{value:t.unitName,callback:function(a){e.$set(t,"unitName",a)},expression:"item.unitName"}})],1)],1)}),e.explorationUnits.length%2==1&&e.explorationUnits.length+e.managers.length>2?a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{staticStyle:{visibility:"hidden"}})],1)],1):e._e(),e._l(e.managers,function(t,i){return a("el-col",{key:"managers"+i,attrs:{span:12}},[a("el-form-item",{attrs:{label:0==i?"项目经理":""}},[a("el-input",{staticStyle:{width:"30%"},attrs:{placeholder:"姓名"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}}),a("el-input",{staticStyle:{width:"65%","margin-left":"5%"},attrs:{placeholder:"联系方式"},model:{value:t.contact,callback:function(a){e.$set(t,"contact",a)},expression:"item.contact"}})],1)],1)})],2)],1)])},[],!1,null,null,null).exports),N=(i("77a4"),i("5d08"),i("7736")),j={name:"EchartsList",data:function(){return{loading:!1,station:{},virDevsData:[],echartsData:[],pointData:[],overflowY:"auto",myChartList:{},currentEcharts:""}},computed:Object(m.a)({},Object(N.c)("chartExhibition",["devGuids","devPoints"])),created:function(){this.station=this.$store.state.freezenStation,this.station},beforeDestroy:function(){for(var e in this.myChartList)this.myChartList[e].dispose()},watch:{devPoints:{handler:function(e){for(var t in this.myChartList)this.myChartList[t].dispose();this.concurrentRequests(e)},immediate:!1}},methods:{creatEchartData:function(){var e=this;this.echartsData=[],0!=this.virDevsData.length&&0!=this.pointData.length&&(this.virDevsData.forEach(function(t){var a={name:t.aliasDevName?t.aliasDevName:t.devName,devGuid:t.devGuid,devVirVars:[]};t.virVars.forEach(function(t){e.pointData.forEach(function(e,i){if(e[0].guid==t.varGuid){var r={varGuid:t.varGuid,varName:t.varName,varData:e};a.devVirVars.push(r)}})}),0!=a.devVirVars.length&&e.echartsData.push(a)}),this.processingData(this.echartsData))},concurrentRequests:function(e){var t=this;this.loading=!0,this.$axios.all([this.queryDevsAndVarsByStationGuid(this.station.stationGuid),this.getChartData(e)]).then(this.$axios.spread(function(e,a){if(t.loading=!1,0==e.data.code){var i=e.data.info;i.virDevs&&(t.virDevsData=[],t.devGuids,t.devGuids.forEach(function(e){i.virDevs.forEach(function(a,i){a.virVars&&(a.virVars.forEach(function(i,r){i.varGuid==e&&t.virDevsData.push(a)}),a.devGuid==e&&t.virDevsData.push(a))})})),t.virDevsData=t.deWeight(t.virDevsData),t.virDevsData}if(0==a.data.code){var r=a.data.info;if("{}"==JSON.stringify(r))return void t.$showMessage("error","未找到数据！");t.pointData=Object.values(r)}t.creatEchartData()})).catch(function(e,a){t.loading=!1,t.$showMessage("error",e+a)})},deWeight:function(e){for(var t=0;t<e.length-1;t++)for(var a=t+1;a<e.length;a++)e[t].devName==e[a].devName&&(e.splice(a,1),a--);return e},queryDevsAndVarsByStationGuid:function(e){return this.$axios({method:"get",headers:{},url:"/web/station/queryVirDevsVirVars",params:{stationGuid:e}})},getChartData:function(e){return e.toString(),this.station,this.$axios({method:"post",headers:{},data:{varGuids:e.toString(),proGuid:this.station.stationGuid},url:"web/projectdisplay/getHistDataCurve"})},processingData:function(e){var t=this;0!=e.length?(this.$nextTick(function(){e.forEach(function(e,a){t.showChart(e,"echarts"+e.devGuid)})}),e.length<=9&&e.length>6&&(this.overflowY="hidden")):this.$showMessage("warning","未查询到测温孔数据")},showChart:function(t,a){var i=this,r=this,s=document.getElementById(a);if(s){this.myChartList[a]=this.$echarts.init(s);var n=["#8B5CFF","#00CA69","#458FE3","#f748ae","#FFAE37","#48c4f7","#FB8989","#CA89FB"],o=t.devVirVars[0].varData.map(function(e){return e.time}),l=[],u=t.devVirVars.map(function(e,t){var a,r,s,u=e.varData.map(function(e){return e.value});return i.station.freezeTime&&!o.includes(i.station.freezeTime)?(l=[i.station.freezeTime].concat(Object(c.a)(o)),u=[""].concat(Object(c.a)(u))):l=o,{name:e.varName,type:"line",smooth:!0,symbolSize:8,zlevel:3,lineStyle:{normal:{color:n[t],shadowBlur:3,shadowColor:(a=n[t],r=.5,s="",/^#[\da-f]{6}$/i.test(a)&&(s="rgba(".concat(parseInt("0x"+a.slice(1,3)),",").concat(parseInt("0x"+a.slice(3,5)),",").concat(parseInt("0x"+a.slice(5,7)),",").concat(r,")")),s),shadowOffsetY:8}},symbol:"circle",data:u}}),d={title:{show:!0,text:t.name,left:"2%"},backgroundColor:"#fff",color:n,legend:{top:0,right:30,width:"70%"},tooltip:{confine:!0,trigger:"axis",formatter:function(e){var t="";return r.station.freezeTime&&e[0].name==r.station.freezeTime&&(t+="开始冻结",!e[0].value)?t+="：".concat(e[0].name):(e.forEach(function(e){t+='<div style="color: #666;font-size: 14px;line-height: 24px">\n                <span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:'.concat(n[e.componentIndex],';"></span>\n                ').concat(e.seriesName,".").concat(e.name,'  \n                <span style="color:').concat(n[e.componentIndex],';font-weight:700;font-size: 18px;margin-left:5px">').concat(e.value,"</span>\n                ℃")}),t)},extraCssText:"background: rgba(255,255,255,0.7); border-radius: 0;box-shadow: 0 0 3px rgba(0, 0, 0, 0.2);color: #333;z-index:9999;"},grid:{top:"30%",left:"4%",right:"6%",bottom:"4%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,axisLabel:{showMaxLabel:!0,showMinLabel:!0,formatter:function(e){return e.slice(5)},textStyle:{color:"#333"}},axisLine:{lineStyle:{color:"#D9D9D9"}},data:l}],yAxis:[{type:"value",scale:!0,axisLabel:{textStyle:{color:"#666"}},nameTextStyle:{color:"#666",fontSize:12,lineHeight:40},splitLine:{lineStyle:{type:"dashed",color:"#E9E9E9"}},axisLine:{show:!1},axisTick:{show:!1}}],series:u,toolbox:{show:!0,feature:{myTool1:{show:!0,title:"放大",icon:"path://M432.45,595.444c0,2.177-4.661,6.82-11.305,6.82c-6.475,0-11.306-4.567-11.306-6.82s4.852-6.812,11.306-6.812C427.841,588.632,432.452,593.191,432.45,595.444L432.45,595.444z M421.155,589.876c-3.009,0-5.448,2.495-5.448,5.572s2.439,5.572,5.448,5.572c3.01,0,5.449-2.495,5.449-5.572C426.604,592.371,424.165,589.876,421.155,589.876L421.155,589.876z M421.146,591.891c-1.916,0-3.47,1.589-3.47,3.549c0,1.959,1.554,3.548,3.47,3.548s3.469-1.589,3.469-3.548C424.614,593.479,423.062,591.891,421.146,591.891L421.146,591.891zM421.146,591.891",onclick:function(e){i.currentEcharts=e.option.title[0].text,i.$emit("showEcharts",e.option)}}}}};this.myChartList[a].setOption(d),this.currentEcharts==this.myChartList[a]._model.option.title[0].text&&this.$emit("showEcharts",e.option),this.$erd.listenTo(document.getElementById(a),function(e){i.myChartList[a].resize()})}}}},$=(i("5f79"),Object(o.a)(j,function(){var e=this.$createElement,t=this._self._c||e;return t("el-main",{directives:[{name:"loading",rawName:"v-loading",value:this.loading,expression:"loading"}],staticClass:"EchartsList",style:{overflowY:this.overflowY}},this._l(this.echartsData,function(e){return t("div",{key:e.devGuid,staticClass:"echartsItem",attrs:{id:"echarts"+e.devGuid}})}),0)},[],!1,null,null,null).exports),F=i("3727"),G=i.n(F),O={name:"VideoPlayer",data:function(){return{playErrorRefresh:!0,videoPlayer:null}},props:{domId:{type:String},videoInfo:{type:Object}},mounted:function(){this.videoInfo.accessToken?this.$nextTick(function(){this.playVideo()}):this.getAccessToken(!0)},methods:{getAccessToken:function(e){var t=this;this.$axios({method:"get",params:{projectId:this.videoInfo.projectId},url:"/web/video/getAccessToken"}).then(function(a){var i=a.data;0==i.code&&(t.videoInfo.accessToken=i.info,e&&t.playVideo())}).catch(function(e){Object(s.j)("error",e)})},handleError:function(e){"10002"==e.code&&this.playErrorRefresh&&(this.getAccessToken(!0),this.playErrorRefresh=!1)},handleSuccess:function(e){},playVideo:function(){this.videoPlayer&&(this.videoPlayer.stop(),this.videoPlayer=null,document.getElementById(this.domId).innerHTML=null),this.videoPlayer=new G.a.EZUIKitPlayer({autoplay:!0,id:this.domId,accessToken:this.videoInfo.accessToken,url:"ezopen://open.ys7.com/"+this.videoInfo.serialNum+"/"+this.videoInfo.channelNum+".hd.live",template:"standard",audio:0,handleSuccess:this.handleSuccess,handleError:this.handleError})}}},I=(i("5b5a"),{name:"VideoList",data:function(){return{station:{id:"",name:"",stationGuid:"",rights:""},videoArr:[],queryScreenShotsNum:0,accessToken:""}},components:{videoPlayer:Object(o.a)(O,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"VideoPlayer"},[t("div",{staticClass:"VideoPlayerContent",attrs:{id:this.domId}})])},[],!1,null,null,null).exports},created:function(){this.station=this.$store.state.freezenStation,this.getAccessToken(),this.station.id&&this.getStationVideoList()},mounted:function(){this.videoListClick(0)},methods:{getStationVideoList:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/video/queryVideos",params:{projectId:this.station.id}}).then(function(t){var a=t.data;if(0==a.code){for(var i=0;i<a.info.length;i++)a.info[i].selected=!1,a.info[i].imgUrl="";e.videoArr=a.info,e.accessToken&&e.getVideoScreenShots()}}).catch(function(e){})},getVideoScreenShots:function(){var e=this;if(this.videoArr[this.queryScreenShotsNum]){var t={accessToken:this.accessToken.toString(),deviceSerial:this.videoArr[this.queryScreenShotsNum].serialNum,channelNo:this.videoArr[this.queryScreenShotsNum].channelNum};this.$axios({method:"post",url:"https://open.ys7.com/api/lapp/device/capture",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.$qs.stringify(t)}).then(function(t){var a=t.data;if(200==a.code){var i=e.videoArr[e.queryScreenShotsNum];i.imgUrl=a.data.picUrl,e.$set(e.videoArr,e.queryScreenShotsNum,i)}e.queryScreenShotsNum++,e.getVideoScreenShots()}).catch(function(t){e.queryScreenShotsNum++,e.getVideoScreenShots()})}},videoListClick:function(e){for(var t=0;t<this.videoArr.length;t++)t==e?(this.videoArr[t].selected=!0,this.videoArr[t].projectId=this.station.id,this.videoArr[t].accessToken=this.accessToken,this.$set(this.videoArr,t,this.videoArr[t]),this.$store.commit("set_g_videoInfo",this.videoArr[t])):this.videoArr[t].selected=!1},getAccessToken:function(){var e=this;this.$axios({method:"get",headers:{},params:{projectId:this.station.id},url:"/web/video/getAccessToken"}).then(function(t){var a=t.data;0==a.code&&(e.accessToken=a.info,e.videoArr.length>0&&(e.queryScreenShotsNum=0,e.getVideoScreenShots()))}).catch(function(e){})}}}),A=(i("56cd"),{data:function(){return{station:{id:"",name:"",stationGuid:""},selectedVarArr:[],defauldVarGuids:"",backDev:"",defaultChart:null,isRefreshDialog:!1,imgUrl:{front:"",back:""},tiemer:null,echartsObj:null,dialogTitle:"",echartsShowFlag:!1}},components:{EchartsList:$,VideoList:Object(o.a)(I,function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticClass:"VideoList"},this._l(this.videoArr,function(e){return t("li",{key:e.httpAddress},[t("videoPlayer",{attrs:{domId:"video"+e.videoId,videoInfo:e}})],1)}),0)},[],!1,null,null,null).exports},mounted:function(){this.station=this.$store.state.freezenStation,this.setTimeoutFn(),this.getProjectConfig(),this.getPicUrl()},beforeDestroy:function(){clearInterval(this.tiemer),this.tiemer=null},methods:Object(m.a)(Object(m.a)({},Object(N.b)("chartExhibition",["set_devGuids","set_devPoints"])),{},{setTimeoutFn:function(){var e=this;this.tiemer=setInterval(function(){e.getProjectConfig(),new Date},36e5)},getPicUrl:function(){this.imgUrl.front="/uploadFile/"+this.station.id+"/img/front.jpg?_t="+(new Date).getTime(),this.imgUrl.back="/uploadFile/"+this.station.id+"/img/back.jpg?_t="+(new Date).getTime()},getProjectConfig:function(){var e=this;this.$axios({method:"get",headers:{},url:"web/project/queryProjectConfig",params:{projectId:this.station.id,type:1}}).then(function(t){var a=t.data;if(0==a.code&&a.info){var i=JSON.parse(a.info),r=[];i.goSide&&i.goSide.varGuid&&r.push(i.goSide.varGuid),i.comeSide&&i.comeSide.varGuid&&r.push(i.comeSide.varGuid);var s=Object.values(i.frontVarsJson),n=Object.values(i.backVarsJson);e.set_devPoints([].concat(r,Object(c.a)(s),Object(c.a)(n)));var o=Object.keys(i.frontVarsJson),l=Object.keys(i.backVarsJson);e.set_devGuids([].concat(r,Object(c.a)(o),Object(c.a)(l)))}else e.$showMessage("error","未找到数据！")}).catch(function(e){})},dialogClose:function(){this.$refs.echartsList.currentEcharts=""},chartDialogOpenedHandle:function(){},showEcharts:function(e){var t=this;this.echartsShowFlag=!0,this.$nextTick(function(){if(!t.echartsObj){var a=document.getElementById("echartsEnlarge");if(!a&&!t.echartsObj)return;t.echartsObj=t.$echarts.init(a)}var i=t;t.dialogTitle=e.title[0].text;var r=e.color,s={title:e.title,backgroundColor:"#fff",color:r,legend:{top:0,right:30,width:"70%"},tooltip:{confine:!0,trigger:"axis",formatter:function(e){var t="";return i.station.freezeTime&&e[0].name==i.station.freezeTime&&(t+="开始冻结",!e[0].value)?t+="：".concat(e[0].name):(e.forEach(function(e){t+='<div style="color: #666;font-size: 14px;line-height: 24px">\n                <span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:'.concat(r[e.componentIndex],';"></span>\n                ').concat(e.seriesName,".").concat(e.name,'  \n                <span style="color:').concat(r[e.componentIndex],';font-weight:700;font-size: 18px;margin-left:5px">').concat(e.value,"</span>\n                ℃")}),t)},extraCssText:"background: rgba(255,255,255,0.7); border-radius: 0;box-shadow: 0 0 3px rgba(0, 0, 0, 0.2);color: #333;z-index:9999;"},grid:{top:"10%",left:"4%",right:"6%",bottom:"4%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,axisLabel:{showMaxLabel:!0,showMinLabel:!0,formatter:function(e){return e.slice(5)},textStyle:{color:"#333"}},axisLine:{lineStyle:{color:"#D9D9D9"}},data:e.xAxis[0].data}],yAxis:[{type:"value",scale:!0,axisLabel:{textStyle:{color:"#666"}},nameTextStyle:{color:"#666",fontSize:12,lineHeight:40},splitLine:{lineStyle:{type:"dashed",color:"#E9E9E9"}},axisLine:{show:!1},axisTick:{show:!1}}],series:e.series};t.echartsObj.setOption(s),t.$erd.listenTo(document.getElementById("echartsEnlarge"),function(e){t.echartsObj.resize()})})}}),destroyed:function(){this.echartsObj&&this.echartsObj.dispose()}}),V=(i("9aea"),{data:function(){return{station:{id:"",name:""},tabBtnArr:[],comName:"",reWrite:!0}},components:{freezeRealData:d,stationDevice:p,programVideo:g,inclinometerData:b,projectReport:w,configuration:k,programInfo:x,chartExhibition:Object(o.a)(A,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chartExhibition"},[a("div",{staticClass:"leftContent"},[a("div",{staticClass:"leftDiv"},[a("EchartsList",{ref:"echartsList",on:{showEcharts:e.showEcharts}})],1)]),a("div",{staticClass:"rightContent"},[a("div",{staticClass:"rightTopDiv"},[a("div",{staticClass:"rightTopContent"},[a("div",{staticClass:"rightBack contentItem"},[e._m(0),a("div",{staticClass:"thePic"},[a("img",{attrs:{src:e.imgUrl.front}})])]),a("div",{staticClass:"rightBack contentItem",staticStyle:{"margin-left":"10px"}},[e._m(1),a("div",{staticClass:"thePic"},[a("img",{attrs:{src:e.imgUrl.back}})])])])]),a("div",{staticClass:"rightBottomDiv"},[e._m(2),a("div",{staticClass:"rightBottomContent"},[a("VideoList")],1)])]),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"GraphHistoryCurve",attrs:{title:"",visible:e.echartsShowFlag,width:"10rem",top:"1rem",modal:!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.echartsShowFlag=t},opened:e.chartDialogOpenedHandle,close:e.dialogClose}},[a("div",{attrs:{id:"echartsEnlarge"}})])],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"theTitle",staticStyle:{"margin-left":"10px"}},[t("span",[this._v("正面展示")]),t("div",{staticClass:"titleIcon"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"theTitle",staticStyle:{"margin-left":"10px"}},[t("span",[this._v("背面展示")]),t("div",{staticClass:"titleIcon"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"theTitle",staticStyle:{flex:"0.12"}},[t("span",[this._v("项目视频")]),t("div",{staticClass:"titleIcon"})])}],!1,null,null,null).exports},created:function(){this.doProjectionInfo()},methods:{changeToDisplayBoard:function(e){"displayBoard"==e&&(this.doProjectionInfo(),this.reWrite=!1,this.$nextTick(function(){this.reWrite=!0}),this.$store.commit("set_g_freezeDataComName","freezeStationList"))},doProjectionInfo:function(){if(this.station=this.$store.state.freezenStation,this.tabBtnArr=[],this.comName="",this.station.rights){var e=JSON.parse(this.station.rights);e.isProjectExhibition&&this.tabBtnArr.push({name:"曲线展板",selected:!1,comName:"chartExhibition"}),e.isTemperature&&this.tabBtnArr.push({name:"冻结面",selected:!1,comName:"freezeRealData"}),this.tabBtnArr.push({name:"站内设备",selected:!1,comName:"stationDevice"}),e.isVideo&&this.tabBtnArr.push({name:"项目视频",selected:!1,comName:"programVideo"}),e.isSurvey&&this.tabBtnArr.push({name:"测斜数据",selected:!1,comName:"inclinometerData"}),e.isGraphPage&&this.tabBtnArr.push({name:"组态画面",selected:!1,comName:"configuration"})}this.tabBtnArr.push({name:"数据报表",selected:!1,comName:"projectReport"}),this.tabBtnArr.push({name:"项目信息",selected:!1,comName:"programInfo"}),this.tabBtnArr.length>0&&(this.$set(this.tabBtnArr[0],"selected",!0),this.comName=this.tabBtnArr[0].comName)},backToStationList:function(){this.$emit("changeComponent","freezeStationList")},tabBtnClick:function(e){for(var t=0;t<this.tabBtnArr.length;t++)this.tabBtnArr[t].selected=t==e;this.comName=this.tabBtnArr[e].comName}}}),P=(i("ffb1"),{name:"FreezeData",data:function(){return{cashViews:["freezeStationList"],comName:"",reWrite:!0}},components:{freezeStationList:l,displayBoard:Object(o.a)(V,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"temperature"},[a("div",{staticClass:"headDiv"},[a("div",{staticStyle:{display:"flex",flex:"0.45","align-items":"center"}},[a("el-button",{staticClass:"backBtn",attrs:{icon:"el-icon-ai207",size:"mini"},on:{click:e.backToStationList}}),a("p",{staticClass:"title",staticStyle:{"margin-left":"10px"}},[e._v("项目名称：")]),a("p",{staticClass:"title",staticStyle:{"margin-right":"30px"}},[e._v(" "+e._s(e.station.name)+" ")])],1),e._l(e.tabBtnArr,function(t,i){return a("div",{key:i},[a("div",{staticClass:"button hand-css",class:{"button-active":1==t.selected},on:{click:function(t){return e.tabBtnClick(i)}}},[e._v(" "+e._s(t.name)+" ")]),i<e.tabBtnArr.length-1?a("div",{staticClass:"button"},[e._v("/")]):e._e()])})],2),a("div",{staticClass:"bodyDiv"},[e.reWrite?a(e.comName,{tag:"component"}):e._e()],1)])},[],!1,null,null,null).exports},inject:["reload"],computed:{g_freezeDataComNameChanged:function(){return this.$store.state.g_freezeDataComName}},watch:{g_freezeDataComNameChanged:function(e){this.changeToDisplayBoard(e)}},mounted:function(){window.location.href;var e=decodeURI(window.location.href),t=e.split("?");t[0].split("/");if(-1!=e.indexOf("stationGuid")){var a=t[1].split("&"),i={};for(var r in a){var s=a[r].split("="),n=s[1];"true"==n&&(n=!0),"false"==n&&(n=!1),i[s[0]]=n}var o={id:i.projectId,name:i.projectName,stationGuid:i.stationGuid,rights:JSON.stringify(i)};this.$store.commit("set_freezenStation",o),this.comName="displayBoard"}else this.comName=JSON.parse(JSON.stringify(this.$store.state.g_freezeDataComName)),this.$store.commit("set_g_freezeDataComName","freezeStationList")},methods:{changeToDisplayBoard:function(e){"displayBoard"==e&&this.reload()},changeComponentAct:function(e){this.comName=e}}}),z=(i("4609"),Object(o.a)(P,function(){var e=this.$createElement,t=this._self._c||e;return t("keep-alive",{attrs:{include:this.cashViews}},[t(this.comName,{tag:"component",on:{changeComponent:this.changeComponentAct}})],1)},[],!1,null,null,null));a.default=z.exports},"0bab":function(e,t,a){var i=a("8fe5"),r=a("e505"),s=a("b7d9"),n=a("9f6b").f,o=function(e){return function(t){for(var a,o=s(t),l=r(o),c=l.length,u=0,d=[];c>u;)a=l[u++],i&&!n.call(o,a)||d.push(e?[a,o[a]]:o[a]);return d}};e.exports={entries:o(!0),values:o(!1)}},"0bec":function(e,t,a){},"12ba":function(e,t,a){"use strict";a("32b4")},"20da":function(e,t,a){"use strict";a.r(t);var i=a("3785"),r=(a("5b12"),a("9b5f"),a("3bae"),a("1d43"),a("bf2f"),a("3de1")),s={data:function(){return{customReportList:[],selectedVarArr:[],selectedVarGuidArr:[],queryTimeRange:["",""],timeEditable:!1,spaceType:3600,spaceTypeArr:[{value:3600,label:"整点"},{value:600,label:"全部"},{value:86400,label:"一天"}],pickerOptions:{disabledDate:function(e){return e.getTime()>(new Date).getTime()}},timeSpanArr:[],tableData:[],tableHeight:"",varSelectTableHeight:"",search:"",varSelectSearch:"",currentPage:1,pageSize:10,tableLoading:!1,json_fields:{"记录时间":"formatTime","变量名称":"name","记录值":"value"},chartDialogVisible:!1,hisChart:null,chartTimeArr:[],varDialogVisible:!1,treeData:[],treeProps:{children:"children",label:"name"},varSelectTableData:[],tempStation:{},currentStation:{},saveDialogVisible:!1,deleteDialogVisible:!1,toDeleteReport:null,newReportName:"",xData:[],legendData:[],seriesData:[],expandedKeys:[]}},created:function(){this.getCustomReportList(),this.getProjectList(),this.queryTimeRange[0]=this.getLateDays(1),this.queryTimeRange[1]=this.getLateDays(0)},computed:{},mounted:function(){this.getTableHeight()},methods:{getCustomReportList:function(){var e=this;this.$axios({method:"get",url:"/web/histreport/queryAllReport"}).then(function(t){var a=t.data;0==a.code?e.customReportList=a.info:e.customReportList=[]}).catch(function(t){e.customReportList=[],alert(t)})},leftLiClick:function(e){if(!this.customReportList[e].selected)for(var t=0;t<this.customReportList.length;t++)t==e?(this.customReportList[t].selected=!0,this.currentStation=this.customReportList[t],this.selectedVarGuidArr=this.customReportList[t].varGuids.split(","),this.selectedVarArr=[],this.getStationVar(this.customReportList[t].stationGuid,!1)):this.customReportList[t].selected=!1},getProjectList:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/project/queryGroupsProjects"}).then(function(t){var a=t.data;if(0==a.code){for(var i=[],s=!1,n=0;n<a.info.length;n++)1==a.info[n].type?(a.info[n].biaoqian="el-tree-city",61==a.info[n].id&&(s=!0)):a.info[n].biaoqian="el-tree-project",(2!=a.info[n].type||a.info[n].stationGuid)&&1!=a.info[n].id&&i.push(a.info[n]),1==a.info[n].pId&&e.expandedKeys.push(a.info[n].id);var o=Object(r.a)(i);s&&(o=Object(r.k)(o)),e.treeData=o}}).catch(function(e){Object(r.j)("error",e)})},deleteNoneProjectOrg:function(e){var t=[];e.forEach(function(e){t.push(e.pId)});for(var a=[],i=0;i<e.length;i++)2!=e[i].type&&-1==t.indexOf(e[i].id)||a.push(e[i]);if(a.length==e.length){this.treeData=Object(r.a)(a);for(var s=0;s<this.treeData.length;s++)this.expandedKeys.push(this.treeData[s].id)}else this.deleteNoneProjectOrg(a)},handleNodeClick:function(e,t,a){2==e.type&&e.stationGuid?(this.getStationVar(e.stationGuid,!0),this.tempStation=e):this.varSelectTableData=[]},getStationVar:function(e,t){var a=this;this.$axios({method:"get",headers:{},url:"/web/station/queryVirDevsVirVars",params:{stationGuid:e}}).then(function(i){var r=i.data;if(0==r.code&&r.info){var s=r.info.virDevs;if(s){for(var n=[],o=0;o<s.length;o++)for(var l=s[o].virVars,c=s[o].devName,u=0;u<l.length;u++)l[u].devName=c,l[u].stationGuid=e,n.push(l[u]);if(t)a.varSelectTableData=n,a.varDialogOpenedHandle();else{var d=[];a.selectedVarGuidArr.forEach(function(e){d.push(null)}),n.forEach(function(e){var t=a.selectedVarGuidArr.indexOf(e.varGuid);-1!=t&&(d[t]=e)}),a.selectedVarArr=d}}}else a.varSelectTableData=[]}).catch(function(e){a.varSelectTableData=[]})},handleSelectionChange:function(e){},varSelectConfirm:function(){var e,t=this,a=this.$refs.varSelectTable.selection;this.selectedVarArr=(e=a,Object(i.a)(e),e),this.currentStation=this.tempStation,a.forEach(function(e){t.selectedVarGuidArr.push(e.varGuid)}),this.varDialogVisible=!1},queryHisData:function(){var e=this;if(0!=this.selectedVarArr.length)if(0!=this.queryTimeRange[0].length)if(0!=this.queryTimeRange[1].length)if(new Date(this.queryTimeRange[1]).getTime()>(new Date).getTime())Object(r.j)("warning","不能大于当前时间");else{var t="";this.selectedVarArr.forEach(function(e){t=t+e.varGuid+","}),t=t.substring(0,t.length-1),this.tableLoading=!0,this.$axios({method:"get",url:"/web/hisdata/queryAllHisDataByTimeSpan",params:{timeFrom:this.queryTimeRange[0],timeTo:this.queryTimeRange[1],varGuids:t,timeSpan:this.spaceType,stationGuid:this.currentStation.stationGuid}}).then(function(t){e.tableLoading=!1;var a=t.data;if(0==a.code){var i={};e.selectedVarArr.forEach(function(e){i[e.varGuid]=e.devName+"/"+e.varName});for(var s=a.info.vars,n=0;n<s.length;n++)s[n].name=i[s[n].guid],s[n].commStateStr=1==s[n].commState?"通信正常":"通信异常",s[n].formatTime=Object(r.c)(1e3*s[n].time);e.tableData=s}else e.tableData=[]}).catch(function(t){e.tableLoading=!1,e.tableData=[],alert(t)})}else Object(r.j)("warning","请选择结束时间");else Object(r.j)("warning","请选择开始时间");else Object(r.j)("warning","请选择变量")},saveNewCustomReportTable:function(){0!=this.selectedVarArr.length?(this.newReportName="",this.saveDialogVisible=!0):Object(r.j)("warning","请选择变量")},saveNewReportConfirm:function(){var e=this;if(0!=this.newReportName.length){var t="";this.selectedVarArr.forEach(function(e){t=t+e.varGuid+","}),t=t.substring(0,t.length-1),this.$axios.post("/web/histreport/addReport",{reportName:this.newReportName,stationGuid:this.currentStation.stationGuid,projectId:this.currentStation.id,varGuids:t}).then(function(t){e.saveDialogVisible=!1;var a=t.data;0==a.code?(e.getCustomReportList(),Object(r.j)("success",a.info)):Object(r.j)("error",a.info)}).catch(function(t){e.saveDialogVisible=!1,Object(r.j)("error","错误")})}else Object(r.j)("warning","请填写报表名称")},showChartDialog:function(){var e=this;if(0!=this.selectedVarArr.length)if(0!=this.queryTimeRange[0].length)if(0!=this.queryTimeRange[1].length)if(new Date(this.queryTimeRange[1]).getTime()>(new Date).getTime())Object(r.j)("warning","不能大于当前时间");else{this.xData=[],this.legendData=[],this.seriesData=[],this.chartDialogVisible=!0;var t="";this.selectedVarArr.forEach(function(e){t=t+e.varGuid+","}),t=t.substring(0,t.length-1),this.$axios({method:"get",url:"/web/hisdata/queryHisDataByTimeSpan",params:{timeFrom:this.queryTimeRange[0],timeTo:this.queryTimeRange[1],varGuids:t,timeSpan:this.spaceType,stationGuid:this.currentStation.stationGuid}}).then(function(t){var a=t.data;0==a.code&&(e.timeSpanArr=a.info.times,e.doChartData(a.info.vars))}).catch(function(e){})}else Object(r.j)("warning","请选择结束时间");else Object(r.j)("warning","请选择开始时间");else Object(r.j)("warning","请选择变量")},doChartData:function(e){var t=this;this.selectedVarArr.forEach(function(e){var a={};a.name=e.varName,t.legendData.push(a);var i={name:e.varName,data:[],type:"line",smooth:!0,connectNulls:!0};t.seriesData.push(i)});var a=[];this.timeSpanArr.forEach(function(e){a.push(Object(r.c)(1e3*e));for(var i=0;i<t.seriesData.length;i++)t.seriesData[i].data.push(null)}),this.xData=a,e.forEach(function(e){var a=t.selectedVarGuidArr.indexOf(e.guid),i=t.timeSpanArr.indexOf(e.breaktime);t.seriesData[a].data[i]=e.value}),this.chart||(this.chart=this.$echarts.init(document.getElementById("hisChart"))),this.chart.setOption({xAxis:{data:this.xData},yAxis:{type:"value"},tooltip:{show:!0,trigger:"axis"},legend:{data:this.legendData},toolbox:{left:"left",feature:{saveAsImage:{name:"历史数据曲线图"}}},series:this.seriesData})},tabeHeaderStyle:function(){return{"background-color":"#5299e71a","border-bottom":"1px solid #5299e7"}},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},getTableHeight:function(){this.tableHeight=window.getComputedStyle(this.$refs.hisTable).height.split("px")[0]-18},getLateDays:function(e){var t=new Date,a=new Date(t.getTime()-864e5*e),i="";return i+=a.getFullYear()+"-",i+=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,i+="-",i+=a.getDate()<10?"0"+a.getDate():a.getDate(),i+=" ",i+=a.getHours()<10?"0"+a.getHours():a.getHours(),i+=":",i+=a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes(),i+=":",i+=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds()},chartDialogOpenedHandle:function(){},varDialogOpenedHandle:function(){var e=this;this.selectedVarArr.length>0&&this.selectedVarGuidArr.length>0&&this.varSelectTableData.length>0&&this.varSelectTableData.forEach(function(t){-1!=e.selectedVarGuidArr.indexOf(t.varGuid)&&e.$refs.varSelectTable.toggleRowSelection(t,!0)})},showDeleteDialog:function(e,t){this.toDeleteReport=e,this.toDeleteReport.index=t,this.deleteDialogVisible=!0},deleteReportConfirm:function(){var e=this;this.toDeleteReport&&this.$axios({method:"get",url:"/web/histreport/delReport",params:{id:this.toDeleteReport.id,projectId:this.toDeleteReport.projectId}}).then(function(t){var a=t.data;0==a.code&&(e.customReportList.splice(e.toDeleteReport.index,1),Object(r.j)("success",a.info)),a.msg&&Object(r.j)("error;",a.msg),e.toDeleteReport=null,e.deleteDialogVisible=!1}).catch(function(t){e.toDeleteReport=null,e.deleteDialogVisible=!1})},cancelDelete:function(){this.toDeleteReport=null,this.deleteDialogVisible=!1}}},n=(a("385b"),a("5d22")),o=Object(n.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"queryReport"},[a("div",{staticClass:"leftDiv"},[a("p",{staticClass:"title"},[e._v("自定义报表")]),a("ul",{staticClass:"leftUl"},e._l(e.customReportList,function(t,i){return a("li",{key:i,staticClass:"leftLi",class:t.selected?"active":"",on:{click:function(t){return e.leftLiClick(i)}}},[e._v(" "+e._s(t.reportName)+" "),a("span",{staticClass:"el-icon-close reportDelete",on:{click:function(a){return e.showDeleteDialog(t,i)}}})])}),0)]),a("div",{staticClass:"rightDiv"},[a("p",{staticClass:"title",staticStyle:{"margin-left":"0"}},[e._v("历史数据查询")]),a("div",{staticClass:"topDiv"},[a("el-button",{staticClass:"btnFontSize",staticStyle:{color:"#5299e7"},on:{click:function(t){e.varDialogVisible=!0}}},[e._v("选择变量")]),a("p",{staticStyle:{"margin-left":"0.3rem"}},[e._v("已选择变量：")]),a("div",{staticClass:"selectedVarDiv"},e._l(e.selectedVarArr,function(t,i){return a("div",{key:i,staticStyle:{display:"flex"}},[a("p",{staticClass:"varName"},[e._v(e._s(t.varName))]),a("p",[e._v("、")])])}),0)],1),a("div",{staticClass:"middleDiv"},[a("p",{staticStyle:{"margin-left":"0.05rem"}},[e._v("开始：")]),a("el-date-picker",{attrs:{type:"datetime",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center"},model:{value:e.queryTimeRange[0],callback:function(t){e.$set(e.queryTimeRange,0,t)},expression:"queryTimeRange[0]"}}),a("p",{staticStyle:{"margin-left":"0.1rem"}},[e._v("结束：")]),a("el-date-picker",{attrs:{type:"datetime",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center"},model:{value:e.queryTimeRange[1],callback:function(t){e.$set(e.queryTimeRange,1,t)},expression:"queryTimeRange[1]"}}),a("p",{staticStyle:{"margin-left":"0.2rem"}},[e._v("间隔：")]),a("el-select",{staticStyle:{width:"1rem"},attrs:{placeholder:"请选择"},model:{value:e.spaceType,callback:function(t){e.spaceType=t},expression:"spaceType"}},e._l(e.spaceTypeArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),a("el-button",{staticClass:"btnFontSize",staticStyle:{"margin-left":"0.15rem"},attrs:{type:"primary"},on:{click:e.queryHisData}},[e._v("查询历史数据")]),a("el-button",{staticClass:"btnFontSize",staticStyle:{"margin-left":"2rem"},attrs:{icon:"el-icon-tickets"},on:{click:e.saveNewCustomReportTable}},[e._v("存为新报表")]),a("el-button",{staticClass:"btnFontSize",attrs:{icon:"el-icon-s-marketing"},on:{click:e.showChartDialog}},[e._v("生成曲线")]),a("download-excel",{staticClass:"export-excel-wrapper",attrs:{data:e.tableData,fields:e.json_fields,name:"历史数据.xlsx"}},[a("el-button",{staticClass:"btnFontSize",staticStyle:{"margin-left":"0.1rem"},attrs:{icon:"el-icon-document"}},[e._v("导出报表")])],1)],1),a("div",{ref:"hisTable",staticClass:"tableDiv"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData.filter(function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())||t.formatTime.toLowerCase().includes(e.search.toLowerCase())||t.commStateStr.toLowerCase().includes(e.search.toLowerCase())}).slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),stripe:"",height:e.tableHeight}},[a("el-table-column",{attrs:{align:"center",label:"记录时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.formatTime))]}}])}),a("el-table-column",{attrs:{align:"center",label:"变量名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),a("el-table-column",{attrs:{align:"center",label:"记录值"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.value))]}}])}),a("el-table-column",{attrs:{align:"right"}},[a("template",{slot:"header"},[a("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),a("el-pagination",{staticStyle:{float:"right","margin-top":"0.1rem"},attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.tableData.filter(function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())||t.formatTime.toLowerCase().includes(e.search.toLowerCase())||t.commStateStr.toLowerCase().includes(e.search.toLowerCase())}).length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{id:"chartDialog",visible:e.chartDialogVisible,width:"56%",modal:!1,"close-on-click-modal":!1,top:"24%"},on:{"update:visible":function(t){e.chartDialogVisible=t},opened:e.chartDialogOpenedHandle}},[a("div",{staticStyle:{width:"100%",height:"3.4rem"}},[a("div",{staticClass:"chart",style:{height:"100%",width:"100%"},attrs:{id:"hisChart"}})])]),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"选择变量",visible:e.varDialogVisible,width:"42%","close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.varDialogVisible=t},opened:e.varDialogOpenedHandle}},[a("div",{staticClass:"varDialogContent"},[a("div",{staticStyle:{flex:"0.3",padding:"0.1rem",overflow:"auto",background:"#d3d3d336",width:"30%"}},[a("el-tree",{ref:"tree",staticStyle:{background:"none"},attrs:{data:e.treeData,props:e.treeProps,"node-key":"id","default-expanded-keys":e.expandedKeys,"highlight-current":""},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{class:r.biaoqian}),e._v(" "+e._s(i.label)+" ")])])}}])})],1),a("div",{staticStyle:{flex:"0.7",padding:"0.1rem","flex-direction":"column"}},[a("div",{staticStyle:{height:"90%",width:"100%","overflow-y":"auto"}},[a("el-table",{ref:"varSelectTable",staticStyle:{width:"100%"},attrs:{data:e.varSelectTableData.filter(function(t){return!e.varSelectSearch||t.devName.toLowerCase().includes(e.varSelectSearch.toLowerCase())||t.varName.toLowerCase().includes(e.varSelectSearch.toLowerCase())}),height:"100%","row-key":"varGuid","tooltip-effect":"dark",stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),a("el-table-column",{attrs:{label:"设备名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.devName))]}}])}),a("el-table-column",{attrs:{label:"变量名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.varName))]}}])}),a("el-table-column",{attrs:{label:"变量类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.type))]}}])}),a("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{size:"mini",placeholder:"关键字"},model:{value:e.varSelectSearch,callback:function(t){e.varSelectSearch=t},expression:"varSelectSearch"}})]}}])})],1)],1)])]),a("div",{staticStyle:{flex:"0.1",padding:"5px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.varDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.varSelectConfirm}},[e._v("确定并退出")])],1)]),a("el-dialog",{attrs:{title:"存为新报表",visible:e.saveDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.saveDialogVisible=t}}},[a("div",{staticStyle:{display:"flex",width:"100%",height:"50px","justify-content":"center","align-items":"center","font-size":"16px"}},[a("span",[e._v("名称：")]),a("el-input",{staticStyle:{width:"50%"},attrs:{type:"text"},model:{value:e.newReportName,callback:function(t){e.newReportName=t},expression:"newReportName"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.saveDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveNewReportConfirm()}}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"确定删除此报表？",visible:e.deleteDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.deleteDialogVisible=t}}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelDelete}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.deleteReportConfirm()}}},[e._v("确 定")])],1)])],1)},[],!1,null,null,null);t.default=o.exports},"25f9":function(e,t,a){},"2a6f":function(e,t,a){"use strict";a("24a8");var i=a("3de1"),r={data:function(){return{configVarIndex:0,tableHeight:"100%",freezeConfigArrIn:[],freezeTableConfigIn:[],freezeImageList:[]}},watch:{freezeConfigArrIn:function(e){1==this.configStatus&&this.$emit("changeFreezeConfigArr",e)},freezeTableConfigIn:function(e){1==this.configStatus&&this.$emit("changeFreezeTableConfig",e)},freezeConfigArr:function(e){this.freezeConfigArrIn=e,e&&0!=e.length||(this.freezeConfigArrIn=[{varName:"变量1",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量2",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量3",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量4",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量5",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量6",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量7",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量8",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量9",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量10",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量11",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量12",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量13",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量14",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量15",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量16",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量17",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""}]),this.freezeConfigArr},freezeTableConfig:function(e){this.freezeTableConfigIn=e,e||(this.freezeTableConfigIn={isShow:"true",tableData:[]}),this.freezeTableConfig}},props:{freezeConfigArr:Array,configStatus:Number,freezeTableConfig:Object},mounted:function(){this.freezeImageList=this.$store.state.freezeImageList,this.freezeConfigArrIn=this.freezeConfigArr,this.freezeTableConfigIn=this.freezeTableConfig,this.freezeConfigArrIn&&0!=this.freezeConfigArrIn.length||(this.freezeConfigArrIn=[{varName:"变量1",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量2",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量3",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量4",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量5",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量6",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量7",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量8",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量9",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量10",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量11",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量12",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量13",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量14",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量15",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量16",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""},{varName:"变量17",varGuid:"",value:"0",isShow:"true",varUnit:"°C",isOnOff:0,number:0,bigImage:"",smallImage:""}]),this.freezeTableConfigIn&&this.freezeConfigArrIn!={}||(this.freezeTableConfigIn={isShow:"true",tableData:[]})},methods:{getImgSrc:function(e){return Object(i.e)(e,this.freezeImageList)},getBorderClass:function(e){return"border"+(parseInt(e)+1)},getParamClass:function(e){return"param"+(parseInt(e)+1)},multipleDialogShow:function(){1==this.configStatus&&this.$emit("multipleDialogShow")},freezeParamConfig:function(e){1==this.configStatus&&this.$emit("freezeParamConfig",e)},showStatus:function(e){e.isShow=!e.isShow}}},s=(a("7b02"),a("5d22")),n=Object(s.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"freeze-template1"},[1==e.configStatus||0==e.configStatus&&e.freezeTableConfigIn.isShow?a("div",{staticClass:"table-config"},[a("div",{staticClass:"top-title"},[1==e.configStatus?a("span",{directives:[{name:"preventClick",rawName:"v-preventClick",value:2500,expression:"2500"}],staticClass:"hand-css",staticStyle:{display:"inline-block",width:"80%"},on:{click:e.multipleDialogShow}},[e._v("配置表格")]):e._e(),0==e.configStatus?a("span",{staticStyle:{display:"inline-block",width:"80%"}},[e._v("表格数据")]):e._e(),1==e.configStatus?a("span",{staticClass:"title-config iconfont hand-css",class:[e.freezeTableConfigIn.isShow?"el-icon-yanjing":"el-icon-yanjing1"],on:{click:function(t){return e.showStatus(e.freezeTableConfigIn)}}}):e._e()]),a("div",{ref:"varListTable",staticClass:"table-content tableDiv"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.freezeTableConfigIn.tableData,stripe:"",height:e.tableHeight}},[a("el-table-column",{attrs:{align:"center",label:"设备"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.devName))]}}],null,!1,3788988845)}),a("el-table-column",{attrs:{align:"center",label:"变量"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.varName))]}}],null,!1,2956254527)}),a("el-table-column",{attrs:{align:"center",label:"值"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.value)+e._s(t.row.varUnit))]}}],null,!1,1561476979)})],1)],1)]):e._e(),e._l(e.freezeConfigArrIn,function(t,i){return a("div",{key:"b"+i,class:e.getBorderClass(i)},[t.isShow&&0==e.configStatus||1==e.configStatus?a("div",{staticClass:"border-div"}):e._e()])}),e._l(e.freezeConfigArrIn,function(t,i){return a("div",{key:i,staticClass:"param-show",class:e.getParamClass(i)},[1==e.configStatus||0==e.configStatus&&t.isShow?a("div",[a("li",[a("el-input",{staticClass:"param-name hand-css",class:{preview:0==e.configStatus},model:{value:t.varName,callback:function(a){e.$set(t,"varName",a)},expression:"item.varName"}}),1==e.configStatus?a("span",[e._v("|")]):e._e(),1==e.configStatus?a("span",{directives:[{name:"preventClick",rawName:"v-preventClick",value:2500,expression:"2500"}],staticClass:"iconfont hand-css",class:[t.isShow?"el-icon-yanjing":"el-icon-yanjing1"],on:{click:function(a){return e.showStatus(t)}}}):e._e()],1),13!=i&&14!=i&&15!=i&&16!=i?a("li",{directives:[{name:"preventClick",rawName:"v-preventClick",value:2500,expression:"2500"}],on:{click:function(t){return e.freezeParamConfig(i)}}},[0!=e.configStatus||t.isOnOff?e._e():a("label",[e._v(e._s(t.value)+e._s(t.varUnit))]),0==e.configStatus&&t.isOnOff&&parseFloat(t.value)>=t.number?a("el-image",{staticClass:"show-image-freeze",attrs:{src:e.getImgSrc(t.bigImage)}}):e._e(),0==e.configStatus&&t.isOnOff&&parseFloat(t.value)<t.number?a("el-image",{staticClass:"show-image-freeze",attrs:{src:e.getImgSrc(t.smallImage)}}):e._e(),1==e.configStatus?a("label",{staticClass:"hand-css"},[e._v("配置变量")]):e._e()],1):e._e()]):e._e()])})],2)},[],!1,null,null,null);t.a=n.exports},"2d39":function(e,t,a){"use strict";a("df36")},"2ee3":function(e,t,a){},"313d":function(e,t,a){},3286:function(e,t,a){"use strict";a("43db")},"32b4":function(e,t,a){},"35c4":function(e,t,a){"use strict";a("f9cd")},3785:function(e,t,a){"use strict";a.d(t,"a",function(){return s});var i=a("e9c6"),r=a("caff");function s(e){return function(e){if(Array.isArray(e))return e}(e)||Object(i.a)(e)||Object(r.a)(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},"385b":function(e,t,a){"use strict";a("6802")},"3f7d":function(e,t,a){"use strict";a("6460")},"3fc8":function(e,t,a){},4052:function(e,t,a){"use strict";a("d39c")},"413a":function(e,t,a){"use strict";a.r(t);a("5b12"),a("9b5f"),a("1d43"),a("bf2f");var i=a("98d7"),r=a("0925"),s=a("9f0c"),n=a("20da"),o=a("c415"),l=a("4fcb"),c={data:function(){return{name:"",websocket:null,sendTimer:null,reconnectTimer:null,dataRequestNum:0,isManualClose:!1,stationGuidArr:[]}},components:{Exhibition:i.default,FreezeData:r.default,CustomReport:s.default,QueryReport:n.default,ProgramInfo:o.default,HistoryAlarm:l.default},computed:{webClose:function(){clearInterval(this.sendTimer),this.websocket&&this.websocket.close()}},mounted:function(){this.initWebSocket(),this.getRealData();var e={},t=window.location.href.split("?")[1];if(t)for(var a in t=t.split("&"))e[t[a].split("=")[0]]=t[a].split("=")[1],this.name=e.name},methods:{getRealData:function(e){var t=this;this.$axios({method:"get",headers:{},url:"web/realdata/getRealData"}).then(function(e){var a=e.data;if(0==a.code&&a.info){t.dataRequestNum=0;var i={},r=a.info.varList,s=a.info.devList;for(var n in r)for(var o in s)r[n].devGuid==s[o].devGuid&&(i[s[o].stationGuid]||(i[s[o].stationGuid]=[]),i[s[o].stationGuid].push(r[n]));var l={},c=a.info.stationList,u="";for(var d in c)u=u+c[d].stationGuid+",",t.stationGuidArr.push(c[d].stationGuid),i[c[d].stationGuid]||(i[c[d].stationGuid]=[]),l[c[d].stationGuid]=[];for(var m in s)l[s[m].stationGuid].push(s[m]);var h={vars:i,devs:l};t.$store.commit("set_g_realData",h),t.getCurrentAllAlarm(u)}}).catch(function(e){})},getCurrentAllAlarm:function(e){var t=this;this.$axios({method:"get",headers:{},url:"web/alarm/getAllAlarmRecord",params:{stationGuids:e.substring(0,e.length-1)}}).then(function(e){var a=e.data;if(0==a.code){var i=JSON.parse(JSON.stringify(t.$store.state.g_currentAlarmVar));if(a.info){var r=a.info;for(var s in r)i[r[s].stationGuid]||(i[r[s].stationGuid]=[]),r[s].recordState<3&&i[r[s].stationGuid].push(r[s]);t.$store.commit("set_g_currentAlarmVar",i)}}}).catch(function(e){})},getDataErrorAction:function(){this.dataRequestNum>3?this.dataRequestNum=0:(this.dataRequestNum++,this.getRealData())},initWebSocket:function(){this.websocket&&(this.websocket.close(),this.websocket=null);var e="ws://"+window.location.host+"//websocket";this.websocket=new WebSocket(e),this.websocket.onmessage=this.websocketonmessage,this.websocket.onopen=this.websocketonopen,this.websocket.onerror=this.websocketonerror,this.websocket.onclose=this.websocketclose},websocketonopen:function(){var e=this;clearInterval(this.reconnectTimer),clearInterval(this.sendTimer),this.reconnectTimer=null,this.sendTimer=null,this.sendTimer=setInterval(function(){e.websocket.send("hellow world")},3e4)},websocketonmessage:function(e){this.$store.state.g_realData||this.getRealData();var t=JSON.parse(e.data);switch(t.funCode){case 1:switch(t.messageId){case 1:case 2:case 3:break;case 7:var a=t.event;this.$store.commit("set_g_newAlarmInfo",a);var i=JSON.parse(JSON.stringify(this.$store.state.g_currentAlarmVar));switch(a.recordState){case 1:var r=JSON.parse(JSON.stringify(this.$store.state.g_newAlarmNum));r[a.stationGuid]||(r[a.stationGuid]=0),r[a.stationGuid]+=1,this.$store.commit("set_g_newAlarmNum",r),this.$store.state.g_newAlarmNum;var s=-1;i[a.stationGuid]||(i[a.stationGuid]=[]);for(var n=0;n<i[a.stationGuid].length;n++)if(i[a.stationGuid][n].varGuid==a.varGuid){s=n;break}s>-1?i[a.stationGuid][s]=a:i[a.stationGuid].push(a),this.$store.commit("set_g_currentAlarmVar",i);break;case 2:break;case 3:case 4:i[a.stationGuid]||(i[a.stationGuid]=[]);for(var o=0;o<i[a.stationGuid].length;o++)if(i[a.stationGuid][o].varGuid==a.varGuid){i[a.stationGuid].splice(o,1);break}this.$store.commit("set_g_currentAlarmVar",i)}}break;case 2:if(4==t.messageId){var l=t.event;if(-1==this.stationGuidArr.indexOf(l.stationGuid))return;this.$store.commit("set_g_newRealData",l);var c=JSON.parse(JSON.stringify(this.$store.state.g_realData));if(c&&c.vars[l.stationGuid]){for(var u=JSON.parse(JSON.stringify(c.vars[l.stationGuid])),d=0;d<u.length;d++)u[d].varGuid==l.varGuid&&(u[d].data.v=l.value,u[d].data.vTime=l.valueTime,u[d].data.commStateTime=l.commStateTime,u[d].data.commState=l.commState,u[d].data.alarmState=l.alarmState,u[d].data.alarmStateTime=l.alarmStateTime);c.vars[l.stationGuid]=u,this.$store.commit("set_g_realData",c)}}5==t.messageId&&this.getRealData(!0)}},websocketonerror:function(){this.reconnectTimer||this.websocketReconnectAction()},websocketsend:function(){},websocketclose:function(e){this.isManualClose||this.reconnectTimer||this.websocketReconnectAction()},websocketReconnectAction:function(){var e=this;this.websocket=null,clearInterval(this.sendTimer),this.reconnectTimer=setInterval(function(){e.initWebSocket()},1e4)},back:function(){this.$store.commit("set_role",-1),clearInterval(this.sendTimer),this.websocket&&this.websocket.close(),this.$axios({method:"get",headers:{},url:"/logout",data:{}}),window.sessionStorage.clear(),sessionStorage.clear(),setTimeout(function(){window.location.href="./index.html"},300)}},destroyed:function(){clearInterval(this.sendTimer),this.websocket.close()}},u=(a("12ba"),a("5d22")),d=Object(u.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"thirdparty"},["exhibitionG"==e.name?a("Exhibition"):e._e(),"freezeDataG"==e.name?a("FreezeData"):e._e(),"customReportG"==e.name?a("CustomReport"):e._e(),"queryReportG"==e.name?a("QueryReport"):e._e(),"progranInfoG"==e.name?a("ProgramInfo"):e._e(),"historyAlarmG"==e.name?a("HistoryAlarm"):e._e()],1)},[],!1,null,null,null);t.default=d.exports},4260:function(e,t,a){},"43db":function(e,t,a){},"445d":function(e,t,a){"use strict";a("6b54")},4609:function(e,t,a){"use strict";a("4260")},"49ca":function(e,t,a){"use strict";a("3bae"),a("5b12"),a("9b5f"),a("bf2f");var i=a("3de1"),r={name:"GraphHistoryCurve",components:{formatDateTime:i.c,showMessage:i.j},data:function(){return{station:{id:"",name:"",stationGuid:""},chartDialogVisible:!1,selectedVarArr:[],dialogChart:null,queryTimeRange:["",""],timeEditable:!1,pickerOptions:{disabledDate:function(e){return e.getTime()>(new Date).getTime()}},spaceType:3600,spaceTypeArr:[{value:3600,label:"整点"},{value:600,label:"全部"},{value:86400,label:"整天"}],xData:[],legendData:[],seriesData:[],timeSpanArr:[]}},created:function(){this.station=this.$store.state.freezenStation,this.queryTimeRange[0]=this.getLateDays(1),this.queryTimeRange[1]=this.getLateDays(0)},mounted:function(){var e=this;this.$comm.$on("showHistory",function(t){var a=e.$coreData.g.getVarQualifiedName(t.varGuid);if(e.selectedVarArr.some(function(e){return e.varGuid==t.varGuid}))Object(i.j)("warning","变量重复");else{var r={varGuid:t.varGuid,varName:a,devName:""};e.selectedVarArr.push(r),e.chartDialogVisible=!0,e.queryData()}})},destroyed:function(){this.dialogChart&&this.dialogChart.dispose()},methods:{chartDialogOpenedHandle:function(){},dialogClose:function(){this.selectedVarArr=[],this.xData=[],this.legendData=[],this.seriesData=[]},queryData:function(){if(0!=this.selectedVarArr.length){this.xData=[],this.legendData=[],this.seriesData=[];var e="";this.selectedVarArr.forEach(function(t){e=e+t.varGuid+","}),e=e.substring(0,e.length-1),this.getChartData(e)}else Object(i.j)("warning","请选择变量")},showChart:function(){var e=this;document.getElementById("dialogChart")&&!this.dialogChart&&(this.dialogChart=this.$echarts.init(document.getElementById("dialogChart")));var t={xAxis:{data:this.xData,axisLabel:{showMaxLabel:!0,showMinLabel:!0}},yAxis:{type:"value",scale:!0},dataZoom:[{type:"slider",xAxisIndex:0,filterMode:"empty"},{type:"slider",yAxisIndex:0,filterMode:"empty"}],tooltip:{show:!0,trigger:"axis"},legend:{left:"right",data:this.legendData},series:this.seriesData};this.dialogChart.setOption(t,!0),this.$erd.listenTo(document.getElementById("dialogChart"),function(t){e.dialogChart.resize()})},getChartData:function(e,t){var a=this,r={};if(t){this.isRefreshDialog=!1;var s=(new Date).getTime(),n=Object(i.c)(s);r={timeFrom:Object(i.c)(s-24*t*60*60*1e3),timeTo:n,varGuids:e,timeSpan:3600,stationGuid:this.station.stationGuid}}else{if(0==this.queryTimeRange[0].length)return void Object(i.j)("warning","请选择开始时间");if(0==this.queryTimeRange[1].length)return void Object(i.j)("warning","请选择结束时间");if(new Date(this.queryTimeRange[1]).getTime()>(new Date).getTime())return void Object(i.j)("warning","所选时间不能大于当前时间");r={timeFrom:this.queryTimeRange[0],timeTo:this.queryTimeRange[1],varGuids:e,timeSpan:this.spaceType,stationGuid:this.station.stationGuid}}this.$axios({method:"get",url:"/web/hisdata/queryHisDataByTimeSpan",params:r}).then(function(i){var r=i.data;0==r.code&&(t||(a.timeSpanArr=r.info.times,a.formatChartData(e,r.info.vars)))}).catch(function(e){})},formatChartData:function(e,t){var a=this,r=e.split(",");this.selectedVarArr.forEach(function(e){for(var t=0;t<r.length;t++)if(r[t]==e.varGuid){a.legendData.push({name:e.devName?e.devName:e.varName});var i={name:e.devName?e.devName:e.varName,data:[],type:"line",smooth:!0,connectNulls:!0};a.seriesData.push(i)}});var s=[];this.timeSpanArr.forEach(function(e){s.push(Object(i.c)(1e3*e));for(var t=0;t<a.seriesData.length;t++)a.seriesData[t].data.push(null)}),this.xData=s,t.forEach(function(e){for(var t,i=0;i<a.selectedVarArr.length;i++)e.guid==a.selectedVarArr[i].varGuid&&(t=i);var r=a.timeSpanArr.indexOf(e.breaktime);a.seriesData[t].data[r]=e.value}),this.showChart()},deleteVar:function(e){for(var t,a=0;a<this.selectedVarArr.length;a++)if(this.selectedVarArr[a].varGuid==e){t=a,this.selectedVarArr.splice(a,1);break}t>=0&&(this.legendData.splice(t,1),this.seriesData.splice(t,1),this.showChart())},getLateDays:function(e){var t=new Date,a=new Date(t.getTime()-864e5*e),i="";return i+=a.getFullYear()+"-",i+=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,i+="-",i+=a.getDate()<10?"0"+a.getDate():a.getDate(),i+=" ",i+=a.getHours()<10?"0"+a.getHours():a.getHours(),i+=":",i+=a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes(),i+=":",i+=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds()}}},s=(a("445d"),a("5d22")),n=Object(s.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"GraphHistoryCurve",attrs:{title:"历史曲线",visible:e.chartDialogVisible,width:"45%",top:"13%",modal:!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.chartDialogVisible=t},opened:e.chartDialogOpenedHandle,close:e.dialogClose}},[a("div",{staticStyle:{width:"100%",height:"480px"}},[a("div",{staticClass:"dialogVars",staticStyle:{height:"50px","overflow-y":"auto"}},e._l(e.selectedVarArr,function(t){return a("el-tag",{key:t.varGuid,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.deleteVar(t.varGuid)}}},[e._v(e._s(t.devName?t.devName+"/"+t.varName:t.varName))])}),1),a("div",{staticClass:"dialogVars"},[a("p",{staticStyle:{"margin-left":"0.05rem"}},[e._v("开始：")]),a("el-date-picker",{attrs:{type:"datetime","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center",editable:!1,clearable:!1},model:{value:e.queryTimeRange[0],callback:function(t){e.$set(e.queryTimeRange,0,t)},expression:"queryTimeRange[0]"}}),a("p",{staticStyle:{"margin-left":"0.1rem"}},[e._v("结束：")]),a("el-date-picker",{attrs:{type:"datetime","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center",editable:!1,clearable:!1},model:{value:e.queryTimeRange[1],callback:function(t){e.$set(e.queryTimeRange,1,t)},expression:"queryTimeRange[1]"}}),a("p",{staticStyle:{"margin-left":"0.2rem"}},[e._v("间隔：")]),a("el-select",{staticStyle:{width:"0.9rem"},attrs:{placeholder:"请选择"},model:{value:e.spaceType,callback:function(t){e.spaceType=t},expression:"spaceType"}},e._l(e.spaceTypeArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:e.queryData}},[e._v("查询")])],1),a("div",{staticStyle:{height:"360px",width:"100%"},attrs:{id:"dialogChart"}})])])},[],!1,null,null,null);t.a=n.exports},"4d97":function(e,t,a){"use strict";a.r(t);var i=a("58c8"),r=a("6abc"),s=(a("27ae"),a("1d43"),a("d447"),a("5b12"),a("9b5f"),a("bf2f"),a("3de1")),n={data:function(){return{checked1:!1,userGuid:"",userName:"",userInfo:{userName:"",realName:""},tableData:[],currentPage:1,pageSize:10,tableHeight:0,title:"",dialogVisible:!1,dialogWidth:"5.8rem",tableLoading:!1,addBtnLoading:!1,editBtnLoading:!1,addBtnsLoading:!1,organizeId:"",allOrganize:"",ruleForm:{userId:"",userName:"",projectId:"",type:1,item:{isSurvey:!1,isVideo:!1,isTemperature:!1,isFreeze:!1,isFreezeAnalog:!1,isGraphPage:!1}},ruleForm2:{userId:"",userName:"",projectId:"",type:1,item:{isSurvey:!1,isVideo:!1,isTemperature:!1,isFreeze:!1,isFreezeAnalog:!1,isGraphPage:!1}},ruleForm3:[{userPasswd:"",userConPasswd:"",userName:"",projectId:"",realName:"",phone:"",role:2}],rules:{projectId:[{message:"项目不能为空",trigger:"blur",required:!0}]},rules2:{projectId:[{message:"项目不能为空",trigger:"blur",required:!0}]},rootProjectItem:{id:0,pId:null,name:"根节点",type:1,selected:!0},treeData1:[],defaultProps1:{children:"children",label:"name"},defaultProps2:{children:"children",emitPath:!1,checkStrictly:!0,label:"name",value:"id",expandTrigger:"hover",disabled:"disabled"},cascaderValue:[],userGroups:[],ids:[],delUserIf:!1}},created:function(){this.getGroupList()},mounted:function(){this.getTableHeight()},methods:{getName:function(e){var t=JSON.parse(e),a=[];for(var i in t)switch(i){case"isSurvey":t[i]&&a.push("测斜配置");break;case"isVideo":t[i]&&a.push("视频配置");break;case"isTemperature":t[i]&&a.push("测温配置");break;case"isFreeze":t[i]&&a.push("站内设备");break;case"isGraphPage":t[i]&&a.push("组态画面");break;case"isFreezeAnalog":t[i]&&a.push("冻结模拟")}return a.toString()},getProjectName:function(e){for(var t in this.allOrganize)if(this.allOrganize[t].id,this.allOrganize[t].id==e)return this.allOrganize[t].name},queryUserInfo:function(){var e=this;""!=this.userName?this.$axios({method:"get",headers:{},url:"/web/user/queryUserByName",params:{userName:this.userName}}).then(function(t){var a=t.data;0==a.code?(e.userInfo={userName:a.info.name,realName:a.info.realName},e.userGuid=a.info.userGuid,e.userName=a.info.name,e.getUserProId()):e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)}):this.$showMessage("error","用户名不能为空")},getUserProId:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/UPPGController/queryProIdByUserId",params:{userGuid:this.userGuid}}).then(function(t){var a=t.data;0==a.code?e.tableData=a.info:e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)})},handleChange:function(){},handleSelectionChange:function(e){var t=[];for(var a in e)t.push(e[a].userGuid);this.delUserIf=e.length>0,this.ids=t},delUser:function(){var e=this;0!=this.ids.length?this.$axios({method:"get",headers:{},url:"/web/user/deleteUser",params:{userGuids:this.ids.toString()}}).then(function(t){var a=t.data;0==a.code?(e.getList(),e.$showMessage("success","用户删除成功")):e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)}):this.$showMessage("error","请选择用户")},tableRowClassName:function(e){var t=e.row;e.rowIndex;return 1===t.state?"warning-row":""},editBtn:function(e){this.dialogVisible=!0,this.dialogWidth="5.8rem",this.title="编辑授权",this.ruleForm2={userId:e.userId,userName:e.name,projectId:e.projectId,type:1,item:JSON.parse(e.item)}},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},getTableHeight:function(){this.$nextTick(function(){this.tableHeight=window.getComputedStyle(this.$refs.table).height.split("px")[0]-0})},getGroupList:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/group/queryAllRoleGroup"}).then(function(t){var a=t.data;0==a.code?(e.userGroups=a.info,e.getTreeList()):e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)})},getList:function(){var e=this;this.tableLoading=!0,this.$axios({method:"get",headers:{},url:"/web/UPPGController/queryDetailList",params:{projectId:this.organizeId}}).then(function(t){var a=t.data;0==a.code?(e.tableData=a.info,e.tableData):e.$showMessage("error",a.msg),e.tableLoading=!1}).catch(function(t){e.$showMessage("error",t),e.tableLoading=!1})},dialogClose:function(){},permissionSetting:function(e){},dialogOpen:function(){var e=this;this.$nextTick(function(){e.ruleForm={userId:e.userGuid,userName:e.userName,projectId:"",type:1,item:{isSurvey:!1,isVideo:!1,isTemperature:!1,isFreeze:!1,isFreezeAnalog:!1,isGraphPage:!1}},e.treeData1,e.ruleForm3=[{userPasswd:"",userConPasswd:"",userName:"",department:"",realName:"",phone:"",role:2}],"新增账户"==e.title?e.$refs.ruleForm.clearValidate():"编辑账户"==e.title&&e.$refs.ruleForm2.clearValidate()})},addBtn:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return!1;e.addBtnLoading=!0,e.$axios({method:"post",headers:{},url:"/web/UPPGController/authorizeProjectToUser",data:e.ruleForm}).then(function(t){0==t.data.code?(e.$showMessage("success","授权成功"),e.getUserProId(),e.dialogVisible=!1):e.$showMessage("error",t.data.msg),e.addBtnLoading=!1}).catch(function(t){e.$showMessage("error",t),e.addBtnLoading=!1})})},editClick:function(){var e=this;this.editBtnLoading=!0,this.$axios({method:"post",headers:{},url:"/web/UPPGController/updateAuthorization",data:this.ruleForm2}).then(function(t){0==t.data.code?(e.$showMessage("success","授权修改成功"),e.getUserProId(),e.dialogVisible=!1):e.$showMessage("error",t.data.msg),e.editBtnLoading=!1}).catch(function(t){e.editBtnLoading=!1,e.$showMessage("error",t)})},addBtns:function(){var e=this;this.addBtnsLoading=!0;var t=[],a=[];for(var i in this.ruleForm3){if(""==this.ruleForm3[i].department?this.ruleForm3[i].department=t:t=this.ruleForm3[i].department,""==this.ruleForm3[i].phone||""==this.ruleForm3[i].realName||""==this.ruleForm3[i].userName||""==this.ruleForm3[i].department)return this.$showMessage("error","请填写完整信息"),void(this.addBtnsLoading=!1);a.push(Object(r.a)(Object(r.a)({organizeId:this.ruleForm3[i].department.toString()-0},this.ruleForm3[i]),{},{userPasswd:this.$md5("12345678").toUpperCase(),userConPasswd:this.$md5("12345678").toUpperCase()}))}this.$axios({method:"post",headers:{},url:"/web/user/addUser",data:a}).then(function(t){0==t.data.code?(e.$showMessage("success","用户添加成功"),e.getList(),e.dialogVisible=!1):e.$showMessage("error",t.data.msg),e.addBtnsLoading=!1}).catch(function(t){e.$showMessage("error",t),e.addBtnsLoading=!1})},nodeClick1:function(e){1!=e.type&&(this.organizeId=e.id,this.getList())},onConfirm:function(e,t){var a=this,i=e.$index+(this.currentPage-1)*this.pageSize;switch(t){case 1:this.$axios({method:"get",headers:{},url:"/web/user/lockUser",params:{userGuid:e.row.userGuid}}).then(function(e){0==e.data.code?a.tableData[i].state=1:a.$showMessage("error",e.data.msg)}).catch(function(e){a.$showMessage("error",e)});break;case 2:this.$axios({method:"get",headers:{},url:"/web/user/unLockUser",params:{userGuid:e.row.userGuid}}).then(function(e){0==e.data.code?a.tableData[i].state=0:a.$showMessage("error",e.data.msg)}).catch(function(e){a.$showMessage("error",e)});break;case 3:this.$axios({method:"get",headers:{},url:"/web/user/resetUserPasswd",params:{userGuid:e.row.userGuid}}).then(function(e){0==e.data.code?a.$showMessage("success","密码重置成功"):a.$showMessage("error",e.data.msg)}).catch(function(e){a.$showMessage("error",e)});break;case 4:this.$axios({method:"post",headers:{},url:"/web/UPPGController/cancelauthorization",data:{projectId:e.row.projectId,userId:e.row.userId}}).then(function(e){0==e.data.code?(a.$showMessage("success","用户授权已取消"),a.getUserProId()):a.$showMessage("error",e.data.msg)}).catch(function(e){a.$showMessage("error",e)})}},onCancel:function(e,t){},addUserList:function(){this.ruleForm3.push({userPasswd:"",userConPasswd:"",userName:"",department:"",realName:"",phone:"",role:2})},delUserList:function(e){this.ruleForm3.splice(e,1)},getTreeList:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/project/queryGroupsProjects"}).then(function(t){var a=t.data;if(0==a.code){for(var r,n=0;n<a.info.length;n++)1==a.info[n].type?(a.info[n].biaoqian="el-tree-city",a.info[n].disabled="disabled"):a.info[n].biaoqian="el-tree-project";e.$store.state.userInfo.rights[0];r=Object(i.a)(a.info),e.allOrganize=Object(i.a)(r),e.treeData1=Object(s.a)(r),e.organizeId=e.treeData1[0].id,e.$nextTick(function(){e.$refs.tree1.setCurrentKey(0)}),e.getList()}else e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)})},getUserGroup:function(e){},getOrganize:function(e){var t="";for(var a in this.allOrganize)if(this.allOrganize[a].id==e){t=this.allOrganize[a].name;break}return t}}},o=(a("35c4"),a("5d22")),l=Object(o.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"authorization"},[a("div",{staticClass:"content"},[a("div",{staticClass:"left"},[a("div",[a("el-tree",{ref:"tree1",staticClass:"filter-tree1 tree",attrs:{data:e.treeData1,props:e.defaultProps1,"node-key":"id","default-expanded-keys":[1],"expand-on-click-node":!1,"highlight-current":""},on:{"node-click":e.nodeClick1},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{class:r.biaoqian}),e._v(" "+e._s(i.label)+" ")])])}}])})],1)]),a("div",{staticClass:"right"},[a("div",{staticClass:"table"},[a("div",{staticClass:"tableTop"},[a("div",[e._v("项目已授权人员")]),a("div",[a("el-input",{attrs:{size:"mini",placeholder:"请输入内容"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}})],1),a("el-button",{staticClass:"gtr4 addBtn",attrs:{type:"primary"},on:{click:function(t){return e.queryUserInfo()}}},[e._v("查询用户")]),e.userInfo.userName?a("div",[e._v(" 用户名："+e._s(e.userInfo.userName)+" 真实姓名："+e._s(e.userInfo.realName)+" "),a("el-button",{staticClass:"addBtn",attrs:{type:"primary"},on:{click:function(t){e.title="新增授权",e.dialogWidth="6.8rem",e.dialogVisible=!0}}},[e._v("授 权")])],1):e._e()],1),a("div",{ref:"table",staticClass:"tableDiv"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{"row-class-name":e.tableRowClassName,data:e.tableData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),stripe:"",height:e.tableHeight,"row-style":{height:"45px"},"cell-style":{padding:"0px"},"row-key":"user"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{label:"序号",width:"50",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.$index+(e.currentPage-1)*e.pageSize+1))]}}])}),a("el-table-column",{attrs:{label:"用户名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),a("el-table-column",{attrs:{label:"真实姓名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.realName))]}}])}),a("el-table-column",{attrs:{label:"授权项目",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.getProjectName(t.row.projectId)))]}}])}),a("el-table-column",{attrs:{label:"授权模块",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.getName(t.row.item)))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{margin:"0 0 0 10px"},attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(a){return e.editBtn(t.row)}}},[e._v("编辑授权")]),[a("el-popconfirm",{attrs:{title:"确定删除该用户吗？",iconColor:"#F56C6C",icon:"el-icon-info"},on:{confirm:function(a){return e.onConfirm(t,4)},cancel:function(a){return e.onCancel(t,4)},onConfirm:function(a){return e.onConfirm(t,4)},onCancel:function(a){return e.onCancel(t,4)}}},[a("el-button",{staticStyle:{margin:"0 0 0 10px"},attrs:{slot:"reference",size:"mini",type:"danger",icon:"el-icon-delete-solid"},slot:"reference"},[e._v("取消授权")])],1)]]}}])})],1)],1),a("div",{staticClass:"tableBottom"},[a("el-pagination",{staticClass:"page",attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.tableData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])])]),a("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:e.dialogWidth},on:{"update:visible":function(t){e.dialogVisible=t},close:e.dialogClose,open:e.dialogOpen}},["新增授权"==e.title?[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"3.8rem","font-size":"1.18rem"},attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"1.2rem","label-position":"right"}},[a("el-form-item",{attrs:{label:"用户名：",prop:"userName"}},[a("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.userName,callback:function(t){e.$set(e.ruleForm,"userName",t)},expression:"ruleForm.userName"}})],1),a("el-form-item",{attrs:{label:"所在部门：",prop:"department"}},[a("el-cascader",{attrs:{options:e.treeData1,props:e.defaultProps2,"show-all-levels":!1,placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.ruleForm.projectId,callback:function(t){e.$set(e.ruleForm,"projectId",t)},expression:"ruleForm.projectId"}})],1),a("el-form-item",{attrs:{label:"配置模块：",prop:"realName"}},[a("el-checkbox",{staticStyle:{float:"left"},model:{value:e.ruleForm.item.isSurvey,callback:function(t){e.$set(e.ruleForm.item,"isSurvey",t)},expression:"ruleForm.item.isSurvey"}},[e._v("测斜配置")]),a("el-checkbox",{staticStyle:{float:"left"},model:{value:e.ruleForm.item.isVideo,callback:function(t){e.$set(e.ruleForm.item,"isVideo",t)},expression:"ruleForm.item.isVideo"}},[e._v("视频配置")]),a("el-checkbox",{staticStyle:{float:"left"},model:{value:e.ruleForm.item.isTemperature,callback:function(t){e.$set(e.ruleForm.item,"isTemperature",t)},expression:"ruleForm.item.isTemperature"}},[e._v("测温配置")]),a("el-checkbox",{staticStyle:{float:"left"},model:{value:e.ruleForm.item.isFreeze,callback:function(t){e.$set(e.ruleForm.item,"isFreeze",t)},expression:"ruleForm.item.isFreeze"}},[e._v("站内设备")]),a("el-checkbox",{staticStyle:{float:"left"},model:{value:e.ruleForm.item.isGraphPage,callback:function(t){e.$set(e.ruleForm.item,"isGraphPage",t)},expression:"ruleForm.item.isGraphPage"}},[e._v("组态画面")])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"diglogBtn",on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{staticClass:"diglogBtn",attrs:{type:"primary",loading:e.addBtnLoading},on:{click:e.addBtn}},[e._v("确定新增")])],1)]:e._e(),"编辑授权"==e.title?[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"3.8rem","font-size":"1.18rem"},attrs:{model:e.ruleForm2,"status-icon":"","label-width":"1.2rem","label-position":"right"}},[a("el-form-item",{attrs:{label:"用户名：",prop:"userName"}},[a("el-input",{attrs:{disabled:""},model:{value:e.ruleForm2.userName,callback:function(t){e.$set(e.ruleForm2,"userName",t)},expression:"ruleForm2.userName"}})],1),a("el-form-item",{attrs:{label:"所在部门：",prop:"department"}},[a("el-cascader",{attrs:{disabled:"",options:e.treeData1,props:e.defaultProps2,"show-all-levels":!1,placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.ruleForm2.projectId,callback:function(t){e.$set(e.ruleForm2,"projectId",t)},expression:"ruleForm2.projectId"}})],1),a("el-form-item",{attrs:{label:"配置模块：",prop:"realName"}},[a("el-checkbox",{staticStyle:{float:"left"},model:{value:e.ruleForm2.item.isSurvey,callback:function(t){e.$set(e.ruleForm2.item,"isSurvey",t)},expression:"ruleForm2.item.isSurvey"}},[e._v("测斜配置")]),a("el-checkbox",{staticStyle:{float:"left"},model:{value:e.ruleForm2.item.isVideo,callback:function(t){e.$set(e.ruleForm2.item,"isVideo",t)},expression:"ruleForm2.item.isVideo"}},[e._v("视频配置")]),a("el-checkbox",{staticStyle:{float:"left"},model:{value:e.ruleForm2.item.isTemperature,callback:function(t){e.$set(e.ruleForm2.item,"isTemperature",t)},expression:"ruleForm2.item.isTemperature"}},[e._v("测温配置")]),a("el-checkbox",{staticStyle:{float:"left"},model:{value:e.ruleForm2.item.isFreeze,callback:function(t){e.$set(e.ruleForm2.item,"isFreeze",t)},expression:"ruleForm2.item.isFreeze"}},[e._v("站内设备")]),a("el-checkbox",{staticStyle:{float:"left"},model:{value:e.ruleForm2.item.isGraphPage,callback:function(t){e.$set(e.ruleForm2.item,"isGraphPage",t)},expression:"ruleForm2.item.isGraphPage"}},[e._v("组态画面")])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"diglogBtn",on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{staticClass:"diglogBtn",attrs:{type:"primary",loading:e.editBtnLoading},on:{click:e.editClick}},[e._v("确定修改")])],1)]:"新增授权1"==e.title?[a("div",{staticClass:"ruleForm3"},e._l(e.ruleForm3,function(t,i){return a("div",{key:i,staticClass:"ruleForm3Li"},[0==i?[a("div",[e._v(" 授权项目： "),a("el-cascader",{staticStyle:{width:"1.65rem",height:"0.3rem"},attrs:{options:e.treeData1,props:e.defaultProps2,"show-all-levels":!1,placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.ruleForm3[i].projectId,callback:function(t){e.$set(e.ruleForm3[i],"projectId",t)},expression:"ruleForm3[index].projectId"}})],1),a("div",[a("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("备选项")]),a("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("备选项")]),a("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("备选项")]),a("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("备选项")]),a("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("备选项")])],1),a("div",[e._v(" 真实姓名： "),a("el-input",{staticStyle:{width:"1.65rem",height:"0.3rem"},model:{value:e.ruleForm3[i].realName,callback:function(t){e.$set(e.ruleForm3[i],"realName",t)},expression:"ruleForm3[index].realName"}})],1),a("div",[e._v(" 联系方式： "),a("el-input",{staticStyle:{width:"1.65rem",height:"0.3rem"},model:{value:e.ruleForm3[i].phone,callback:function(t){e.$set(e.ruleForm3[i],"phone",t)},expression:"ruleForm3[index].phone"}})],1),a("div",[a("i",{staticClass:"el-icon-close",on:{click:function(t){return e.delUserList(i)}}})])]:[a("div",[e._v(" 授权项目： "),a("el-cascader",{staticStyle:{width:"1.65rem",height:"0.3rem"},attrs:{options:e.treeData1,props:e.defaultProps2,"show-all-levels":!1,placeholder:"同上"},on:{change:e.handleChange},model:{value:e.ruleForm3[i].department,callback:function(t){e.$set(e.ruleForm3[i],"department",t)},expression:"ruleForm3[index].department"}})],1),a("div",[e._v(" 用户名： "),a("el-input",{staticStyle:{width:"1.65rem",height:"0.3rem"},model:{value:e.ruleForm3[i].userName,callback:function(t){e.$set(e.ruleForm3[i],"userName",t)},expression:"ruleForm3[index].userName"}})],1),a("div",[e._v(" 真实姓名： "),a("el-input",{staticStyle:{width:"1.65rem",height:"0.3rem"},model:{value:e.ruleForm3[i].realName,callback:function(t){e.$set(e.ruleForm3[i],"realName",t)},expression:"ruleForm3[index].realName"}})],1),a("div",[e._v(" 联系方式： "),a("el-input",{staticStyle:{width:"1.65rem",height:"0.3rem"},model:{value:e.ruleForm3[i].phone,callback:function(t){e.$set(e.ruleForm3[i],"phone",t)},expression:"ruleForm3[index].phone"}})],1),a("div",[a("i",{staticClass:"el-icon-close",on:{click:function(t){return e.delUserList(i)}}})])]],2)}),0),a("div",{staticClass:"addUserList",on:{click:e.addUserList}},[a("i",{staticClass:"el-icon-plus",staticStyle:{"margin-right":"10px"}}),e._v("新增 ")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"diglogBtn",on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{staticClass:"diglogBtn",attrs:{type:"primary",loading:e.addBtnsLoading},on:{click:e.addBtns}},[e._v("确定修改")])],1)]:e._e()],2)],1)},[],!1,null,null,null);t.default=l.exports},"4e54":function(e,t,a){"use strict";a("3fc8")},"4f77":function(e,t,a){},"4fcb":function(e,t,a){"use strict";a.r(t);a("5b12"),a("9b5f"),a("1d43"),a("3bae"),a("4200"),a("e3b5"),a("b3b0"),a("a5f8");var i=a("3de1"),r={components:{},data:function(){return{tableHeight:"100%",isRed:!0,newMsgNum:2,timer:null,searchValue:"",startTime:"",endTime:"",confirmStartTime:"",confirmEndTime:"",alarmType:"",alarmStatus:"",chart:void 0,guidForData:"",tableData:[],tableDataForFliter:[],pageSize:10,currentPage:1,stationNamesJson:{},dialogText:"",fullscreenLoading:!1,currItem:{stationGuid:""},filterText:"",isOrgFirst:!0,orgdata:[],defaultProps:{children:"children",label:"name"},isShowConfig:{isSurvey:!1,isVideo:!1,isTemperature:!1,isFreeze:!1,isFreezeAnalog:!1,isGraphPage:!1},alarmStatusArr:[{value:1,label:"正常"},{value:3,label:"报警"},{value:4,label:"已确认"}],currClickNavIndex:1,currentStationName:"",timeIsChange:!1,expandedKeys:[]}},mounted:function(){this.queryGroupsProjects(),this.getTableHeight()},created:function(){},beforeDestroy:function(){clearInterval(this.timer)},methods:{getTableHeight:function(){this.$nextTick(function(){this.tableHeight=window.getComputedStyle(this.$refs.deviceTable).height.split("px")[0]-55,this.tableHeight})},formatDate:function(e){if(!e)return"";var t=new Date(e),a=t.getFullYear(),i=t.getMonth()+1;i=i<10?"0"+i:i;var r=t.getDate();r=r<10?"0"+r:r;var s=t.getHours();s=s<10?"0"+s:s;var n=t.getMinutes();n=n<10?"0"+n:n;var o=t.getSeconds();return o=o<10?"0"+o:o,a+"-"+i+"-"+r+" "},formatDateTime:function(e){if(!e)return"";var t=new Date(e),a=t.getFullYear(),i=t.getMonth()+1;i=i<10?"0"+i:i;var r=t.getDate();r=r<10?"0"+r:r;var s=t.getHours();s=s<10?"0"+s:s;var n=t.getMinutes();n=n<10?"0"+n:n;var o=t.getSeconds();return a+"-"+i+"-"+r+" "+s+":"+n+":"+(o=o<10?"0"+o:o)},getDefaultSearchTime:function(){var e=new Date;this.endTime=e;var t=new Date(new Date-864e5);this.startTime=t},indexMethod:function(e){return this.pageSize*(this.currentPage-1)+e+1},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},setTreeStationName:function(e){if(e)if(Array.isArray(e))for(var t=0;t<e.length;t++){var a=e[t].stationGuid;if(a&&(e[t].stationName=this.stationNamesJson[a]),e[t].children&&e[t].children.length>0)for(var i=0;i<e[t].children.length;i++)this.setTreeStationName(e[t].children[i])}else if(e.stationGuid&&(e.stationName=this.stationNamesJson[e.stationGuid]),e.children&&e.children.length>0)for(t=0;t<e.children.length;t++)this.setTreeStationName(e.children[t])},getStationNames:function(e,t){var a=this;if(e){this.stationNamesJson={};var r={param:e};this.$axios({method:"get",headers:{},url:"/web/station/queryStationsByGuids",params:r}).then(function(e){var r=e.data;if(0==r.code){for(var s=0;s<r.info.length;s++){var n=r.info[s].guid,o=r.info[s].name;a.stationNamesJson[n]=o}for(var l=0;l<t.length;l++){var c=t[l].stationGuid;c&&(t[l].stationName=a.stationNamesJson[c])}a.orgdata=Object(i.a)(t),a.orgdata}else a.orgdata=Object(i.a)(t)}).catch(function(e){a.orgdata=Object(i.a)(t),console.error("queryStationsByGuids error",e)})}},queryGroupsProjects:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/project/queryGroupsProjects",data:{}}).then(function(t){var a=t.data;if(0==a.code){for(var r="",s=[],n=!1,o=0;o<a.info.length;o++)a.info[o].stationGuid?(r.length>0&&(r+=","),r+=a.info[o].stationGuid,a.info[o].isToolTip=!0):a.info[o].isToolTip=!1,1==a.info[o].type?(a.info[o].biaoqian="el-tree-city",61==a.info[o].id&&(n=!0)):(a.info[o].biaoqian="el-tree-project",a.info[o].id="project-"+a.info[o].id),0==a.info[o].pId&&(e.currentStationName=a.info[o].name),(2!=a.info[o].type||a.info[o].stationGuid)&&1!=a.info[o].id&&s.push(a.info[o]),1==a.info[o].pId&&e.expandedKeys.push(a.info[o].id);if(s.length>0){var l=Object(i.a)(s);n&&(l=Object(i.k)(l)),e.orgdata=Object(i.a)(l)}r?(e.getDefaultSearchTime(),e.getDataList(r)):e.orgdata=Object(i.a)(a.info)}else e.orgdata=[];e.$nextTick(function(){e.isOrgFirst?(e.$refs.orgTree.setCurrentKey(1),e.orgdata.length>0&&(e.currItem=e.orgdata[0]),e.isOrgFirst=!1):e.$refs.orgTree.setCurrentKey(e.currItem.id)})}).catch(function(t){e.$showMessage("error",t),e.orgdata=[]})},deleteNoneProjectOrg:function(e){var t=[];e.forEach(function(e){t.push(e.pId)});for(var a=[],r=0;r<e.length;r++)2!=e[r].type&&-1==t.indexOf(e[r].id)||a.push(e[r]);if(a.length==e.length){this.orgdata=Object(i.a)(a);for(var s=0;s<this.orgdata.length;s++)this.expandedKeys.push(this.orgdata[s].id)}else this.deleteNoneProjectOrg(a)},handleNodeClick:function(e){this.currItem=e;var t=[];if(2==this.currItem.type)e.stationGuid&&t.push(e.stationGuid);else if(e.children)for(var a=0;a<e.children.length;a++)if(e.children[a].children)for(var i=0;i<e.children[a].children.length;i++)e.children[a].children[i].stationGuid&&t.push(e.children[a].children[i].stationGuid);else e.children[a].stationGuid&&t.push(e.children[a].stationGuid);t.length>0?(this.currentStationName=e.name,this.getDefaultSearchTime(),this.getDataList(t.join(","))):this.$showMessage("warning","未绑定站点")},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},loadNewData:function(){},getDataList:function(e){var t=this;this.timeIsChange=!1,this.guidForData=e,this.tableData=[],this.$axios({method:"get",headers:{},url:"/web/alarm/queryAllHisAlarmRecord",params:{startTime:this.formatDateTime(this.startTime),endTime:this.formatDateTime(this.endTime),stationGuids:e}}).then(function(e){var a=e.data;0==a.code?(t.tableData=a.info,t.tableDataForFliter=t.tableData,t.filterTableData()):t.$showMessage("error",a.msg)}).catch(function(e){t.$showMessage("error",e)})},filterTableData:function(){var e=this;this.tableData=this.tableDataForFliter.filter(function(t){return(!e.alarmType||t.alarmType==e.alarmType)&&(!e.alarmStatus||t.alarmState==e.alarmStatus)&&(!e.confirmStartTime||1e3*t.confirmTime>e.confirmStartTime)&&(!e.confirmEndTime||1e3*t.confirmTime<e.confirmEndTime)&&(!e.searchValue||t.content.toLowerCase().includes(e.searchValue.toLowerCase())||t.devName.toLowerCase().includes(e.searchValue.toLowerCase())||t.varName.toLowerCase().includes(e.searchValue.toLowerCase()))})},queryData:function(){this.timeIsChange?this.getDataList(this.guidForData):this.filterTableData()},getAlarmTypeStr:function(e){return 0==e?"报警":1==e?"报警恢复":void 0},getAlarmStatusStr:function(e){return 1==e.alarmState?"正常":3==e.alarmState?"报警":4==e.alarmState?"已确认":void 0}},watch:{filterText:function(e){this.$refs.orgTree.filter(e)},startTime:function(e){this.timeIsChange=!0},endTime:function(e){this.timeIsChange=!0}}},s=(a("04e4"),a("5d22")),n=Object(s.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"hisAlarm"},[a("div",{staticClass:"config-info-div"},[a("div",{staticClass:"left-div"},[a("div",{staticClass:"bottom-content tree-container"},[a("el-tree",{ref:"orgTree",staticClass:"tree",attrs:{data:e.orgdata,props:e.defaultProps,"node-key":"id","default-expanded-keys":e.expandedKeys,"highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{class:r.biaoqian}),a("span",[e._v(" "+e._s(i.label)+" ")])])])}}])})],1)]),a("div",{staticClass:"right-div"},[a("div",{staticClass:"top-div"},[a("div",{staticClass:"right",staticStyle:{width:"100%"}},[a("div",[e._v(" "+e._s(e.currentStationName)+" ")]),a("div",{staticStyle:{display:"flex"}},[a("div",[a("label",{attrs:{for:""}},[e._v("报警时间：")]),a("div",{staticStyle:{display:"inline-block"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择时间","value-format":"timestamp"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}})],1),a("label",{staticStyle:{width:"30px","text-align":"center",display:"inline-block"},attrs:{for:""}},[e._v("-")]),a("div",{staticStyle:{display:"inline-block"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择时间","value-format":"timestamp"},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}})],1)]),a("div",{staticStyle:{"margin-left":"100px"}},[a("label",{attrs:{for:""}},[e._v("确认时间：")]),a("div",{staticStyle:{display:"inline-block"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择时间","value-format":"timestamp"},model:{value:e.confirmStartTime,callback:function(t){e.confirmStartTime=t},expression:"confirmStartTime"}})],1),a("label",{staticStyle:{width:"30px","text-align":"center",display:"inline-block"},attrs:{for:""}},[e._v("-")]),a("div",{staticStyle:{display:"inline-block"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择时间","value-format":"timestamp"},model:{value:e.confirmEndTime,callback:function(t){e.confirmEndTime=t},expression:"confirmEndTime"}})],1)])]),a("div",[a("span",[e._v("报警类型：")]),a("el-select",{staticStyle:{width:"1.5rem"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.alarmType,callback:function(t){e.alarmType=t},expression:"alarmType"}},[a("el-option",{attrs:{label:"报警",value:"0"}}),a("el-option",{attrs:{label:"报警恢复",value:"1"}})],1),a("span",{staticStyle:{"margin-left":"0.3rem"}},[e._v("报警状态：")]),a("el-select",{staticStyle:{width:"1.5rem"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.alarmStatus,callback:function(t){e.alarmStatus=t},expression:"alarmStatus"}},e._l(e.alarmStatusArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),a("span",{staticStyle:{"margin-left":"0.25rem"}},[e._v("模糊查询：")]),a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"确认人/变量名/设备名/报警内容"},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),a("el-button",{staticClass:"btnFontSize",staticStyle:{"margin-left":"15px"},attrs:{type:"primary"},on:{click:e.queryData}},[e._v("查询")])],1)])]),a("div",{ref:"deviceTable",staticClass:"bottom-table-div",staticStyle:{height:"72%","max-height":"72%","background-color":"#fff"}},[a("el-table",{staticStyle:{width:"100%",cursor:"pointer"},attrs:{data:e.tableData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),"default-sort":{prop:"time",order:"descending"},height:e.tableHeight,"highlight-current-row":""}},[a("el-table-column",{attrs:{label:"序号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.$index+(e.currentPage-1)*e.pageSize+1))]}}])}),a("el-table-column",{attrs:{label:"变量名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.varName))]}}])}),a("el-table-column",{attrs:{label:"设备名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.devName))]}}])}),a("el-table-column",{attrs:{label:"站点名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.stationName))]}}])}),a("el-table-column",{attrs:{label:"报警时间",align:"center",prop:"time",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatDateTime(1e3*t.row.time)))]}}])}),a("el-table-column",{attrs:{label:"报警类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.getAlarmTypeStr(t.row.alarmType)))]}}])}),a("el-table-column",{attrs:{label:"报警值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.value))]}}])}),a("el-table-column",{attrs:{label:"阈值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.threshold))]}}])}),a("el-table-column",{attrs:{label:"报警内容",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.content))]}}])}),a("el-table-column",{attrs:{label:"报警状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:1==t.row.alarmState?"green":""},[e._v(e._s(e.getAlarmStatusStr(t.row)))])]}}])}),a("el-table-column",{attrs:{label:"报警确认",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[4==t.row.alarmState?a("div",[a("span",[e._v(e._s(t.row.confirmUser)+" "+e._s(e.formatDateTime(1e3*t.row.confirmTime)))])]):e._e()]}}])})],1),a("div",{staticClass:"tableBottom"},[a("el-pagination",{staticStyle:{float:"right","margin-top":"0.1rem"},attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.tableData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])])])},[],!1,null,null,null);t.default=n.exports},"56cd":function(e,t,a){"use strict";a("6d8b")},"58c8":function(e,t,a){"use strict";a.d(t,"a",function(){return n});var i=a("d08d");var r=a("e9c6"),s=a("caff");function n(e){return function(e){if(Array.isArray(e))return Object(i.a)(e)}(e)||Object(r.a)(e)||Object(s.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},"59f9":function(e,t,a){"use strict";a("5c6b")},"5b5a":function(e,t,a){"use strict";a("4f77")},"5c6b":function(e,t,a){},"5e4a":function(e,t,a){},"5f79":function(e,t,a){"use strict";a("0bec")},"63c4":function(e,t,a){},6460:function(e,t,a){},6802:function(e,t,a){},"6b54":function(e,t,a){},"6c78":function(e,t,a){},"6cd0":function(e,t,a){"use strict";var i,r=a("1f04"),s=a("38e3").f,n=a("a187"),o=a("c6c0"),l=a("4023"),c=a("6b33"),u=a("941f"),d="".startsWith,m=Math.min,h=c("startsWith");r({target:"String",proto:!0,forced:!!(u||h||(i=s(String.prototype,"startsWith"),!i||i.writable))&&!h},{startsWith:function(e){var t=String(l(this));o(e);var a=n(m(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return d?d.call(t,i,a):t.slice(a,a+i.length)===i}})},"6d8b":function(e,t,a){},"73d4":function(e,t,a){},"77a4":function(e,t,a){var i=a("1f04"),r=a("0bab").values;i({target:"Object",stat:!0},{values:function(e){return r(e)}})},"77b8":function(e,t,a){"use strict";a("d5a1")},"7b02":function(e,t,a){"use strict";a("63c4")},"7f6c":function(e,t,a){"use strict";a.r(t);var i=a("58c8"),r=(a("5b12"),a("9b5f"),a("1d43"),a("3bae"),a("4200"),a("27ae"),a("d447"),a("e3b5"),a("b3b0"),a("a5f8"),a("bf2f"),a("3de1")),s={components:{},data:function(){return{tableHeight:null,isRed:!0,newMsgNum:2,timer:null,searchValue:"",startTime:"",endTime:"",alarmStatus:"",alarmStatusArr:[{value:1,label:"报警中"},{value:2,label:"报警已确认"},{value:3,label:"报警已恢复未确认"},{value:4,label:"报警已正常"}],chart:void 0,tableData:[],tableDataForFliter:[],pageSize:10,currentPage:1,stationNamesJson:{},dialogText:"",fullscreenLoading:!1,currItem:{stationGuid:""},filterText:"",isOrgFirst:!0,orgdata:[],defaultProps:{children:"children",label:"name"},isShowConfig:{isSurvey:!1,isVideo:!1,isTemperature:!1,isFreeze:!1,isFreezeAnalog:!1,isGraphPage:!1},currClickNavIndex:1,currentStationName:"",currentStationGuid:"",allSelectStationNewAlarmNum:0,dataAxis1:[],echartData:[],guidForData:"",g_newAlarmNum:{},g_newAlarmInfo:{},tempResultInfo:[],tempNewTreeInfo:[],expandedKeys:[]}},mounted:function(){this.queryGroupsProjects(),this.getTableHeight()},created:function(){},beforeDestroy:function(){clearInterval(this.timer)},methods:{getTableHeight:function(){this.$nextTick(function(){this.tableHeight=window.getComputedStyle(this.$refs.deviceTable).height.split("px")[0]-55,this.tableHeight})},formatDate:function(e){if(!e)return"";var t=new Date(e),a=t.getFullYear(),i=t.getMonth()+1;i=i<10?"0"+i:i;var r=t.getDate();r=r<10?"0"+r:r;var s=t.getHours();s=s<10?"0"+s:s;var n=t.getMinutes();n=n<10?"0"+n:n;var o=t.getSeconds();return o=o<10?"0"+o:o,a+"-"+i+"-"+r+" "},formatDateTime:function(e){if(!e)return"";var t=new Date(e),a=t.getFullYear(),i=t.getMonth()+1;i=i<10?"0"+i:i;var r=t.getDate();r=r<10?"0"+r:r;var s=t.getHours();s=s<10?"0"+s:s;var n=t.getMinutes();n=n<10?"0"+n:n;var o=t.getSeconds();return a+"-"+i+"-"+r+" "+s+":"+n+":"+(o=o<10?"0"+o:o)},indexMethod:function(e){return this.pageSize*(this.currentPage-1)+e+1},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},queryGroupsProjects:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/project/queryGroupsProjects",data:{}}).then(function(t){var a=t.data;if(0==a.code){for(var i="",s=[],n=[],o=0;o<a.info.length;o++)a.info[o].stationGuid?(i.length>0&&(i+=","),i+=a.info[o].stationGuid,s.push(a.info[o].stationGuid),a.info[o].isToolTip=!0):a.info[o].isToolTip=!1,1==a.info[o].type?a.info[o].biaoqian="el-tree-city":(a.info[o].biaoqian="el-tree-project",a.info[o].id="project-"+a.info[o].id),0==a.info[o].pId&&(e.currentStationName=a.info[o].name),2==a.info[o].type&&a.info[o].stationGuid&&(a.info[o].newAlarmNum=e.g_newAlarmNum[a.info[o].stationGuid]||0),(2!=a.info[o].type||a.info[o].stationGuid)&&1!=a.info[o].id&&n.push(a.info[o]),1==a.info[o].pId&&e.expandedKeys.push(a.info[o].id);n.length>0&&(e.orgdata=Object(r.a)(n)),i&&(e.clearNewMsgNum(s),e.getDataList(i))}else e.orgdata=[];e.$nextTick(function(){e.isOrgFirst?(e.$refs.orgTree.setCurrentKey(1),e.orgdata.length>0&&(e.currItem=e.orgdata[0]),e.isOrgFirst=!1):e.$refs.orgTree.setCurrentKey(e.currItem.id)})}).catch(function(t){e.$showMessage("error",t),e.orgdata=[]})},deleteNoneProjectOrg:function(e){var t=[];e.forEach(function(e){t.push(e.pId)});for(var a=[],i=0;i<e.length;i++)2!=e[i].type&&-1==t.indexOf(e[i].id)||a.push(e[i]);a.length==e.length?this.orgdata=Object(r.a)(a):this.deleteNoneProjectOrg(a)},handleNodeClick:function(e){this.currItem=e;var t=0,a=[];if(2==this.currItem.type)e.stationGuid&&(a.push(e.stationGuid),t=this.g_newAlarmNum[e.stationGuid]||0);else if(e.children)for(var i=0;i<e.children.length;i++)if(e.children[i].children)for(var r=0;r<e.children[i].children.length;r++)e.children[i].children[r].stationGuid&&(a.push(e.children[i].children[r].stationGuid),t+=this.g_newAlarmNum[e.children[i].children[r].stationGuid]||0);else e.children[i].stationGuid&&(a.push(e.children[i].stationGuid),t+=this.g_newAlarmNum[e.children[i].stationGuid]||0);a.length>0?(this.currentStationName=e.name,this.allSelectStationNewAlarmNum=t,this.getDataList(a.join(","))):this.$showMessage("warning","未绑定站点")},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},clearNewMsgNum:function(e){var t=e.toString().split(","),a={};for(var i in t)a[t[i]]=0;this.clearSelectTreeData(a),this.$store.commit("set_g_newAlarmNum",a)},getDefaultSearchTime:function(){var e=new Date;this.endTime=e;var t=new Date(new Date-864e5);this.startTime=t},echartInfo:function(){this.chart=this.$echarts.init(document.getElementById("echart")),this.chart.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{show:!1,orient:"vertical",left:"left",data:this.dataAxis1},series:[{name:"报警状态",type:"pie",radius:"68%",center:["50%","65%"],data:this.echartData,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})},loadNewData:function(){this.allSelectStationNewAlarmNum=0;var e=this.guidForData,t=[];t.push(e),this.clearNewMsgNum(t),this.getDataList(e)},getDataList:function(e){var t=this;this.guidForData=e,this.tableData=[],this.$axios({method:"get",headers:{},url:"/web/alarm/getAllAlarmRecord",params:{stationGuids:e}}).then(function(e){var a=e.data;0==a.code?(t.tableData=a.info,t.tableDataForFliter=t.tableData,t.getDataPieInfo(a.info)):t.$showMessage("error",a.msg)}).catch(function(e){t.$showMessage("error",e)})},queryData:function(){var e=this;this.tableData=this.tableDataForFliter.filter(function(t){return(!e.searchValue||t.deviceName.toLowerCase().includes(e.searchValue.toLowerCase())||t.content.includes(e.searchValue.toLowerCase()))&&(!e.alarmStatus||t.recordState==e.alarmStatus)&&(!e.startTime||t.alarmTime>e.startTime)&&(!e.endTime||t.alarmTime<e.endTime)})},getAlarmStatusStr:function(e){return 1==e.recordState?"报警中":2==e.recordState?e.confirmUser+"已确认":3==e.recordState?"报警已恢复未确认":4==e.recordState?"报警已正常":void 0},confirmAlarmReq:function(e){var t=this;this.$axios({method:"post",headers:{},url:"/web/alarm/confirmSoe",data:e}).then(function(e){var a=e.data;0==a.code?t.$showMessage("success","确认成功"):t.$showMessage("error",a.msg)}).catch(function(e){t.$showMessage("error",e)})},confirmAlarm:function(e){var t=[{guid:e.guid,time:this.formatDateTime(new Date),stationGuid:e.stationGuid}];this.confirmAlarmReq(t)},confirmAlarmAll:function(){for(var e=[],t=this.formatDateTime(new Date),a=0;a<this.tableData.length;a++){var i={guid:this.tableData[a].guid,time:t,stationGuid:this.tableData[a].stationGuid};e.push(i)}this.confirmAlarmReq(e)},getDataPieInfo:function(e){this.dataAxis1=[],this.echartData=[];for(var t=[0,0,0,0],a=0;a<e.length;a++)for(var i=e[a].recordState,r=1;r<=4;r++)i==r&&t[r-1]++;for(var s=1;s<=t.length;s++){var n="";1==s?n="报警中":2==s?n="报警已确认":3==s?n="报警已恢复未确认":4==s&&(n="报警已正常"),this.dataAxis1.push(n),this.echartData.push({value:t[s-1],name:n})}this.echartInfo()},clearSelectTreeData:function(e){for(var t=this.orgdata,a=0;a<t.length;a++){var r=t[a];for(var s in e)if(2==r.type)r.stationGuid&&r.stationGuid==s&&(r.newAlarmNum=0,0);else if(r.children)for(var n=0;n<r.children.length;n++)if(r.children[n].children)for(var o=0;o<r.children[n].children.length;o++)r.children[n].children[o].stationGuid&&r.children[n].children[o].stationGuid==s&&(r.children[n].children[o].newAlarmNum=0,0);else r.children[n].stationGuid&&r.children[n].stationGuid==s&&(r.children[n].newAlarmNum=0,0)}this.orgdata=[],this.orgdata=Object(i.a)(t)},updateTreeData:function(){for(var e=0,t=this.orgdata,a=0;a<t.length;a++){var r=t[a];if(2==r.type)r.stationGuid&&(r.newAlarmNum+=this.g_newAlarmNum[stationGuid]||0,e+=this.g_newAlarmNum[stationGuid]);else if(r.children)for(var s=0;s<r.children.length;s++)if(r.children[s].children)for(var n=0;n<r.children[s].children.length;n++)r.children[s].children[n].stationGuid&&(r.children[s].children[n].newAlarmNum+=this.g_newAlarmNum[r.children[s].children[n].stationGuid]||0,e+=this.g_newAlarmNum[r.children[s].children[n].stationGuid]);else r.children[s].stationGuid&&(r.children[s].newAlarmNum+=this.g_newAlarmNum[r.children[s].stationGuid]||0,e+=this.g_newAlarmNum[r.children[s].stationGuid])}this.allSelectStationNewAlarmNum+=e,this.orgdata=[],this.orgdata=Object(i.a)(t)}},computed:{alarmInfoChanged:function(){return this.$store.state.g_newAlarmInfo},alarmNumChanged:function(){return this.$store.state.g_newAlarmNum}},watch:{filterText:function(e){this.$refs.orgTree.filter(e)},alarmInfoChanged:function(e){this.g_newAlarmInfo=e;for(var t=0;t<this.tableData.length;t++)e.stationGuid==this.tableData[t].stationGuid&&e.guid==this.tableData[t].guid&&(this.tableData[t].recordState=e.recordState,this.tableData[t].confirmUser=e.confirmUser,4==e.recordState&&this.tableData.splice(t,1));this.getDataPieInfo(this.tableData)},alarmNumChanged:function(e){this.g_newAlarmNum=e,this.updateTreeData()}}},n=(a("9554"),a("5d22")),o=Object(n.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"alarmCenter"},[a("div",{staticClass:"config-info-div"},[a("div",{staticClass:"left-div"},[a("div",{staticClass:"bottom-content tree-container"},[a("el-tree",{ref:"orgTree",staticClass:"tree",attrs:{data:e.orgdata,props:e.defaultProps,"node-key":"id","default-expanded-keys":e.expandedKeys,"highlight-current":"","filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{class:r.biaoqian}),a("span",[e._v(" "+e._s(i.label)+" "),r.stationGuid?a("span",[e._v("("+e._s(r.newAlarmNum)+"条)")]):e._e()])])])}}])})],1)]),a("div",{staticClass:"right-div"},[a("div",{staticClass:"top-div"},[a("div",{staticClass:"left",staticStyle:{display:"flex",width:"40%","justify-content":"space-between"}},[a("div",[a("p",[e._v(e._s(e.currentStationName))]),a("p",[a("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.loadNewData()}}},[e._v("最新报警"),a("span",{class:{red:e.isRed},attrs:{id:"newMsgNum"}},[e._v(e._s(e.allSelectStationNewAlarmNum)+"条")])])])]),a("div",{staticClass:"echartsinfo",attrs:{id:"echart"}})]),a("div",{staticClass:"right",staticStyle:{width:"60%"}},[a("div",[a("label",{staticStyle:{"margin-left":"10%"}},[e._v("报警时间：")]),a("div",{staticStyle:{display:"inline-block"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择时间","value-format":"timestamp"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}})],1),a("label",{staticStyle:{width:"30px","text-align":"center",display:"inline-block"}},[e._v("-")]),a("div",{staticStyle:{display:"inline-block"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择时间","value-format":"timestamp"},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}})],1)]),a("div",[a("span",{staticStyle:{"margin-left":"10%"}},[e._v("报警状态：")]),a("el-select",{staticStyle:{width:"1.5rem"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.alarmStatus,callback:function(t){e.alarmStatus=t},expression:"alarmStatus"}},e._l(e.alarmStatusArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),a("span",{staticStyle:{"margin-left":"0.25rem"}},[e._v("模糊查询：")]),a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"设备名/报警内容"},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),a("el-button",{staticClass:"btnFontSize",staticStyle:{"margin-left":"15px"},attrs:{type:"primary"},on:{click:e.queryData}},[e._v("查询")])],1)])]),a("div",{ref:"deviceTable",staticClass:"bottom-table-div",staticStyle:{"background-color":"#fff",height:"80%"}},[a("el-table",{staticStyle:{width:"100%",cursor:"pointer"},attrs:{data:e.tableData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),"default-sort":{prop:"alarmTime",order:"descending"},"highlight-current-row":"",height:e.tableHeight}},[a("el-table-column",{attrs:{label:"序号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.$index+(e.currentPage-1)*e.pageSize+1))]}}])}),a("el-table-column",{attrs:{label:"变量名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.varName))]}}])}),a("el-table-column",{attrs:{label:"设备名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.deviceName))]}}])}),a("el-table-column",{attrs:{label:"站点名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.stationName))]}}])}),a("el-table-column",{attrs:{label:"报警时间",align:"center",prop:"alarmTime",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatDateTime(1e3*t.row.alarmTime)))]}}])}),a("el-table-column",{attrs:{label:"报警值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.value))]}}])}),a("el-table-column",{attrs:{label:"报警内容",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.content))]}}])}),a("el-table-column",{attrs:{label:"报警状态",align:"center",prop:"recordState"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:2==t.row.recordState?"green":""},[e._v(e._s(e.getAlarmStatusStr(t.row)))])]}}])}),a("el-table-column",{attrs:{label:"报警确认",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[3!=t.row.recordState&&1!=t.row.recordState||!t.row.needConfirm?e._e():a("div",[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.confirmAlarm(t.row)}}},[e._v("确认")])],1),2==t.row.recordState?a("div",[a("span",[e._v(e._s(e.formatDateTime(1e3*t.row.confirmTime)))])]):e._e()]}}])})],1),a("div",{staticClass:"tableBottom"},[a("el-pagination",{staticStyle:{float:"right","margin-top":"0.1rem"},attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.tableData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),this.tableData.length>0?a("div",{staticClass:"confirmAll",staticStyle:{"text-align":"left","margin-top":"20px"}},[a("el-button",{staticClass:"btnFontSize",staticStyle:{"margin-left":"15px"},attrs:{type:"primary"},on:{click:e.confirmAlarmAll}},[e._v("一键确认")])],1):e._e()],1)])])])},[],!1,null,null,null);t.default=o.exports},9554:function(e,t,a){"use strict";a("25f9")},"9aea":function(e,t,a){"use strict";a("d3a9")},"9f0c":function(e,t,a){"use strict";a.r(t);a("e3b5"),a("3bae"),a("1d43");var i=a("3de1"),r={data:function(){return{treeFilterText:"",treeData:[],defaultProps:{children:"children",label:"name"},stationInfo:{name:"",id:""},reportType:"day",reportTypeName:"日报表",dayTime:Object(i.c)(new Date),riseDownTime:Object(i.c)(new Date),riseDownRefTime:"",periodTimeRange:["",""],periodSpaceTime:1,periodSpaceType:60,periodSpaceTypeArr:[{value:1440,label:"天"},{value:60,label:"小时"},{value:1,label:"分钟"}],pickerOptions:{disabledDate:function(e){return e.getTime()>(new Date).getTime()}},fileList:[],previewUrl:"",rightDivForbidden:!0,expandedKeys:[]}},created:function(){this.getProjectList(),this.periodTimeRange[0]=this.getLateDays(1),this.periodTimeRange[1]=this.getLateDays(0),this.riseDownRefTime=this.getLateDays(1)},watch:{treeFilterText:function(e){this.$refs.tree.filter(e)}},methods:{getProjectList:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/project/queryGroupsProjects"}).then(function(t){var a=t.data;if(0==a.code){for(var r=[],s=!1,n=0;n<a.info.length;n++)1==a.info[n].type?(a.info[n].biaoqian="el-tree-city",61==a.info[n].id&&(s=!0)):a.info[n].biaoqian="el-tree-project",2==a.info[n].type?a.info[n].disabled=!1:a.info[n].disabled=!0,(2!=a.info[n].type||a.info[n].stationGuid)&&1!=a.info[n].id&&r.push(a.info[n]),1==a.info[n].pId&&e.expandedKeys.push(a.info[n].id);var o=Object(i.a)(r);s&&(o=Object(i.k)(o)),e.treeData=o}}).catch(function(e){Object(i.j)("error",e)})},deleteNoneProjectOrg:function(e){var t=[];e.forEach(function(e){t.push(e.pId)});for(var a=[],r=0;r<e.length;r++)2!=e[r].type&&-1==t.indexOf(e[r].id)||a.push(e[r]);if(a.length==e.length){this.treeData=Object(i.a)(a);for(var s=0;s<this.treeData.length;s++)this.expandedKeys.push(this.treeData[s].id)}else this.deleteNoneProjectOrg(a)},handleNodeClick:function(e,t){2==e.type?(this.stationInfo=e,e.stationGuid?this.rightDivForbidden=!1:(this.rightDivForbidden=!0,this.$message({message:"所选项目未绑定站点",type:"error"}))):(this.$refs.tree.setCurrentKey(null),this.stationInfo={name:"",id:""},this.rightDivForbidden=!0)},treeFilterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},previewOrDownloadExcel:function(e){var t=this;if("day"!=this.reportType||this.dayTime){if("rise"==this.reportType){if(!this.riseDownTime||!this.riseDownRefTime)return void Object(i.j)("warning","请选择时间");if(new Date(this.riseDownRefTime).getTime()>new Date(this.riseDownTime).getTime())return void Object(i.j)("warning","参考时间不能大于选择时间");if(new Date(this.riseDownTime).getTime()>(new Date).getTime())return void Object(i.j)("warning","所选时间不能大于当前时间")}if("cycle"==this.reportType){if(!this.periodTimeRange[0]||!this.periodTimeRange[1])return void Object(i.j)("warning","请选择时间");if(new Date(this.periodTimeRange[1]).getTime()>(new Date).getTime())return void Object(i.j)("warning","所选时间不能大于当前时间");if(0==e){var a=parseInt(new Date(this.periodTimeRange[1]).getTime()/1e3)-parseInt(new Date(this.periodTimeRange[0]).getTime()/1e3);if(a<0)return void Object(i.j)("warning","结束时间不能小于开始时间");var r=a/60,s=this.periodSpaceTime*this.periodSpaceType;if(r/s>200){var n,o=Math.ceil(r/200/s);return this.periodSpaceTypeArr.forEach(function(e){e.value==t.periodSpaceType&&(n=e.label)}),void Object(i.j)("warning","间隔周期超出EXCEL的限制，建议周期为"+o+n+"以上")}}}var l="cycle"==this.reportType?this.periodTimeRange[0]:this.riseDownTime,c="cycle"==this.reportType?this.periodTimeRange[1]:this.riseDownRefTime;if(0==e)this.previewUrl="",this.$axios({method:"get",headers:{},url:"web/report/exportExcel",params:{reportName:this.reportType,time:this.dayTime,timeBegin:l,timeEnd:c,cycleByMin:this.periodSpaceTime*this.periodSpaceType,stationGuid:this.stationInfo.stationGuid,projectId:this.stationInfo.id,flag:e}}).then(function(e){var a=e.data;0==a.code?t.previewUrl=a.info+"?_t="+(new Date).getTime():Object(i.j)("warning",a.msg)}).catch(function(e){Object(i.j)("error",e)});else{var u="/web/report/exportExcel?reportName="+this.reportType+"&time="+this.dayTime+"&timeBegin="+l+"&timeEnd="+c+"&cycleByMin="+this.periodSpaceTime*this.periodSpaceType+"&stationGuid="+this.stationInfo.stationGuid+"&projectId="+this.stationInfo.id+"&flag="+e;window.open(u)}}else Object(i.j)("warning","请选择时间")},downloadExcelTemplate:function(){var e="/web/report/downExcel?reportName="+this.reportType+"&projectId="+this.stationInfo.id;window.open(e)},changeCurrentReportType:function(e,t){this.reportType!=e&&(this.reportType=e,this.reportTypeName=t,this.previewUrl="")},uploadError:function(e,t,a){this.$message({message:"上传失败",type:"error"})},uploadSuccess:function(e,t,a){0==e.code?this.$message({message:"上传成功",type:"success"}):this.$message({message:e.msg,type:"error"})},beforeUpload:function(e){},getLateDays:function(e){var t=new Date,a=new Date(t.getTime()-864e5*e),i="";return i+=a.getFullYear()+"-",i+=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,i+="-",i+=a.getDate()<10?"0"+a.getDate():a.getDate(),i+=" ",i+=a.getHours()<10?"0"+a.getHours():a.getHours(),i+=":",i+=a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes(),i+=":",i+=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds()}}},s=(a("2d39"),a("5d22")),n=Object(s.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"customReport"},[a("div",{staticClass:"leftDiv"},[a("el-input",{attrs:{placeholder:"输入关键字搜索站点"},model:{value:e.treeFilterText,callback:function(t){e.treeFilterText=t},expression:"treeFilterText"}}),a("div",{staticClass:"programTreeDiv tree-container"},[a("el-tree",{ref:"tree",staticClass:"tree filter-tree",staticStyle:{"margin-top":"0.1rem"},attrs:{data:e.treeData,props:e.defaultProps,"filter-node-method":e.treeFilterNode,"node-key":"id","default-expanded-keys":e.expandedKeys,"highlight-current":""},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,r=t.data;return a("div",{staticClass:"customNode",class:{nodeDisabled:r.disabled}},[a("span",[a("i",{class:r.biaoqian,staticStyle:{"line-height":"1"}}),e._v(" "+e._s(i.label)+" ")])])}}])})],1)],1),a("div",{staticClass:"rightDiv",class:{forbidden:e.rightDivForbidden}},[a("div",{staticClass:"topDiv"},[a("p",{staticClass:"title"},[e._v(">"+e._s(e.stationInfo.name))]),a("div",{staticClass:"button hand-css",class:{"button-active":"day"==e.reportType},on:{click:function(t){return e.changeCurrentReportType("day","日报表")}}},[e._v(" 日报表 ")]),a("div",{staticClass:"button"},[e._v("/")]),a("div",{staticClass:"button hand-css",class:{"button-active":"rise"==e.reportType},on:{click:function(t){return e.changeCurrentReportType("rise","涨降值报表")}}},[e._v(" 涨降值报表 ")]),a("div",{staticClass:"button"},[e._v("/")]),a("div",{staticClass:"button hand-css",class:{"button-active":"cycle"==e.reportType},on:{click:function(t){return e.changeCurrentReportType("cycle","周期报表")}}},[e._v(" 周期报表 ")])]),a("div",{staticClass:"reportConditionDiv"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"day"==e.reportType,expression:"reportType == 'day'"}],staticClass:"subCoonditionDiv",staticStyle:{flex:"0.8"}},[a("p",[e._v("选择时间")]),a("el-date-picker",{staticClass:"timeInput",attrs:{type:"datetime",placeholder:"请选择时间",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center"},model:{value:e.dayTime,callback:function(t){e.dayTime=t},expression:"dayTime"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:!e.stationInfo.stationGuid},on:{click:function(t){return e.previewOrDownloadExcel(0)}}},[e._v("预览")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:!e.stationInfo.stationGuid},on:{click:function(t){return e.previewOrDownloadExcel(1)}}},[e._v("导出")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"rise"==e.reportType,expression:"reportType == 'rise'"}],staticClass:"subCoonditionDiv",staticStyle:{flex:"0.8"}},[a("p",[e._v("选择时间")]),a("el-date-picker",{staticStyle:{"margin-left":"10px"},attrs:{type:"datetime",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择时间"},model:{value:e.riseDownTime,callback:function(t){e.riseDownTime=t},expression:"riseDownTime"}}),a("p",{staticStyle:{"margin-left":"10px"}},[e._v("参考时间")]),a("el-date-picker",{staticStyle:{"margin-left":"10px"},attrs:{type:"datetime",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择时间"},model:{value:e.riseDownRefTime,callback:function(t){e.riseDownRefTime=t},expression:"riseDownRefTime"}}),a("el-button",{attrs:{type:"primary",disabled:!e.stationInfo.stationGuid},on:{click:function(t){return e.previewOrDownloadExcel(0)}}},[e._v("预览")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:!e.stationInfo.stationGuid},on:{click:function(t){return e.previewOrDownloadExcel(1)}}},[e._v("导出")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"cycle"==e.reportType,expression:"reportType == 'cycle'"}],staticClass:"subCoonditionDiv",staticStyle:{flex:"0.8"}},[a("p",[e._v("开始：")]),a("el-date-picker",{staticStyle:{"margin-left":"10px"},attrs:{type:"datetime",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center"},model:{value:e.periodTimeRange[0],callback:function(t){e.$set(e.periodTimeRange,0,t)},expression:"periodTimeRange[0]"}}),a("p",{staticStyle:{"margin-left":"10px"}},[e._v("结束：")]),a("el-date-picker",{attrs:{type:"datetime",editable:!1,clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",align:"center"},model:{value:e.periodTimeRange[1],callback:function(t){e.$set(e.periodTimeRange,1,t)},expression:"periodTimeRange[1]"}}),a("p",{staticStyle:{"margin-left":"0.1rem"}},[e._v("间隔：")]),a("el-input",{staticStyle:{width:"0.8rem"},model:{value:e.periodSpaceTime,callback:function(t){e.periodSpaceTime=t},expression:"periodSpaceTime"}}),a("el-select",{staticStyle:{width:"0.9rem"},attrs:{placeholder:"请选择"},model:{value:e.periodSpaceType,callback:function(t){e.periodSpaceType=t},expression:"periodSpaceType"}},e._l(e.periodSpaceTypeArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),a("el-button",{attrs:{type:"primary",disabled:!e.stationInfo.stationGuid},on:{click:function(t){return e.previewOrDownloadExcel(0)}}},[e._v("预览")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(t){return e.previewOrDownloadExcel(1)}}},[e._v("导出")])],1),a("div",{staticClass:"subCoonditionDiv",staticStyle:{flex:"0.4","justify-content":"flex-end"}},[a("p",[e._v(e._s(e.reportTypeName)+"模板")]),a("el-upload",{staticClass:"upload",attrs:{action:"/web/report/uploadExcel?excelName="+e.reportType+"&projectId="+e.stationInfo.id,"on-error":e.uploadError,"on-success":e.uploadSuccess,"before-upload":e.beforeUpload,accept:".xlsx","file-list":e.fileList,"show-file-list":!1}},[a("el-button",{attrs:{type:"success",disabled:!e.stationInfo.stationGuid}},[e._v("上传")])],1),a("el-button",{attrs:{type:"success",icon:"el-icon-download",disabled:!e.stationInfo.stationGuid},on:{click:e.downloadExcelTemplate}},[e._v("下载")])],1)]),a("div",{ref:"hisTable",staticClass:"tableDiv"},[a("iframe",{attrs:{src:e.previewUrl,frameborder:"0",width:"100%",height:"100%"}})])])])},[],!1,null,null,null);t.default=n.exports},a35e:function(e,t,a){"use strict";a("73d4")},a90e:function(e,t,a){"use strict";a("ae8c")},ac16:function(e,t,a){"use strict";a.r(t);var i=a("58c8"),r=a("6abc"),s=(a("5b12"),a("9b5f"),a("27ae"),a("d447"),a("1d43"),a("bf2f"),a("fc13"),a("3de1")),n={data:function(){var e=this;return{tags:[{id:1,name:1}],userId:"",settingData:[],projects:"",tableData:[],currentPage:1,pageSize:10,tableHeight:0,title:"",dialogVisible:!1,dialogWidth:"5.8rem",tableLoading:!1,addBtnLoading:!1,editBtnLoading:!1,addBtnsLoading:!1,organizeId:"",allOrganize:"",ruleForm:{userPasswd:"",userConPasswd:"",userName:"",department:[],realName:"",phone:"",role:2,types:[]},ruleForm2:{userPasswd:"",userConPasswd:"",oidPassword:"",userName:"",department:"",realName:"",phone:"",role:2},ruleForm3:[{userPasswd:"",userConPasswd:"",userName:"",department:"",realName:"",phone:"",role:2,types:[]}],rules:{userPasswd:[{validator:function(t,a,i){""===a?i(new Error("请输入密码")):(""!==e.ruleForm.userConPasswd&&e.$refs.ruleForm.validateField("userConPasswd"),i())},trigger:"blur",required:!0}],userConPasswd:[{validator:function(t,a,i){""===a?i(new Error("请再次输入密码")):a!==e.ruleForm.userPasswd?i(new Error("两次输入密码不一致")):i()},trigger:"blur",required:!0}],userName:[{message:"用户名不能为空",trigger:"blur",required:!0}],phone:[{message:"联系方式不能为空",trigger:"blur",required:!0}],realName:[{message:"真实姓名不能为空",trigger:"blur",required:!0}],department:[{message:"请选择组织架构不能为空",trigger:"change",required:!0}]},rules2:{userPasswd:[{validator:function(t,a,i){""==a&&""==e.ruleForm2.userConPasswd?i():""===a?i(new Error("请输入密码")):(""!==e.ruleForm2.userConPasswd&&e.$refs.ruleForm2.validateField("userConPasswd"),i())},trigger:"blur"}],userConPasswd:[{validator:function(t,a,i){""==a&&""==e.ruleForm2.userConPasswd?i():""===a?i(new Error("请再次输入密码")):a!==e.ruleForm2.userPasswd?i(new Error("两次输入密码不一致")):i()},trigger:"blur"}],phone:[{message:"联系方式不能为空",trigger:"blur",required:!0}],realName:[{message:"真实姓名不能为空",trigger:"blur",required:!0}],department:[{message:"请选择组织架构不能为空",trigger:"change",required:!0}]},rootProjectItem:{id:0,pId:null,name:"根节点",type:1,selected:!0},treeData1:[],defaultProps1:{children:"children",label:"name"},defaultProps2:{children:"children",emitPath:!1,checkStrictly:!0,label:"name",value:"id",expandTrigger:"hover"},cascaderValue:[],userGroups:[],ids:[],delUserIf:!1}},created:function(){this.getGroupList(),this.getTreeList(),this.getTag()},mounted:function(){this.getTableHeight()},methods:{getTagData:function(e){var t=this;this.$axios({method:"get",headers:{},url:"/web/group/queryRoleGroupById",params:{groupId:e}}).then(function(e){var a=e.data;if(0==a.code){var i=[];for(var r in a.info.types.split(","))i.push(a.info.types.split(",")[r]-0);t.settingData=i,t.settingData}else t.$showMessage("error",a.msg)}).catch(function(e){t.$showMessage("error",e)})},setSetting:function(){var e=this;this.$prompt("请输入模板名称","保存模板",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(function(t){e.$axios({method:"post",headers:{},url:"/web/group/addRoleGroup",data:{name:t.value,depict:"",type:e.settingData.toString(),item:""}}).then(function(t){var a=t.data;0==a.code?(e.$showMessage("success","已添加"),e.getTag()):e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)})}).catch(function(){})},getTag:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/group/queryAllRoleGroup"}).then(function(t){var a=t.data;0==a.code?e.tags=a.info:e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)})},handleClose:function(e){var t=this;this.$confirm("是否删除此模板?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios({method:"get",headers:{},url:"/web/group/deleteRoleGroup",params:{groupId:e}}).then(function(e){var a=e.data;0==a.code?(t.$showMessage("success","已删除"),t.getTag()):t.$showMessage("error",a.msg)}).catch(function(e){t.$showMessage("error",e)})}).catch(function(){})},addSettings:function(){var e=this,t=[];for(var a in this.userIds)t.push({userGuid:this.userIds[a],types:this.settingData.toString()});this.$axios({method:"post",headers:{},url:"/web/user/updataUserRight",data:t}).then(function(t){var a=t.data;0==a.code?(e.$showMessage("success","已添加"),e.dialogVisible=!1):e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)})},addSetting:function(){var e=this;this.$axios({method:"post",headers:{},url:"/web/user/updataUserRight",data:[{userGuid:this.userId,types:this.settingData.toString()}]}).then(function(t){var a=t.data;0==a.code?(e.$showMessage("success","已添加"),e.dialogVisible=!1):e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)})},queryProject:function(e){var t=this;this.$axios({method:"get",headers:{},url:"/web/UPPGController/queryProIdByUserId",params:{userGuid:e}}).then(function(e){var a=e.data;if(0==a.code){var i=[];for(var r in t.dialogVisible=!0,t.dialogWidth="5.8rem",t.title="项目权限",a.info)i.push(a.info[r].projectName);0==i.length&&(i=["无项目权限"]),t.projects=i.toString()}else t.$showMessage("error",a.msg)}).catch(function(e){t.$showMessage("error",e)})},handleChange:function(){this.ruleForm.department},handleSelectionChange:function(e){var t=[];for(var a in e)t.push(e[a].userGuid);this.delUserIf=e.length>0,this.ids=t},delUser:function(){var e=this;0!=this.ids.length?this.$axios({method:"get",headers:{},url:"/web/user/deleteUser",params:{userGuids:this.ids.toString()}}).then(function(t){var a=t.data;0==a.code?(e.getList(),e.$showMessage("success","用户删除成功")):e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)}):this.$showMessage("error","请选择用户")},tableRowClassName:function(e){var t=e.row;e.rowIndex;return 1===t.state?"warning-row":""},editBtn:function(e){this.dialogVisible=!0,this.dialogWidth="5.8rem",this.title="编辑账户",this.ruleForm2={userPasswd:"",userConPasswd:"",oidPassword:"",userName:e.name,department:e.organizeId,realName:e.realName,phone:e.phone,userGuid:e.userGuid,role:e.role}},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},getTableHeight:function(){this.$nextTick(function(){this.tableHeight=window.getComputedStyle(this.$refs.table).height.split("px")[0]-0})},getGroupList:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/group/queryAllRoleGroup"}).then(function(t){var a=t.data;0==a.code?e.userGroups=a.info:e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)})},getList:function(){var e=this;this.tableLoading=!0,this.$axios({method:"get",headers:{},url:"/web/user/queryUserByOrgid",params:{organizeId:this.organizeId}}).then(function(t){var a=t.data;0==a.code?(e.tableData=a.info,e.tableData):e.$showMessage("error",a.msg),e.tableLoading=!1}).catch(function(t){e.$showMessage("error",t),e.tableLoading=!1})},dialogClose:function(){},permissionSettings:function(){var e=this.ids;0==this.ids.length&&this.$showMessage("error","请选择用户"),this.userIds=e,this.dialogVisible=!0,this.dialogWidth="5.8rem",this.title="批量设置权限",this.settingData=[]},permissionSetting:function(e){var t=this;this.$axios({method:"get",headers:{},url:"/web/user/queryUserByName",params:{userName:e.name}}).then(function(e){var a=e.data;0==a.code?(t.dialogVisible=!0,t.dialogWidth="5.8rem",t.title="设置权限",t.userId=a.info.userGuid,t.settingData=a.info.rights):t.$showMessage("error",a.msg)}).catch(function(e){t.$showMessage("error",e)})},dialogOpen:function(){var e=this;this.$nextTick(function(){e.ruleForm={userPasswd:"",userConPasswd:"",userName:"",department:e.organizeId,realName:"",phone:"",role:2,types:[]},e.ruleForm3=[{userPasswd:"",userConPasswd:"",userName:"",department:"",realName:"",phone:"",role:2,types:[]}],"新增账户"==e.title?e.$refs.ruleForm.clearValidate():"编辑账户"==e.title&&e.$refs.ruleForm2.clearValidate()})},addBtn:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return!1;e.addBtnLoading=!0,e.$axios({method:"post",headers:{},url:"/web/user/addUser",data:[{userName:e.ruleForm.userName,userPasswd:e.$md5(e.ruleForm.userPasswd+"").toUpperCase(),userConPasswd:e.$md5(e.ruleForm.userConPasswd+"").toUpperCase(),organizeId:e.ruleForm.department,realName:e.ruleForm.realName,role:e.ruleForm.role,phone:e.ruleForm.phone,types:e.ruleForm.types.toString()}]}).then(function(t){0==t.data.code?(e.$showMessage("success","用户添加成功"),e.getList(),e.dialogVisible=!1):e.$showMessage("error",t.data.msg),e.addBtnLoading=!1}).catch(function(t){e.$showMessage("error",t),e.addBtnLoading=!1})})},editClick:function(){var e=this;this.$refs.ruleForm2.validate(function(t){if(!t)return!1;e.editBtnLoading=!0,e.$axios({method:"post",headers:{},url:"/web/user/updateUserByManager",data:{userPasswd:""==e.ruleForm2.userPasswd?void 0:e.$md5(e.ruleForm2.userPasswd+"").toUpperCase(),userConPasswd:""==e.ruleForm2.userConPasswd?void 0:e.$md5(e.ruleForm2.userConPasswd+"").toUpperCase(),organizeId:e.ruleForm2.department,realName:e.ruleForm2.realName,phone:e.ruleForm2.phone,userGuid:e.ruleForm2.userGuid}}).then(function(t){0==t.data.code?(e.$showMessage("success","用户修改成功"),e.getList(),e.dialogVisible=!1):e.$showMessage("error",t.data.msg),e.editBtnLoading=!1}).catch(function(t){e.editBtnLoading=!1,e.$showMessage("error",t)})})},addBtns:function(){var e=this;this.addBtnsLoading=!0;var t=[],a=[],i=[];for(var s in this.ruleForm3){if(""==this.ruleForm3[s].department?this.ruleForm3[s].department=t:t=this.ruleForm3[s].department,this.ruleForm3[s].types,0==this.ruleForm3[s].types.length?this.ruleForm3[s].types=a:a=this.ruleForm3[s].types,""==this.ruleForm3[s].phone||""==this.ruleForm3[s].realName||""==this.ruleForm3[s].userName||""==this.ruleForm3[s].department||0==this.ruleForm3[s].types.length)return this.$showMessage("error","请填写完整信息"),void(this.addBtnsLoading=!1);i.push(Object(r.a)(Object(r.a)({organizeId:this.ruleForm3[s].department.toString()-0},this.ruleForm3[s]),{},{userPasswd:this.$md5("12345678").toUpperCase(),userConPasswd:this.$md5("12345678").toUpperCase(),types:this.ruleForm3[s].types.toString()}))}this.$axios({method:"post",headers:{},url:"/web/user/addUser",data:i}).then(function(t){0==t.data.code?(e.$showMessage("success","用户添加成功"),e.getList(),e.dialogVisible=!1):e.$showMessage("error",t.data.msg),e.addBtnsLoading=!1}).catch(function(t){e.$showMessage("error",t),e.addBtnsLoading=!1})},nodeClick1:function(e){this.organizeId=e.id,this.getList()},onConfirm:function(e,t){var a=this,i=e.$index+(this.currentPage-1)*this.pageSize;switch(t){case 1:this.$axios({method:"get",headers:{},url:"/web/user/lockUser",params:{userGuid:e.row.userGuid}}).then(function(e){0==e.data.code?a.tableData[i].state=1:a.$showMessage("error",e.data.msg)}).catch(function(e){a.$showMessage("error",e)});break;case 2:this.$axios({method:"get",headers:{},url:"/web/user/unLockUser",params:{userGuid:e.row.userGuid}}).then(function(e){0==e.data.code?a.tableData[i].state=0:a.$showMessage("error",e.data.msg)}).catch(function(e){a.$showMessage("error",e)});break;case 3:this.$axios({method:"get",headers:{},url:"/web/user/resetUserPasswd",params:{userGuid:e.row.userGuid}}).then(function(e){0==e.data.code?a.$showMessage("success","密码重置成功"):a.$showMessage("error",e.data.msg)}).catch(function(e){a.$showMessage("error",e)});break;case 4:this.$axios({method:"get",headers:{},url:"/web/user/deleteUser",params:{userGuids:e.row.userGuid}}).then(function(e){0==e.data.code?(a.$showMessage("success","用户已被删除"),a.getList()):a.$showMessage("error",e.data.msg)}).catch(function(e){a.$showMessage("error",e)})}},onCancel:function(e,t){},addUserList:function(){this.ruleForm3.push({userPasswd:"",userConPasswd:"",userName:"",department:"",realName:"",phone:"",role:2,types:[]})},delUserList:function(e){this.ruleForm3.splice(e,1)},getTreeList:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/organize/queryOrganize"}).then(function(t){var a=t.data;if(0==a.code){for(var r,n=0;n<a.info.length;n++)1==a.info[n].type?a.info[n].biaoqian="el-tree-city":a.info[n].biaoqian="el-tree-project";e.$store.state.userInfo.rights[0];r=Object(i.a)(a.info),e.allOrganize=Object(i.a)(r),e.treeData1=Object(s.a)(r),e.organizeId=e.treeData1[0].id,e.$nextTick(function(){e.$refs.tree1.setCurrentKey(0)}),e.getList()}else e.$showMessage("error",a.msg)}).catch(function(t){e.$showMessage("error",t)})},getUserGroup:function(e){},getOrganize:function(e){var t="";for(var a in this.allOrganize)if(this.allOrganize[a].id==e){t=this.allOrganize[a].name;break}return t},inputValidate:function(){var e=event.target;e.value=e.value.replace(/\s+/g,"")}}},o=(a("3286"),a("5d22")),l=Object(o.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user"},[a("div",{staticClass:"content"},[a("div",{staticClass:"left"},[a("div",[a("el-tree",{ref:"tree1",staticClass:"filter-tree1 tree",attrs:{data:e.treeData1,props:e.defaultProps1,"node-key":"id","default-expanded-keys":[1],"highlight-current":""},on:{"node-click":e.nodeClick1},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{class:r.biaoqian}),e._v(" "+e._s(i.label)+" ")])])}}])})],1)]),a("div",{staticClass:"right"},[a("div",{staticClass:"table"},[a("div",{staticClass:"tableTop"},[a("el-button",{staticClass:"gtr4 addBtn",attrs:{type:"primary"},on:{click:function(t){e.title="批量新增用户",e.dialogWidth="13.16rem",e.dialogVisible=!0}}},[e._v("+ 批量新增用户")]),a("el-button",{staticClass:"addBtn",attrs:{type:"primary"},on:{click:function(t){e.title="新增账户",e.dialogWidth="5.8rem",e.dialogVisible=!0}}},[e._v("+ 新增账户")])],1),a("div",{ref:"table",staticClass:"tableDiv"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{"row-class-name":e.tableRowClassName,data:e.tableData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),stripe:"",height:e.tableHeight,"row-style":{height:"45px"},"cell-style":{padding:"0px"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),a("el-table-column",{attrs:{label:"序号",width:"50",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.$index+(e.currentPage-1)*e.pageSize+1))]}}])}),a("el-table-column",{attrs:{label:"用户名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),a("el-table-column",{attrs:{label:"真实姓名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.realName))]}}])}),a("el-table-column",{attrs:{label:"联系电话",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.phone))]}}])}),a("el-table-column",{attrs:{label:"所属部门",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.getOrganize(t.row.organizeId)))]}}])}),a("el-table-column",{attrs:{label:"账户状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(1==t.row.state?"锁定":"启用"))]}}])}),a("el-table-column",{attrs:{label:"项目权限",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.queryProject(t.row.userGuid)}}},[e._v("查看")])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"320"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{margin:"0 10px 0 10px"},attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(a){return e.permissionSetting(t.row)}}},[e._v("设置权限")]),0==t.row.state?[a("el-popconfirm",{attrs:{title:"确定锁定该用户吗？",iconColor:"#F56C6C",icon:"el-icon-error"},on:{confirm:function(a){return e.onConfirm(t,1)},cancel:function(a){return e.onCancel(t,1)},onConfirm:function(a){return e.onConfirm(t,1)},onCancel:function(a){return e.onCancel(t,1)}}},[a("el-button",{staticClass:"gtr2",attrs:{slot:"reference",size:"mini",type:"primary",icon:"el-icon-lock"},slot:"reference"},[e._v("锁定")])],1)]:e._e(),1==t.row.state?[a("el-popconfirm",{attrs:{title:"确定解锁该用户吗？",iconColor:"#28ac60",icon:"el-icon-success"},on:{confirm:function(a){return e.onConfirm(t,2)},cancel:function(a){return e.onCancel(t,2)},onConfirm:function(a){return e.onConfirm(t,2)},onCancel:function(a){return e.onCancel(t,2)}}},[a("el-button",{staticClass:"gtr3",attrs:{slot:"reference",size:"mini",type:"primary",icon:"el-icon-unlock"},slot:"reference"},[e._v("解锁")])],1)]:e._e(),[a("el-popconfirm",{attrs:{title:"确定重置密码吗？",iconColor:"#67C23A"},on:{confirm:function(a){return e.onConfirm(t,3)},cancel:function(a){return e.onCancel(t,3)},onConfirm:function(a){return e.onConfirm(t,3)},onCancel:function(a){return e.onCancel(t,3)}}},[a("el-button",{staticStyle:{margin:"0 0 0 10px"},attrs:{slot:"reference",size:"mini",type:"success",icon:"el-icon-zhongzhimima"},slot:"reference"},[e._v("重置密码")])],1)],a("el-button",{staticStyle:{margin:"0 0 0 10px"},attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(a){return e.editBtn(t.row)}}},[e._v("编辑")]),[a("el-popconfirm",{attrs:{title:"确定删除该用户吗？",iconColor:"#F56C6C",icon:"el-icon-info"},on:{confirm:function(a){return e.onConfirm(t,4)},onConfirm:function(a){return e.onConfirm(t,4)},cancel:function(a){return e.onCancel(t,4)},onCancel:function(a){return e.onCancel(t,4)}}},[a("el-button",{staticStyle:{margin:"0 0 0 10px"},attrs:{slot:"reference",size:"mini",type:"danger",icon:"el-icon-delete-solid"},slot:"reference"},[e._v("删除")])],1)]]}}])})],1)],1),a("div",{staticClass:"tableBottom"},[a("el-pagination",{staticClass:"page",attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.tableData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("div",{staticClass:"bottomBtn"},[a("el-popconfirm",{attrs:{title:"确定删除吗？",iconColor:"#F56C6C",icon:"el-icon-info"},on:{confirm:e.delUser,onConfirm:e.delUser}},[a("el-button",{staticStyle:{margin:"0 0 0 10px"},attrs:{slot:"reference",size:"mini",type:"danger",icon:"el-icon-delete-solid"},slot:"reference"},[e._v("批量删除")])],1),a("el-button",{staticStyle:{margin:"0 10px 0 10px"},attrs:{slot:"reference",size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:e.permissionSettings},slot:"reference"},[e._v("批量设置权限")])],1)],1)])])]),a("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:e.dialogWidth,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.dialogClose,open:e.dialogOpen}},["新增账户"==e.title?[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"3.9rem","font-size":"1.18rem"},attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"1.2rem","label-position":"right"}},[a("el-form-item",{attrs:{label:"用户名：",prop:"userName"}},[a("el-input",{nativeOn:{keyup:function(t){return e.inputValidate(t)}},model:{value:e.ruleForm.userName,callback:function(t){e.$set(e.ruleForm,"userName",t)},expression:"ruleForm.userName"}})],1),a("el-form-item",{attrs:{label:"密 码：",prop:"userPasswd"}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},nativeOn:{keyup:function(t){return e.inputValidate(t)}},model:{value:e.ruleForm.userPasswd,callback:function(t){e.$set(e.ruleForm,"userPasswd",t)},expression:"ruleForm.userPasswd"}})],1),a("el-form-item",{attrs:{label:"确认密码：",prop:"userConPasswd"}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},nativeOn:{keyup:function(t){return e.inputValidate(t)}},model:{value:e.ruleForm.userConPasswd,callback:function(t){e.$set(e.ruleForm,"userConPasswd",t)},expression:"ruleForm.userConPasswd"}})],1),a("el-form-item",{attrs:{label:"所在部门：",prop:"department"}},[a("el-cascader",{attrs:{options:e.treeData1,props:e.defaultProps2,"show-all-levels":!1},on:{change:e.handleChange},model:{value:e.ruleForm.department,callback:function(t){e.$set(e.ruleForm,"department",t)},expression:"ruleForm.department"}})],1),a("el-form-item",{attrs:{label:"真实姓名：",prop:"realName"}},[a("el-input",{model:{value:e.ruleForm.realName,callback:function(t){e.$set(e.ruleForm,"realName",t)},expression:"ruleForm.realName"}})],1),a("el-form-item",{attrs:{label:"联系方式：",prop:"phone"}},[a("el-input",{model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),a("el-form-item",{attrs:{label:"用户权限"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"","collapse-tags":"",placeholder:"选择用户权限"},model:{value:e.ruleForm.types,callback:function(t){e.$set(e.ruleForm,"types",t)},expression:"ruleForm.types"}},[a("el-option",{key:1,attrs:{label:"用户管理",value:1}}),a("el-option",{key:2,attrs:{label:"冻结模块",value:2}}),a("el-option",{key:3,attrs:{label:"盾构模块",value:3}}),a("el-option",{key:4,attrs:{label:"视频模块",value:4}}),a("el-option",{key:5,attrs:{label:"报表",value:5}}),a("el-option",{key:6,attrs:{label:"项目授权",value:6}}),a("el-option",{key:7,attrs:{label:"展板",value:7}}),a("el-option",{key:8,attrs:{label:"组织结构",value:8}}),a("el-option",{key:9,attrs:{label:"系统配置",value:9}}),a("el-option",{key:0,attrs:{label:"报警",value:0}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"diglogBtn",on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{staticClass:"diglogBtn",attrs:{type:"primary",loading:e.addBtnLoading},on:{click:e.addBtn}},[e._v("确定新增")])],1)]:"编辑账户"==e.title?[a("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm2",staticStyle:{width:"390px","font-size":"18px"},attrs:{model:e.ruleForm2,"status-icon":"",rules:e.rules2,"label-width":"1.2rem","label-position":"right"}},[a("el-form-item",{attrs:{label:"用户名：",prop:"userName"}},[a("el-input",{attrs:{disabled:""},model:{value:e.ruleForm2.userName,callback:function(t){e.$set(e.ruleForm2,"userName",t)},expression:"ruleForm2.userName"}})],1),a("el-form-item",{attrs:{label:"新密码：",prop:"userPasswd"}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},nativeOn:{keyup:function(t){return e.inputValidate(t)}},model:{value:e.ruleForm2.userPasswd,callback:function(t){e.$set(e.ruleForm2,"userPasswd",t)},expression:"ruleForm2.userPasswd"}})],1),a("el-form-item",{attrs:{label:"确认密码：",prop:"userConPasswd"}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},nativeOn:{keyup:function(t){return e.inputValidate(t)}},model:{value:e.ruleForm2.userConPasswd,callback:function(t){e.$set(e.ruleForm2,"userConPasswd",t)},expression:"ruleForm2.userConPasswd"}})],1),a("el-form-item",{attrs:{label:"所在部门：",prop:"department"}},[a("el-cascader",{staticStyle:{width:"100%"},attrs:{options:e.treeData1,props:e.defaultProps2,"show-all-levels":!1},on:{change:e.handleChange},model:{value:e.ruleForm2.department,callback:function(t){e.$set(e.ruleForm2,"department",t)},expression:"ruleForm2.department"}})],1),a("el-form-item",{attrs:{label:"真实姓名：",prop:"realName"}},[a("el-input",{model:{value:e.ruleForm2.realName,callback:function(t){e.$set(e.ruleForm2,"realName",t)},expression:"ruleForm2.realName"}})],1),a("el-form-item",{attrs:{label:"联系方式：",prop:"phone"}},[a("el-input",{model:{value:e.ruleForm2.phone,callback:function(t){e.$set(e.ruleForm2,"phone",t)},expression:"ruleForm2.phone"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"diglogBtn",on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{staticClass:"diglogBtn",attrs:{type:"primary",loading:e.editBtnLoading},on:{click:e.editClick}},[e._v("确定修改")])],1)]:"批量新增用户"==e.title?[a("div",{staticClass:"ruleForm3"},e._l(e.ruleForm3,function(t,i){return a("div",{key:i,staticClass:"ruleForm3Li"},[0==i?[a("div",[e._v(" 所在部门： "),a("el-cascader",{staticStyle:{width:"1.65rem",height:"0.3rem"},attrs:{options:e.treeData1,props:e.defaultProps2,"show-all-levels":!1,placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.ruleForm3[i].department,callback:function(t){e.$set(e.ruleForm3[i],"department",t)},expression:"ruleForm3[index].department"}})],1),a("div",[e._v(" 用户名： "),a("el-input",{staticStyle:{width:"1.65rem",height:"0.3rem"},model:{value:e.ruleForm3[i].userName,callback:function(t){e.$set(e.ruleForm3[i],"userName",t)},expression:"ruleForm3[index].userName"}})],1),a("div",[e._v(" 真实姓名： "),a("el-input",{staticStyle:{width:"1.65rem",height:"0.3rem"},model:{value:e.ruleForm3[i].realName,callback:function(t){e.$set(e.ruleForm3[i],"realName",t)},expression:"ruleForm3[index].realName"}})],1),a("div",[e._v(" 用户组： "),a("el-select",{staticStyle:{width:"1.65rem",height:"0.3rem"},attrs:{multiple:"","collapse-tags":"",placeholder:"选择用户权限"},model:{value:e.ruleForm3[i].types,callback:function(t){e.$set(e.ruleForm3[i],"types",t)},expression:"ruleForm3[index].types"}},[a("el-option",{key:1,attrs:{label:"用户管理",value:1}}),a("el-option",{key:2,attrs:{label:"冻结模块",value:2}}),a("el-option",{key:3,attrs:{label:"盾构模块",value:3}}),a("el-option",{key:4,attrs:{label:"视频模块",value:4}}),a("el-option",{key:5,attrs:{label:"报表",value:5}}),a("el-option",{key:6,attrs:{label:"项目授权",value:6}}),a("el-option",{key:7,attrs:{label:"展板",value:7}}),a("el-option",{key:8,attrs:{label:"组织结构",value:8}}),a("el-option",{key:9,attrs:{label:"系统配置",value:9}}),a("el-option",{key:0,attrs:{label:"报警",value:0}})],1)],1),a("div",[e._v(" 联系方式： "),a("el-input",{staticStyle:{width:"1.65rem",height:"0.3rem"},model:{value:e.ruleForm3[i].phone,callback:function(t){e.$set(e.ruleForm3[i],"phone",t)},expression:"ruleForm3[index].phone"}})],1),a("div",[a("i",{staticClass:"el-icon-close",on:{click:function(t){return e.delUserList(i)}}})])]:[a("div",[e._v(" 所在部门： "),a("el-cascader",{staticStyle:{width:"1.65rem",height:"0.3rem"},attrs:{options:e.treeData1,props:e.defaultProps2,"show-all-levels":!1,placeholder:"同上"},on:{change:e.handleChange},model:{value:e.ruleForm3[i].department,callback:function(t){e.$set(e.ruleForm3[i],"department",t)},expression:"ruleForm3[index].department"}})],1),a("div",[e._v(" 用户名： "),a("el-input",{staticStyle:{width:"1.65rem",height:"0.3rem"},model:{value:e.ruleForm3[i].userName,callback:function(t){e.$set(e.ruleForm3[i],"userName",t)},expression:"ruleForm3[index].userName"}})],1),a("div",[e._v(" 真实姓名： "),a("el-input",{staticStyle:{width:"1.65rem",height:"0.3rem"},model:{value:e.ruleForm3[i].realName,callback:function(t){e.$set(e.ruleForm3[i],"realName",t)},expression:"ruleForm3[index].realName"}})],1),a("div",[e._v(" 用户组： "),a("el-select",{staticStyle:{width:"1.65rem",height:"0.3rem"},attrs:{multiple:"","collapse-tags":"",placeholder:"同上"},model:{value:e.ruleForm3[i].types,callback:function(t){e.$set(e.ruleForm3[i],"types",t)},expression:"ruleForm3[index].types"}},[a("el-option",{key:1,attrs:{label:"用户管理",value:1}}),a("el-option",{key:2,attrs:{label:"冻结模块",value:2}}),a("el-option",{key:3,attrs:{label:"盾构模块",value:3}}),a("el-option",{key:4,attrs:{label:"视频模块",value:4}}),a("el-option",{key:5,attrs:{label:"报表",value:5}}),a("el-option",{key:6,attrs:{label:"项目授权",value:6}}),a("el-option",{key:7,attrs:{label:"展板",value:7}}),a("el-option",{key:8,attrs:{label:"组织结构",value:8}}),a("el-option",{key:9,attrs:{label:"系统配置",value:9}}),a("el-option",{key:0,attrs:{label:"报警",value:0}})],1)],1),a("div",[e._v(" 联系方式： "),a("el-input",{staticStyle:{width:"1.65rem",height:"0.3rem"},model:{value:e.ruleForm3[i].phone,callback:function(t){e.$set(e.ruleForm3[i],"phone",t)},expression:"ruleForm3[index].phone"}})],1),a("div",[a("i",{staticClass:"el-icon-close",on:{click:function(t){return e.delUserList(i)}}})])]],2)}),0),a("div",{staticClass:"addUserList",on:{click:e.addUserList}},[a("i",{staticClass:"el-icon-plus",staticStyle:{"margin-right":"10px"}}),e._v("新增 ")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"diglogBtn",on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{staticClass:"diglogBtn",attrs:{type:"primary",loading:e.addBtnsLoading},on:{click:e.addBtns}},[e._v("确定修改")])],1)]:"项目权限"==e.title?[a("div",{staticClass:"ruleForm"},[a("div",[e._v(e._s(e.projects))])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"diglogBtn",on:{click:function(t){e.dialogVisible=!1}}},[e._v("关 闭")])],1)]:"设置权限"==e.title?[a("div",{staticClass:"ruleForm4"},[a("div",{staticClass:"setTitle"},[e._v("权限模板")]),a("div",{staticClass:"setTag"},e._l(e.tags,function(t,i){return a("el-tag",{key:i,attrs:{closable:""},on:{click:function(a){return e.getTagData(t.id)},close:function(a){return e.handleClose(t.id)}}},[e._v(e._s(t.name))])}),1),a("div",{staticClass:"setTitle"},[e._v("用户权限")]),a("el-checkbox-group",{staticClass:"setCheckbox",model:{value:e.settingData,callback:function(t){e.settingData=t},expression:"settingData"}},[a("el-checkbox",{attrs:{label:1}},[e._v("用户管理")]),a("el-checkbox",{attrs:{label:2}},[e._v("冻结模块")]),a("el-checkbox",{attrs:{label:3}},[e._v("盾构模块")]),a("el-checkbox",{attrs:{label:4}},[e._v("视频模块")]),a("el-checkbox",{attrs:{label:5}},[e._v("报表")]),a("el-checkbox",{attrs:{label:6}},[e._v("项目授权")]),a("el-checkbox",{attrs:{label:7}},[e._v("展板")]),a("el-checkbox",{attrs:{label:8}},[e._v("组织结构")]),a("el-checkbox",{attrs:{label:9}},[e._v("系统配置")]),a("el-checkbox",{attrs:{label:0}},[e._v("报警")])],1),a("div",{staticStyle:{width:"100%",margintop:"10px"}},[a("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:e.setSetting}},[e._v("保存模板")])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"diglogBtn",on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{staticClass:"diglogBtn",attrs:{type:"primary",loading:e.addBtnsLoading},on:{click:e.addSetting}},[e._v("确定修改")])],1)]:"批量设置权限"==e.title?[a("div",{staticClass:"ruleForm4"},[a("div",{staticClass:"setTitle"},[e._v("权限模板")]),a("div",{staticClass:"setTag"},e._l(e.tags,function(t,i){return a("el-tag",{key:i,attrs:{closable:""},on:{click:function(a){return e.getTagData(t.id)},close:function(a){return e.handleClose(t.id)}}},[e._v(e._s(t.name))])}),1),a("div",{staticClass:"setTitle"},[e._v("用户权限")]),a("el-checkbox-group",{staticClass:"setCheckbox",model:{value:e.settingData,callback:function(t){e.settingData=t},expression:"settingData"}},[a("el-checkbox",{attrs:{label:1}},[e._v("用户管理")]),a("el-checkbox",{attrs:{label:2}},[e._v("冻结模块")]),a("el-checkbox",{attrs:{label:3}},[e._v("盾构模块")]),a("el-checkbox",{attrs:{label:4}},[e._v("视频模块")]),a("el-checkbox",{attrs:{label:5}},[e._v("报表")]),a("el-checkbox",{attrs:{label:6}},[e._v("项目授权")]),a("el-checkbox",{attrs:{label:7}},[e._v("展板")]),a("el-checkbox",{attrs:{label:8}},[e._v("组织结构")]),a("el-checkbox",{attrs:{label:9}},[e._v("系统配置")]),a("el-checkbox",{attrs:{label:10}},[e._v("系统配置")])],1),a("div",{staticStyle:{width:"100%",margintop:"10px"}},[a("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:e.setSetting}},[e._v("保存模板")])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"diglogBtn",on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{staticClass:"diglogBtn",attrs:{type:"primary",loading:e.addBtnsLoading},on:{click:e.addSettings}},[e._v("确定修改")])],1)]:e._e()],2)],1)},[],!1,null,null,null);t.default=l.exports},ae8c:function(e,t,a){},af9c:function(e,t,a){"use strict";a("5e4a")},b846:function(e,t,a){"use strict";var i=a("a293"),r=(a("3337"),a("5b12"),a("9b5f"),a("e3b5"),{name:"Popup",props:{realVarDataToTable:{type:Array}},watch:{realVarDataToTable:{handler:function(e,t){this.bindProperties.onClickPara&&this.showVarDataTable()},deep:!0}},data:function(){return{station:{id:"",name:"",stationGuid:""},graphCoverVisible:!1,bindProperties:{},graphFollowVisible:!1,graphFollowTop:"",graphFollowLeft:"",graphFollowWidth:300,showRealVarData:[]}},mounted:function(){var e=this;this.$comm.$on("showDialog",function(t){e.bindProperties=t.custom,e.showVarDataTable(),e.graphCoverVisible=!0}),this.$comm.$on("showPopover",function(t){e.setPopoverPosition()}),this.$comm.$on("hidePopover",function(){})},methods:{setPopoverPosition:function(){var e=document.body.offsetWidth,t=window.event.clientX;this.graphFollowTop=window.event.clientY+"px",e-t>this.graphFollowWidth+20?this.graphFollowLeft=t+"px":this.graphFollowLeft=t-this.graphFollowWidth+"px"},showVarDataTable:function(){var e=this;this.showRealVarData=[],this.showRealVarData=this.bindProperties.onClickPara.split(",").map(function(t){var a,r=Object(i.a)(e.realVarDataToTable);try{for(r.s();!(a=r.n()).done;){var s=a.value;if(t==s.varGuid)return s.varName=e.$coreData.g.getVarQualifiedName(t),s}}catch(e){r.e(e)}finally{r.f()}}),this.showRealVarData=this.showRealVarData.filter(function(e){return void 0!=e})}},filters:{alarmStateFilter:function(e){switch(e){case-1:return"初始状态";case 1:return"正常状态";case 2:return"预警状态";case 3:return"报警状态";case 4:return"报警确认";case 5:return"预警确认"}}}}),s=a("5d22"),n=Object(s.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Popup"},[a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.bindProperties.dialogTitle?e.bindProperties.dialogTitle:"实时数据",visible:e.graphCoverVisible,"append-to-body":!0,modal:!1,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(t){e.graphCoverVisible=t}}},["弹出表格"==e.bindProperties.operate?[a("el-table",{attrs:{data:e.showRealVarData,"header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},height:"500",border:!0}},[a("el-table-column",{attrs:{property:"varName",label:"设备/变量"}}),a("el-table-column",{attrs:{label:"值"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.value)+" ")]}}],null,!1,4272015574)}),a("el-table-column",{attrs:{label:"单位"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.varUnit?t.row.varUnit:"")+" ")]}}],null,!1,3074490520)}),a("el-table-column",{attrs:{label:"报警状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.alarmState<2?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(e._f("alarmStateFilter")(t.row.alarmState)))]):t.row.alarmState<4?a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(e._f("alarmStateFilter")(t.row.alarmState)))]):t.row.alarmState<6?a("el-tag",{attrs:{type:"danger"}},[e._v(e._s(e._f("alarmStateFilter")(t.row.alarmState)))]):e._e()]}}],null,!1,1040455828)}),a("el-table-column",{attrs:{label:"通信状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.commState?a("el-tag",{attrs:{type:"success"}},[e._v("正常")]):1!=t.row.commState?a("el-tag",{attrs:{type:"warning"}},[e._v("异常")]):e._e()]}}],null,!1,331595063)})],1)]:"弹出提示"==e.bindProperties.operate?[e._v(" 提示 ")]:"弹出图表"==e.bindProperties.operate?[e._v(" 图表 ")]:e._e()],2),a("el-popover",{style:{position:"fixed",top:e.graphFollowTop,left:e.graphFollowLeft},attrs:{title:"变量",width:e.graphFollowWidth},model:{value:e.graphFollowVisible,callback:function(t){e.graphFollowVisible=t},expression:"graphFollowVisible"}},[e._v(" "+e._s(e.bindProperties.varGuid)+" ")])],1)},[],!1,null,null,null);t.a=n.exports},c415:function(e,t,a){"use strict";a.r(t);a("e3b5"),a("16ca"),a("1d43"),a("5b12"),a("9b5f"),a("bf2f"),a("3bae");var i=a("3de1"),r=(a("27ae"),a("d447"),a("fc13"),{data:function(){return{mainPipeArr:[],pointArr:[],showPointVarArr:[],reportDate:"",datePickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()-864e4}}}},props:{projectInfo:Object},watch:{projectInfo:{handler:function(e){e.stationGuid&&this.getProjectData()},immediate:!0}},mounted:function(){},methods:{getDevAndVar:function(){return this.$axios({method:"get",headers:{},url:"/web/station/queryVirDevsVirVars",params:{stationGuid:this.projectInfo.stationGuid}})},getDevVarConfig:function(){return this.$axios({method:"get",headers:{},url:"web/project/queryProjectConfig",params:{projectId:this.projectInfo.id.split("-")[1],type:1}})},getProjectData:function(){var e=this;this.clearValue(),this.$axios.all([this.getDevAndVar(),this.getDevVarConfig()]).then(this.$axios.spread(function(t,a){var i,r;if(0==t.data.code&&t.data.info.virDevs&&t.data.info.virDevs.length>0&&(i=t.data.info.virDevs),0==a.data.code&&a.data.info&&(r=JSON.parse(a.data.info)),i&&r){for(var s,n={},o=0;o<i.length;o++){for(var l=0;l<i[o].virVars.length;l++)i[o].virVars[l].varGuid==r.goSide.varGuid&&(s=i[o]),i[o].virVars[l].value="";n[i[o].devGuid]=i[o]}if(s&&(s.virVars=[],r.goSide.varGuid&&s.virVars.push({varGuid:r.goSide.varGuid,varName:r.goSide.varName,value:""}),r.comeSide.varGuid&&s.virVars.push({varGuid:r.comeSide.varGuid,varName:r.comeSide.varName,value:""}),e.mainPipeArr.push(s)),r.leftSide){var c=n[r.leftSide];c.virVars=c.virVars.sort(e.characterCompare("varName")),e.mainPipeArr.push(c)}if(r.rightSide){var u=n[r.rightSide];u.virVars=u.virVars.sort(e.characterCompare("varName")),e.mainPipeArr.push(u)}e.mainPipeArr;var d=[],m=[];r.frontSide&&r.frontSide.forEach(function(e){d.push(n[e]),m.length<n[e].virVars.length&&(m=n[e].virVars)}),r.backSide&&r.backSide.forEach(function(e){d.push(n[e]),m.length<n[e].virVars.length&&(m=n[e].virVars)}),e.showPointVarArr=m,d=d.sort(e.characterCompare("devName"));for(var h=0;h<d.length;h++)d[h].virVars=d[h].virVars.sort(e.compare("varName"));e.pointArr=d,e.pointArr,e.showPointVarArr}})).catch(function(e,t){})},saveAndBack:function(){var e,t=this;if(this.mainPipeArr,this.pointArr,this.reportDate,this.reportDate){e=(e=this.reportDate.getTime()).toString().substring(0,10);var a={stationGuid:this.projectInfo.stationGuid,devs:[],time:e};this.mainPipeArr&&this.mainPipeArr.length>0&&(a.devs=a.devs.concat(this.mainPipeArr)),this.pointArr&&this.pointArr.length>0&&(a.devs=a.devs.concat(this.pointArr)),this.$axios({method:"post",headers:{},url:"/web/realdata/upDateVariableByManual",data:a}).then(function(e){0==e.data.code?(t.$showMessage("success","保存成功"),t.clearValue(),t.$emit("closeDrawer")):t.$showMessage("error",e.data.msg)}).catch(function(e){})}else this.$showMessage("error","清选择时间")},goBack:function(e){this.clearValue(),this.$emit("closeDrawer")},compare:function(e){return function(t,a){var i,r;return e?(i=t[e].toLowerCase(),r=a[e].toLowerCase()):(i=t.toLowerCase(),r=a.toLowerCase()),parseFloat(i.substring(0,i.length-1))-parseFloat(r.substring(0,r.length-1))}},characterCompare:function(e){return function(t,a){return t[e].length==a[e].length?t[e].localeCompare(a[e]):t[e].length-a[e].length}},isFloors:function(){var e=event.target,t=e.value.charAt(0);e.value=e.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/[^\d.]/g,"").replace(/^\./g,"").replace(/([0-9]+\.[0-9]{2})[0-9]*/,"$1"),"-"==t&&(e.value="-"+e.value)},clearValue:function(){for(var e=0;e<this.mainPipeArr.length;e++)for(var t=0;t<this.mainPipeArr[e].virVars.length;t++)this.mainPipeArr[e].virVars[t].value="";for(var a=0;a<this.pointArr.length;a++)for(var i=0;i<this.pointArr[a].virVars.length;i++)this.pointArr[a].virVars[i].value=""}}}),s=(a("59f9"),a("5d22")),n={data:function(){return{treeFilterText:"",treeProps:{children:"children",label:"name"},treeData:[],expandedKeys:[],projectInfo:{name:""},riskLevel:"#FFFFFF",oldProjectInfo:{},currentStep:0,stepsTime:[{name:"进场",time:"",step:0,space:0},{name:"打钻",time:"",step:1,space:0},{name:"冻结",time:"",step:2,space:0},{name:"开挖",time:"",step:3,space:0},{name:"结构",time:"",step:4,space:0},{name:"注浆",time:"",step:5,space:0},{name:"结束",time:"",step:6}],dataForm:{planStartTime:"",planEndTime:"",realityStartTime:"",realityEndTime:"",buildUnits:[{unitName:"",projectManager:"",contact:"",unitType:1}],mainContractorUnits:[{unitName:"",projectManager:"",contact:"",unitType:2}],supervisingUnits:[{unitName:"",projectManager:"",contact:"",unitType:3}],designUnits:[{unitName:"",projectManager:"",contact:"",unitType:4}],explorationUnits:[{unitName:"",projectManager:"",contact:"",unitType:5}],managers:[{name:"",contact:""}]},rightDivForbidden:!0,predefineColors:["#FFFFFF","#FFFF00","#FFC000","#FF0000"],drawerVisible:!1}},components:{ManualReportData:Object(s.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"manualReportData"},[a("div",{staticStyle:{display:"flex",width:"100%",height:"100%","flex-direction":"column"}},[a("div",{staticClass:"reportTitleDiv"},[a("p",{staticClass:"reportTitle"},[e._v(">"+e._s(e.projectInfo.name))]),a("p",[e._v("上报时间：")]),a("el-date-picker",{staticStyle:{"margin-right":"10px"},attrs:{type:"date",editable:!1,placeholder:"选择日期","picker-options":e.datePickerOptions},model:{value:e.reportDate,callback:function(t){e.reportDate=t},expression:"reportDate"}}),a("el-button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:e.saveAndBack}},[e._v("保存并返回")]),a("el-button",{attrs:{type:"primary"},on:{click:e.goBack}},[e._v("取消")])],1),a("div",{staticClass:"dataContent"},[e.mainPipeArr[0]&&e.mainPipeArr[0].virVars?a("div",{staticClass:"unitContainer"},e._l(e.mainPipeArr[0].virVars,function(t,i){return a("div",{key:t.varGuid,staticClass:"mainPipeDiv",class:{rightBorder:!e.mainPipeArr[1]&&!e.mainPipeArr[2]&&i==e.mainPipeArr[0].virVars.length-1}},[a("div",{staticClass:"mainPipeUnit"},[e._v(e._s(t.varName))]),a("div",{staticClass:"mainPipeUnit"},[a("el-input",{nativeOn:{keyup:function(t){return e.isFloors(t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)])}),0):e._e(),e.mainPipeArr[1]&&e.mainPipeArr[1].virVars?a("div",{staticClass:"unitContainer"},e._l(e.mainPipeArr[1].virVars,function(t,i){return a("div",{key:t.varGuid,staticClass:"mainPipeDiv",class:{rightBorder:!e.mainPipeArr[2]&&i==e.mainPipeArr[1].virVars.length-1}},[a("div",{staticClass:"mainPipeUnit"},[e._v(e._s(t.varName))]),a("div",{staticClass:"mainPipeUnit"},[a("el-input",{nativeOn:{keyup:function(t){return e.isFloors(t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)])}),0):e._e(),e.mainPipeArr[2]&&e.mainPipeArr[2].virVars?a("div",{staticClass:"unitContainer"},e._l(e.mainPipeArr[2].virVars,function(t,i){return a("div",{key:t.varGuid,staticClass:"mainPipeDiv",class:{rightBorder:i==e.mainPipeArr[2].virVars.length-1}},[a("div",{staticClass:"mainPipeUnit"},[e._v(e._s(t.varName))]),a("div",{staticClass:"mainPipeUnit"},[a("el-input",{nativeOn:{keyup:function(t){return e.isFloors(t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)])}),0):e._e(),a("div",{staticStyle:{width:"100%"}}),e._l(e.pointArr,function(t,i){return a("div",{key:t.devGuid,staticClass:"pointDiv",class:{rightBorder:i==e.pointArr.length-1}},[a("div",{staticClass:"pointUnitDiv"},[e._v(e._s(t.devName))]),e._l(e.showPointVarArr,function(i,r){return a("div",{key:t.devGuid+r,staticClass:"pointUnitDiv"},[t.virVars[r]?a("div",{staticClass:"pointNumDiv"},[e._v(" "+e._s(t.virVars[r].varName)+" ")]):e._e(),a("div",{staticClass:"pointNumDiv"},[t.virVars[r]?a("el-input",{staticStyle:{"line-height":"80%"},nativeOn:{keyup:function(t){return e.isFloors(t)}},model:{value:t.virVars[r].value,callback:function(a){e.$set(t.virVars[r],"value",a)},expression:"dev.virVars[index].value"}}):e._e()],1)])})],2)})],2)])])},[],!1,null,null,null).exports},created:function(){this.getProjectList()},watch:{treeFilterText:function(e){this.$refs.tree.filter(e)}},methods:{saveProjectInfo:function(){var e=this,t=this.dataForm.designUnits.concat(this.dataForm.buildUnits).concat(this.dataForm.mainContractorUnits).concat(this.dataForm.explorationUnits).concat(this.dataForm.supervisingUnits),a=[];for(var i in t)t[i].unitName&&a.push(t[i]);var r=[];for(var s in this.dataForm.managers)(this.dataForm.managers[s].name||this.dataForm.managers[s].contact)&&r.push(this.dataForm.managers[s]);if(this.dataForm.planStartTime&&this.dataForm.planEndTime){if(new Date(this.dataForm.planEndTime).getTime()-new Date(this.dataForm.planStartTime).getTime()<=0)return void this.$showMessage("error","计划开始时间不能大于结束时间")}else this.dataForm.planStartTime||(this.dataForm.planStartTime=""),this.dataForm.planEndTime||(this.dataForm.planEndTime="");for(var n=0;n<this.stepsTime.length;n++)this.stepsTime[n].time||(this.stepsTime[n].time="");var o={projectName:this.projectInfo.name,riskLevel:this.riskLevel,stationGuid:this.projectInfo.stationGuid,projectId:JSON.parse(this.projectInfo.id.split("-")[1]),allTime:JSON.stringify(this.stepsTime),realityStartTime:this.stepsTime[0].time,realityEndTime:this.stepsTime[this.stepsTime.length-1].time,planStartTime:this.dataForm.planStartTime,planEndTime:this.dataForm.planEndTime,unit:JSON.stringify(a),projectManager:JSON.stringify(r)};this.projectInfo.stationGuid||(o.stationGuid=""),this.fullscreenLoading=!0,this.$axios({method:"post",headers:{},url:"/web/project/updateProject",data:o}).then(function(t){var i=t.data;0==i.code?(e.$showMessage("success","修改成功！"),e.projectInfo.allTime=JSON.stringify(e.stepsTime),e.projectInfo.realityStartTime=e.stepsTime[0].time,e.projectInfo.realityEndTime=e.stepsTime[e.stepsTime.length-1].time,e.projectInfo.planStartTime=e.dataForm.planStartTime,e.projectInfo.planEndTime=e.dataForm.planEndTime,e.projectInfo.unit=a,e.projectInfo.projectManager=JSON.stringify(r),e.projectInfo.riskLevel=e.riskLevel):e.$showMessage("error",i.msg)}).catch(function(t){e.$showMessage("error",t)})},stepTimeChange:function(e){var t="",a="";switch(e){case 0:a=this.getAfterStep(e);break;case 1:t=this.stepsTime[0],a=this.getAfterStep(e);break;case 5:t=this.getBeforStep(e),a=this.stepsTime[6];break;case 6:t=this.getBeforStep(e);break;default:t=this.getBeforStep(e),a=this.getAfterStep(e)}return t&&new Date(this.stepsTime[e].time).getTime()-new Date(t.time).getTime()<0?(Object(i.j)("error",this.stepsTime[e].name+"时间不能小于"+t.name+"时间"),void(this.stepsTime[e].time="")):a&&new Date(this.stepsTime[e].time).getTime()-new Date(a.time).getTime()>0?(Object(i.j)("error",this.stepsTime[e].name+"时间不能大于"+a.name+"时间"),void(this.stepsTime[e].time="")):void this.doCurrentStep()},doCurrentStep:function(){for(var e=(new Date).getTime(),t=this.stepsTime.length-1;t>=0;t--)if(this.stepsTime[t].time&&e>=new Date(this.stepsTime[t].time).getTime()){this.currentStep=t+1;break}this.doSpaceTime()},doSpaceTime:function(){for(var e=0;e<this.stepsTime.length-1;e++)if(this.stepsTime[e].time){if(!(e<this.currentStep))break;if(e==this.currentStep-1){var t=Object(i.b)((new Date).getTime());this.stepsTime[e].space=Object(i.d)(this.stepsTime[e].time,t)}else this.stepsTime[e+1].time&&(this.stepsTime[e].space=Object(i.d)(this.stepsTime[e].time,this.stepsTime[e+1].time))}},getBeforStep:function(e){for(var t="",a=e-1;a>=0;a--)if(this.stepsTime[a].time){t=this.stepsTime[a];break}return t},getAfterStep:function(e){for(var t="",a=e+1;a<this.stepsTime.length;a++)if(this.stepsTime[a].time){t=this.stepsTime[a];break}return t},removeDomain:function(e,t){this.dataForm[e][t]&&this.dataForm[e].splice(t,1)},addDomain:function(e,t){var a;a="managers"==e?{name:"",contact:""}:{unitName:"",projectManager:"",contact:"",unitType:t},this.dataForm[e].push(a)},treeFilterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},getProjectList:function(){var e=this;this.$axios({method:"get",headers:{},url:"/web/project/queryGroupsProjects"}).then(function(t){var a=t.data,r=[];if(0==a.code){for(var s=!1,n=0;n<a.info.length;n++)1==a.info[n].type?(a.info[n].biaoqian="el-tree-city",61==a.info[n].id&&(s=!0)):(a.info[n].id="project-"+a.info[n].id,a.info[n].biaoqian="el-tree-project"),(2!=a.info[n].type||a.info[n].stationGuid)&&1!=a.info[n].id&&r.push(a.info[n]),1==a.info[n].pId&&e.expandedKeys.push(a.info[n].id);var o=Object(i.a)(r);s&&(o=Object(i.k)(o)),e.treeData=o}}).catch(function(e){Object(i.j)("error",e)})},deleteNoneProjectOrg:function(e){var t=[];e.forEach(function(e){t.push(e.pId)});for(var a=[],r=0;r<e.length;r++)2!=e[r].type&&-1==t.indexOf(e[r].id)||a.push(e[r]);if(a.length==e.length){this.treeData=Object(i.a)(a);for(var s=0;s<this.treeData.length;s++)this.expandedKeys.push(this.treeData[s].id)}else this.deleteNoneProjectOrg(a)},handleNodeClick:function(e,t){if(2==e.type){if(this.projectInfo.id==e.id)return;if(this.rightDivForbidden=!1,this.projectInfo=e,this.projectInfo.riskLevel?this.riskLevel=this.projectInfo.riskLevel:this.riskLevel="#FFFFFF",e.allTime){var a=JSON.parse(e.allTime);for(var i in a)a[i].space||(a[i].space=0);this.stepsTime=a;var r=e.unit,s={planStartTime:e.planStartTime,planEndTime:e.planEndTime,realityStartTime:"",realityEndTime:"",buildUnits:[{unitName:"",projectManager:"",contact:"",unitType:1}],mainContractorUnits:[{unitName:"",projectManager:"",contact:"",unitType:2}],supervisingUnits:[{unitName:"",projectManager:"",contact:"",unitType:3}],designUnits:[{unitName:"",projectManager:"",contact:"",unitType:4}],explorationUnits:[{unitName:"",projectManager:"",contact:"",unitType:5}],managers:[{name:"",contact:""}]};if(r.length>0)for(var n in r)switch(r[n].unitType){case 1:s.buildUnits.push(r[n]),""==s.buildUnits[0].unitName&&s.buildUnits.splice(0,1);break;case 2:s.mainContractorUnits.push(r[n]),""==s.mainContractorUnits[0].unitName&&s.mainContractorUnits.splice(0,1);break;case 3:s.supervisingUnits.push(r[n]),""==s.supervisingUnits[0].unitName&&s.supervisingUnits.splice(0,1);break;case 4:s.designUnits.push(r[n]),""==s.designUnits[0].unitName&&s.designUnits.splice(0,1);break;case 5:s.explorationUnits.push(r[n]),""==s.explorationUnits[0].unitName&&s.explorationUnits.splice(0,1)}e.projectManager&&JSON.parse(e.projectManager)&&JSON.parse(e.projectManager).length>1&&(s.managers=JSON.parse(e.projectManager)),this.dataForm=s,this.doCurrentStep()}else this.clearHtmlInfo()}else this.$refs.tree.setCurrentKey(null),this.projectInfo={name:"",id:""},this.rightDivForbidden=!0,this.clearHtmlInfo()},clearHtmlInfo:function(){this.currentStep=0,this.stepsTime=[{name:"进场",time:"",step:0,space:0},{name:"打钻",time:"",step:1,space:0},{name:"冻结",time:"",step:2,space:0},{name:"开挖",time:"",step:3,space:0},{name:"结构",time:"",step:4,space:0},{name:"注浆",time:"",step:5,space:0},{name:"结束",time:"",step:6}],this.dataForm={planStartTime:"",planEndTime:"",realityStartTime:"",realityEndTime:"",buildUnits:[{unitName:"",projectManager:"",contact:"",unitType:1}],mainContractorUnits:[{unitName:"",projectManager:"",contact:"",unitType:2}],supervisingUnits:[{unitName:"",projectManager:"",contact:"",unitType:3}],designUnits:[{unitName:"",projectManager:"",contact:"",unitType:4}],explorationUnits:[{unitName:"",projectManager:"",contact:"",unitType:5}],managers:[{name:"",contact:""}]}}}},o=(a("af9c"),Object(s.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"projectInfoForCustomer"},[a("div",{staticClass:"leftDiv"},[a("el-input",{attrs:{placeholder:"输入关键字搜索站点"},model:{value:e.treeFilterText,callback:function(t){e.treeFilterText=t},expression:"treeFilterText"}}),a("div",{staticClass:"treeDiv"},[a("el-tree",{ref:"tree",staticStyle:{background:"none"},attrs:{data:e.treeData,props:e.treeProps,"filter-node-method":e.treeFilterNode,"node-key":"id","default-expanded-keys":e.expandedKeys,"highlight-current":""},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[a("i",{class:r.biaoqian}),e._v(" "+e._s(i.label)+" ")])])}}])})],1)],1),a("div",{staticClass:"rightDiv",class:{forbidden:e.rightDivForbidden}},[a("div",{staticClass:"titleDiv"},[a("p",{staticClass:"title"},[e._v(">"+e._s(e.projectInfo.name))]),a("el-button",{attrs:{type:"primary",disabled:e.projectInfo.dataSource&&2!=e.projectInfo.dataSource},on:{click:function(t){e.drawerVisible=!0}}},[e._v("数据上报")])],1),a("div",{staticClass:"contentDiv"},[a("div",{staticClass:"topDiv"},[a("div",{staticClass:"spaceTimeDiv"},e._l(e.stepsTime,function(t,i){return a("label",{directives:[{name:"show",rawName:"v-show",value:i<6,expression:"index < 6"}],key:t.name+i+"space",class:{hide:0==t.space,textBlack:i==e.currentStep-1}},[e._v(e._s(t.space)+"天")])}),0),a("el-steps",{staticStyle:{width:"85%"},attrs:{active:e.currentStep,"align-center":""}},e._l(e.stepsTime,function(e,t){return a("el-step",{key:e.name+t,attrs:{title:e.name,description:e.time}})}),1),a("div",{staticClass:"stepTimeDiv"},e._l(e.stepsTime,function(t,i){return a("el-date-picker",{key:"dataPicker"+i,staticClass:"stepTimePicker",attrs:{placeholder:"选择时间",type:"date","value-format":"yyyy-MM-dd",align:"center"},on:{change:function(t){return e.stepTimeChange(i)}},model:{value:t.time,callback:function(a){e.$set(t,"time",a)},expression:"item.time"}})}),1)],1),a("div",{staticClass:"bottomDiv"},[a("el-form",{ref:"dataForm",staticClass:"demo-dynamic formClass",attrs:{model:e.dataForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"项目名称",prop:"projectName"}},[a("el-input",{attrs:{placeholder:"项目名称"},model:{value:e.projectInfo.name,callback:function(t){e.$set(e.projectInfo,"name",t)},expression:"projectInfo.name"}})],1),a("el-form-item",{attrs:{label:"风险等级"}},[a("el-color-picker",{staticStyle:{width:"100%"},attrs:{predefine:e.predefineColors},model:{value:e.riskLevel,callback:function(t){e.riskLevel=t},expression:"riskLevel"}})],1),a("el-form-item",{attrs:{label:"计划起止时间"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"planStartTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",editable:!1},model:{value:e.dataForm.planStartTime,callback:function(t){e.$set(e.dataForm,"planStartTime",t)},expression:"dataForm.planStartTime"}})],1)],1),a("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),a("el-col",{attrs:{span:11}},[a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"planEndTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"选择日期",type:"date","value-format":"yyyy-MM-dd",editable:!1},model:{value:e.dataForm.planEndTime,callback:function(t){e.$set(e.dataForm,"planEndTime",t)},expression:"dataForm.planEndTime"}})],1)],1)],1),e._l(e.dataForm.buildUnits,function(t,i){return a("el-form-item",{key:"buildUnits"+i,attrs:{label:0==i?"建设单位":"",prop:"buildUnits."+i+".unitName"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"单位名称"},model:{value:t.unitName,callback:function(a){e.$set(t,"unitName",a)},expression:"item.unitName"}}),0==i?a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.addDomain("buildUnits",1)}}},[e._v("新增")]):a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.removeDomain("buildUnits",i)}}},[e._v("删除")])],1)}),e._l(e.dataForm.mainContractorUnits,function(t,i){return a("el-form-item",{key:"mainContractorUnits"+i,attrs:{label:0==i?"总包单位":"",prop:"mainContractorUnits."+i+".unitName"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"单位名称"},model:{value:t.unitName,callback:function(a){e.$set(t,"unitName",a)},expression:"item.unitName"}}),0==i?a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.addDomain("mainContractorUnits",2)}}},[e._v("新增")]):a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.removeDomain("mainContractorUnits",i)}}},[e._v("删除")])],1)}),e._l(e.dataForm.supervisingUnits,function(t,i){return a("el-form-item",{key:"supervisingUnits"+i,attrs:{label:0==i?"监理单位":"",prop:"supervisingUnits."+i+".unitName"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"单位名称"},model:{value:t.unitName,callback:function(a){e.$set(t,"unitName",a)},expression:"item.unitName"}}),0==i?a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.addDomain("supervisingUnits",3)}}},[e._v("新增")]):a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.removeDomain("supervisingUnits",i)}}},[e._v("删除")])],1)}),e._l(e.dataForm.designUnits,function(t,i){return a("el-form-item",{key:"designUnits"+i,attrs:{label:0==i?"设计单位":"",prop:"designUnits."+i+".unitName"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"单位名称"},model:{value:t.unitName,callback:function(a){e.$set(t,"unitName",a)},expression:"item.unitName"}}),0==i?a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.addDomain("designUnits",4)}}},[e._v("新增")]):a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.removeDomain("designUnits",i)}}},[e._v("删除")])],1)}),e._l(e.dataForm.explorationUnits,function(t,i){return a("el-form-item",{key:"explorationUnits"+i,attrs:{label:0==i?"勘察单位":"",prop:"explorationUnits."+i+".unitName"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"单位名称"},model:{value:t.unitName,callback:function(a){e.$set(t,"unitName",a)},expression:"item.unitName"}}),0==i?a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.addDomain("explorationUnits",1)}}},[e._v("新增")]):a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.removeDomain("explorationUnits",i)}}},[e._v("删除")])],1)}),e._l(e.dataForm.managers,function(t,i){return a("el-form-item",{key:"managers"+i,attrs:{label:0==i?"项目经理":"",prop:"managers."+i+".name"}},[a("el-input",{staticStyle:{width:"20%"},attrs:{placeholder:"姓名"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}}),a("el-input",{staticStyle:{width:"55%","margin-left":"5%"},attrs:{placeholder:"联系方式"},model:{value:t.contact,callback:function(a){e.$set(t,"contact",a)},expression:"item.contact"}}),0==i?a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.addDomain("managers",1)}}},[e._v("新增")]):a("el-button",{staticStyle:{width:"15%","margin-left":"5%"},on:{click:function(t){return t.preventDefault(),e.removeDomain("managers",i)}}},[e._v("删除")])],1)})],2)],1),a("div",{staticClass:"btnDiv"},[a("el-button",{staticStyle:{width:"10%"},attrs:{type:"primary"},on:{click:function(t){return e.saveProjectInfo()}}},[e._v("保存信息")])],1)])]),a("el-drawer",{staticStyle:{position:"absolute"},attrs:{visible:e.drawerVisible,direction:"rtl",modal:!1,size:"100%",withHeader:!1},on:{"update:visible":function(t){e.drawerVisible=t}}},[a("ManualReportData",{ref:"manualReportDrawer",attrs:{projectInfo:e.projectInfo},on:{closeDrawer:function(t){e.drawerVisible=!1}}})],1)],1)},[],!1,null,null,null));t.default=o.exports},c72d:function(e,t,a){"use strict";a("6c78")},d39c:function(e,t,a){},d3a9:function(e,t,a){},d5a1:function(e,t,a){},df36:function(e,t,a){},e9c6:function(e,t,a){"use strict";a.d(t,"a",function(){return i});a("01e5"),a("e487"),a("27ae"),a("c2f8"),a("591f"),a("feb3"),a("7a3a");function i(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},f9cd:function(e,t,a){},ffb1:function(e,t,a){"use strict";a("313d")}}]);