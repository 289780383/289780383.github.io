function mxGraph(t,e,l,i){this.mouseListeners=null,this.renderHint=l,GE.IS_SVG?this.dialect=mxConstants.DIALECT_SVG:l==mxConstants.RENDERING_HINT_EXACT&&GE.IS_VML?this.dialect=mxConstants.DIALECT_VML:l==mxConstants.RENDERING_HINT_FASTEST?this.dialect=mxConstants.DIALECT_STRICTHTML:l==mxConstants.RENDERING_HINT_FASTER?this.dialect=mxConstants.DIALECT_PREFERHTML:this.dialect=mxConstants.DIALECT_MIXEDHTML,this.model=null!=e?e:new mxGraphModel,this.multiplicities=[],this.imageBundles=[],this.cellRenderer=this.createCellRenderer(),this.setSelectionModel(this.createSelectionModel()),this.setStylesheet(null!=i?i:this.createStylesheet()),this.view=this.createGraphView(),this.graphModelChangeListener=mxUtils.bind(this,function(t,e){this.graphModelChanged(e.getProperty("edit").changes)}),this.model.addListener(mxEvent.CHANGE,this.graphModelChangeListener),this.createHandlers(),null!=t&&this.init(t),this.view.revalidate()}mxGraph.prototype=new mxEventSource,mxGraph.prototype.constructor=mxGraph,mxGraph.prototype.mouseListeners=null,mxGraph.prototype.isMouseDown=!1,mxGraph.prototype.model=null,mxGraph.prototype.view=null,mxGraph.prototype.stylesheet=null,mxGraph.prototype.selectionModel=null,mxGraph.prototype.cellEditor=null,mxGraph.prototype.cellRenderer=null,mxGraph.prototype.multiplicities=null,mxGraph.prototype.renderHint=null,mxGraph.prototype.dialect=null,mxGraph.prototype.gridSize=10,mxGraph.prototype.gridEnabled=!0,mxGraph.prototype.portsEnabled=!0,mxGraph.prototype.nativeDblClickEnabled=!0,mxGraph.prototype.doubleTapEnabled=!0,mxGraph.prototype.doubleTapTimeout=500,mxGraph.prototype.doubleTapTolerance=25,mxGraph.prototype.lastTouchY=0,mxGraph.prototype.lastTouchY=0,mxGraph.prototype.lastTouchTime=0,mxGraph.prototype.tapAndHoldEnabled=!0,mxGraph.prototype.tapAndHoldDelay=500,mxGraph.prototype.tapAndHoldInProgress=!1,mxGraph.prototype.tapAndHoldValid=!1,mxGraph.prototype.initialTouchX=0,mxGraph.prototype.initialTouchY=0,mxGraph.prototype.tolerance=4,mxGraph.prototype.defaultOverlap=.5,mxGraph.prototype.defaultParent=null,mxGraph.prototype.alternateEdgeStyle=null,mxGraph.prototype.backgroundImage=null,mxGraph.prototype.preferPageSize=!1,mxGraph.prototype.pageFormat=GE.PAGE_FORMAT?new mxRectangle(0,0,GE.PAGE_FORMAT[0],GE.PAGE_FORMAT[1]):mxConstants.PAGE_FORMAT_DEFAULT,mxGraph.prototype.pageScale=1,mxGraph.prototype.enabled=!0,mxGraph.prototype.escapeEnabled=!0,mxGraph.prototype.invokesStopCellEditing=!0,mxGraph.prototype.enterStopsCellEditing=!1,mxGraph.prototype.useScrollbarsForPanning=!0,mxGraph.prototype.exportEnabled=!0,mxGraph.prototype.importEnabled=!0,mxGraph.prototype.cellsLocked=!1,mxGraph.prototype.cellsCloneable=!0,mxGraph.prototype.foldingEnabled=!0,mxGraph.prototype.cellsEditable=!0,mxGraph.prototype.cellsDeletable=!0,mxGraph.prototype.cellsMovable=!0,mxGraph.prototype.edgeLabelsMovable=!0,mxGraph.prototype.vertexLabelsMovable=!1,mxGraph.prototype.dropEnabled=!1,mxGraph.prototype.splitEnabled=!1,mxGraph.prototype.cellsResizable=!0,mxGraph.prototype.cellsBendable=!0,mxGraph.prototype.cellsSelectable=!0,mxGraph.prototype.cellsDisconnectable=!0,mxGraph.prototype.autoSizeCells=!1,mxGraph.prototype.autoSizeCellsOnAdd=!1,mxGraph.prototype.autoScroll=!0,mxGraph.prototype.ignoreScrollbars=!1,mxGraph.prototype.translateToScrollPosition=!1,mxGraph.prototype.timerAutoScroll=!1,mxGraph.prototype.allowAutoPanning=!1,mxGraph.prototype.autoExtend=!1,mxGraph.prototype.maximumGraphBounds=null,mxGraph.prototype.minimumGraphSize=null,mxGraph.prototype.minimumContainerSize=null,mxGraph.prototype.maximumContainerSize=null,mxGraph.prototype.resizeContainer=!1,mxGraph.prototype.border=0,mxGraph.prototype.keepEdgesInForeground=!1,mxGraph.prototype.keepEdgesInBackground=!1,mxGraph.prototype.allowNegativeCoordinates=!0,mxGraph.prototype.constrainChildren=!0,mxGraph.prototype.constrainRelativeChildren=!1,mxGraph.prototype.extendParents=!0,mxGraph.prototype.extendParentsOnAdd=!0,mxGraph.prototype.extendParentsOnMove=!1,mxGraph.prototype.recursiveResize=!1,mxGraph.prototype.collapseToPreferredSize=!0,mxGraph.prototype.zoomFactor=1.2,mxGraph.prototype.keepSelectionVisibleOnZoom=!1,mxGraph.prototype.centerZoom=!0,mxGraph.prototype.resetViewOnRootChange=!0,mxGraph.prototype.resetEdgesOnResize=!1,mxGraph.prototype.resetEdgesOnMove=!1,mxGraph.prototype.resetEdgesOnConnect=!0,mxGraph.prototype.allowLoops=!1,mxGraph.prototype.defaultLoopStyle=mxEdgeStyle.Loop,mxGraph.prototype.multigraph=!0,mxGraph.prototype.connectableEdges=!1,mxGraph.prototype.allowDanglingEdges=!0,mxGraph.prototype.cloneInvalidEdges=!1,mxGraph.prototype.disconnectOnMove=!0,mxGraph.prototype.labelsVisible=!0,mxGraph.prototype.htmlLabels=!1,mxGraph.prototype.swimlaneSelectionEnabled=!0,mxGraph.prototype.swimlaneNesting=!0,mxGraph.prototype.swimlaneIndicatorColorAttribute=mxConstants.STYLE_FILLCOLOR,mxGraph.prototype.imageBundles=null,mxGraph.prototype.minFitScale=.1,mxGraph.prototype.maxFitScale=8,mxGraph.prototype.panDx=0,mxGraph.prototype.panDy=0,mxGraph.prototype.collapsedImage=new mxImage(GE.imageBasePath+"/collapsed.gif",9,9),mxGraph.prototype.expandedImage=new mxImage(GE.imageBasePath+"/expanded.gif",9,9),mxGraph.prototype.warningImage=new mxImage(GE.imageBasePath+"/warning"+(GE.IS_MAC?".png":".gif"),16,16),mxGraph.prototype.alreadyConnectedResource="none"!=GE.language?"alreadyConnected":"",mxGraph.prototype.containsValidationErrorsResource="none"!=GE.language?"containsValidationErrors":"",mxGraph.prototype.collapseExpandResource="none"!=GE.language?"collapse-expand":"",mxGraph.prototype.init=function(t){this.container=t,this.cellEditor=this.createCellEditor(),this.view.init(),this.sizeDidChange(),mxEvent.addListener(t,"mouseleave",mxUtils.bind(this,function(){null!=this.tooltipHandler&&this.tooltipHandler.hide()}))},mxGraph.prototype.createHandlers=function(){this.tooltipHandler=this.createTooltipHandler(),this.tooltipHandler.setEnabled(!1),this.selectionCellsHandler=this.createSelectionCellsHandler(),this.connectionHandler=this.createConnectionHandler(),this.connectionHandler.setEnabled(!1),this.graphHandler=this.createGraphHandler(),this.panningHandler=this.createPanningHandler(),this.panningHandler.panningEnabled=!1,this.popupMenuHandler=this.createPopupMenuHandler()},mxGraph.prototype.createTooltipHandler=function(){return new mxTooltipHandler(this)},mxGraph.prototype.createSelectionCellsHandler=function(){return new mxSelectionCellsHandler(this)},mxGraph.prototype.createConnectionHandler=function(){return new mxConnectionHandler(this)},mxGraph.prototype.createGraphHandler=function(){return new mxGraphHandler(this)},mxGraph.prototype.createPanningHandler=function(){return new mxPanningHandler(this)},mxGraph.prototype.createPopupMenuHandler=function(){return new mxPopupMenuHandler(this)},mxGraph.prototype.createSelectionModel=function(){return new mxGraphSelectionModel(this)},mxGraph.prototype.createStylesheet=function(){return new mxStylesheet},mxGraph.prototype.createGraphView=function(){return new mxGraphView(this)},mxGraph.prototype.createCellRenderer=function(){return new mxCellRenderer},mxGraph.prototype.createCellEditor=function(){return new mxCellEditor(this)},mxGraph.prototype.getModel=function(){return this.model},mxGraph.prototype.getView=function(){return this.view},mxGraph.prototype.getStylesheet=function(){return this.stylesheet},mxGraph.prototype.setStylesheet=function(t){this.stylesheet=t},mxGraph.prototype.getSelectionModel=function(){return this.selectionModel},mxGraph.prototype.setSelectionModel=function(t){this.selectionModel=t},mxGraph.prototype.getSelectionCellsForChanges=function(t,e){for(var l=new mxDictionary,i=[],n=mxUtils.bind(this,function(t){if(!l.get(t)&&this.model.contains(t))if(this.model.isEdge(t)||this.model.isVertex(t))l.put(t,!0),i.push(t);else for(var e=this.model.getChildCount(t),s=0;s<e;s++)n(this.model.getChildAt(t,s))}),s=0;s<t.length;s++){var o=t[s];if(o.constructor!=mxRootChange&&(null==e||!e(o))){var r=null;o instanceof mxChildChange?r=o.child:null!=o.cell&&o.cell instanceof mxCell&&(r=o.cell),null!=r&&n(r)}}return i},mxGraph.prototype.graphModelChanged=function(t){for(var e=0;e<t.length;e++)this.processChange(t[e]);this.updateSelection(),this.view.validate(),this.sizeDidChange()},mxGraph.prototype.updateSelection=function(){for(var t=this.getSelectionCells(),e=[],l=0;l<t.length;l++)if(this.model.contains(t[l])&&this.isCellVisible(t[l]))for(var i=this.model.getParent(t[l]);null!=i&&i!=this.view.currentRoot;){if(this.isCellCollapsed(i)||!this.isCellVisible(i)){e.push(t[l]);break}i=this.model.getParent(i)}else e.push(t[l]);this.removeSelectionCells(e)},mxGraph.prototype.processChange=function(t){if(t instanceof mxRootChange)this.clearSelection(),this.setDefaultParent(null),this.removeStateForCell(t.previous),this.resetViewOnRootChange&&(this.view.scale=1,this.view.translate.x=0,this.view.translate.y=0),this.fireEvent(new mxEventObject(mxEvent.ROOT));else if(t instanceof mxChildChange){var e=this.model.getParent(t.child);this.view.invalidate(t.child,!0,!0),this.model.contains(e)&&!this.isCellCollapsed(e)||(this.view.invalidate(t.child,!0,!0),this.removeStateForCell(t.child),this.view.currentRoot==t.child&&this.home()),e!=t.previous&&(null!=e&&this.view.invalidate(e,!1,!1),null!=t.previous&&this.view.invalidate(t.previous,!1,!1))}else if(t instanceof mxTerminalChange||t instanceof mxGeometryChange)(t instanceof mxTerminalChange||null==t.previous&&null!=t.geometry||null!=t.previous&&!t.previous.equals(t.geometry))&&this.view.invalidate(t.cell);else if(t instanceof mxValueChange)this.view.invalidate(t.cell,!1,!1);else if(t instanceof mxStyleChange){this.view.invalidate(t.cell,!0,!0);var l=this.view.getState(t.cell);null!=l&&(l.invalidStyle=!0)}else null!=t.cell&&t.cell instanceof mxCell&&this.removeStateForCell(t.cell)},mxGraph.prototype.removeStateForCell=function(t){for(var e=this.model.getChildCount(t),l=0;l<e;l++)this.removeStateForCell(this.model.getChildAt(t,l));this.view.invalidate(t,!1,!0),this.view.removeState(t)},mxGraph.prototype.addCellOverlay=function(t,e){null==t.overlays&&(t.overlays=[]),t.overlays.push(e);var l=this.view.getState(t);return null!=l&&this.cellRenderer.redraw(l),this.fireEvent(new mxEventObject(mxEvent.ADD_OVERLAY,"cell",t,"overlay",e)),e},mxGraph.prototype.getCellOverlays=function(t){return t.overlays},mxGraph.prototype.removeCellOverlay=function(t,e){if(null==e)this.removeCellOverlays(t);else{var l=mxUtils.indexOf(t.overlays,e);if(l>=0){t.overlays.splice(l,1),0==t.overlays.length&&(t.overlays=null);var i=this.view.getState(t);null!=i&&this.cellRenderer.redraw(i),this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",t,"overlay",e))}else e=null}return e},mxGraph.prototype.removeCellOverlays=function(t){var e=t.overlays;if(null!=e){t.overlays=null;var l=this.view.getState(t);null!=l&&this.cellRenderer.redraw(l);for(var i=0;i<e.length;i++)this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",t,"overlay",e[i]))}return e},mxGraph.prototype.clearCellOverlays=function(t){t=null!=t?t:this.model.getRoot(),this.removeCellOverlays(t);for(var e=this.model.getChildCount(t),l=0;l<e;l++){var i=this.model.getChildAt(t,l);this.clearCellOverlays(i)}},mxGraph.prototype.setCellWarning=function(t,e,l,i){if(null!=e&&e.length>0){l=null!=l?l:this.warningImage;var n=new mxCellOverlay(l,"<font color=red>"+e+"</font>");return i&&n.addListener(mxEvent.CLICK,mxUtils.bind(this,function(e,l){this.isEnabled()&&this.setSelectionCell(t)})),this.addCellOverlay(t,n)}return this.removeCellOverlays(t),null},mxGraph.prototype.startEditing=function(t){this.startEditingAtCell(null,t)},mxGraph.prototype.startEditingAtCell=function(t,e){null!=e&&mxEvent.isMultiTouchEvent(e)||(null==t&&(null==(t=this.getSelectionCell())||this.isCellEditable(t)||(t=null)),null!=t&&(this.fireEvent(new mxEventObject(mxEvent.START_EDITING,"cell",t,"event",e)),this.cellEditor.startEditing(t,e),this.fireEvent(new mxEventObject(mxEvent.EDITING_STARTED,"cell",t,"event",e))))},mxGraph.prototype.getEditingValue=function(t,e){return this.convertValueToString(t)},mxGraph.prototype.stopEditing=function(t){this.cellEditor.stopEditing(t),this.fireEvent(new mxEventObject(mxEvent.EDITING_STOPPED,"cancel",t))},mxGraph.prototype.labelChanged=function(t,e,l){this.model.beginUpdate();try{var i=t.value;this.cellLabelChanged(t,e,this.isAutoSizeCell(t)),this.fireEvent(new mxEventObject(mxEvent.LABEL_CHANGED,"cell",t,"value",e,"old",i,"event",l))}finally{this.model.endUpdate()}return t},mxGraph.prototype.bindPropertiesChanged=function(t,e,l){this.model.beginUpdate();try{var i=t.bindProperties;this.cellBindPropertiesChanged(t,e,this.isAutoSizeCell(t)),this.fireEvent(new mxEventObject(mxEvent.VAR_GUID_CHANGED,"cell",t,"bindProperties",e,"old",i,"event",l))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellLabelChanged=function(t,e,l){this.model.beginUpdate();try{this.model.setValue(t,e),l&&this.cellSizeUpdated(t,!1)}finally{this.model.endUpdate()}},mxGraph.prototype.cellBindPropertiesChanged=function(t,e,l){this.model.beginUpdate();try{this.model.setBindProperties(t,e),l&&this.cellSizeUpdated(t,!1)}finally{this.model.endUpdate()}},mxGraph.prototype.escape=function(t){this.fireEvent(new mxEventObject(mxEvent.ESCAPE,"event",t))},mxGraph.prototype.click=function(t){var e=t.getEvent(),l=t.getCell(),i=new mxEventObject(mxEvent.CLICK,"event",e,"cell",l);if(t.isConsumed()&&i.consume(),this.fireEvent(i),this.isEnabled()&&!mxEvent.isConsumed(e)&&!i.isConsumed()){if(null!=l){if(this.isTransparentClickEvent(e)){var n=!1,s=this.getCellAt(t.graphX,t.graphY,null,null,null,mxUtils.bind(this,function(t){var e=this.isCellSelected(t.cell);return!(n=n||e)||e||t.cell!=l&&this.model.isAncestor(t.cell,l)}));null!=s&&(l=s)}}else if(this.isSwimlaneSelectionEnabled()&&!(null==(l=this.getSwimlaneAt(t.getGraphX(),t.getGraphY()))||this.isToggleEvent(e)&&mxEvent.isAltDown(e))){for(var o=l,r=[];null!=o;){o=this.model.getParent(o);var a=this.view.getState(o);this.isSwimlane(o)&&null!=a&&r.push(o)}if(r.length>0){(r=r.reverse()).splice(0,0,l),r.push(l);for(var h=0;h<r.length-1;h++)this.isCellSelected(r[h])&&(l=r[this.isToggleEvent(e)?h:h+1])}}null!=l?this.selectCellForEvent(l,e):this.isToggleEvent(e)||this.clearSelection()}},mxGraph.prototype.isSiblingSelected=function(t){for(var e=this.model,l=e.getParent(t),i=e.getChildCount(l),n=0;n<i;n++){var s=e.getChildAt(l,n);if(t!=s&&this.isCellSelected(s))return!0}return!1},mxGraph.prototype.dblClick=function(t,e){var l=new mxEventObject(mxEvent.DOUBLE_CLICK,"event",t,"cell",e);this.fireEvent(l),!this.isEnabled()||mxEvent.isConsumed(t)||l.isConsumed()||null==e||!this.isCellEditable(e)||this.isEditing(e)||(this.startEditingAtCell(e,t),mxEvent.consume(t))},mxGraph.prototype.tapAndHold=function(t){var e=t.getEvent(),l=new mxEventObject(mxEvent.TAP_AND_HOLD,"event",e,"cell",t.getCell());if(this.fireEvent(l),l.isConsumed()&&(this.panningHandler.panningTrigger=!1),this.isEnabled()&&!mxEvent.isConsumed(e)&&!l.isConsumed()&&this.connectionHandler.isEnabled()){var i=this.view.getState(this.connectionHandler.marker.getCell(t));null!=i&&(this.connectionHandler.marker.currentColor=this.connectionHandler.marker.validColor,this.connectionHandler.marker.markedState=i,this.connectionHandler.marker.mark(),this.connectionHandler.first=new mxPoint(t.getGraphX(),t.getGraphY()),this.connectionHandler.edgeState=this.connectionHandler.createEdgeState(t),this.connectionHandler.previous=i,this.connectionHandler.fireEvent(new mxEventObject(mxEvent.START,"state",this.connectionHandler.previous)))}},mxGraph.prototype.scrollPointToVisible=function(t,e,l,i){if(this.timerAutoScroll||!this.ignoreScrollbars&&!mxUtils.hasScrollbars(this.container))this.allowAutoPanning&&!this.panningHandler.isActive()&&(null==this.panningManager&&(this.panningManager=this.createPanningManager()),this.panningManager.panTo(t+this.panDx,e+this.panDy));else{var n=this.container;if(i=null!=i?i:20,t>=n.scrollLeft&&e>=n.scrollTop&&t<=n.scrollLeft+n.clientWidth&&e<=n.scrollTop+n.clientHeight){var s=n.scrollLeft+n.clientWidth-t;if(s<i){var o=n.scrollLeft;if(n.scrollLeft+=i-s,l&&o==n.scrollLeft){if(this.dialect==mxConstants.DIALECT_SVG){var r=this.view.getDrawPane().ownerSVGElement,a=this.container.scrollWidth+i-s;r.style.width=a+"px"}else{a=Math.max(n.clientWidth,n.scrollWidth)+i-s;this.view.getCanvas().style.width=a+"px"}n.scrollLeft+=i-s}}else(s=t-n.scrollLeft)<i&&(n.scrollLeft-=i-s);var h=n.scrollTop+n.clientHeight-e;if(h<i){o=n.scrollTop;if(n.scrollTop+=i-h,o==n.scrollTop&&l){if(this.dialect==mxConstants.DIALECT_SVG){r=this.view.getDrawPane().ownerSVGElement;var p=this.container.scrollHeight+i-h;r.style.height=p+"px"}else{p=Math.max(n.clientHeight,n.scrollHeight)+i-h;this.view.getCanvas().style.height=p+"px"}n.scrollTop+=i-h}}else(h=e-n.scrollTop)<i&&(n.scrollTop-=i-h)}}},mxGraph.prototype.createPanningManager=function(){return new mxPanningManager(this)},mxGraph.prototype.getBorderSizes=function(){var t=mxUtils.getCurrentStyle(this.container);return new mxRectangle(mxUtils.parseCssNumber(t.paddingLeft)+("none"!=t.borderLeftStyle?mxUtils.parseCssNumber(t.borderLeftWidth):0),mxUtils.parseCssNumber(t.paddingTop)+("none"!=t.borderTopStyle?mxUtils.parseCssNumber(t.borderTopWidth):0),mxUtils.parseCssNumber(t.paddingRight)+("none"!=t.borderRightStyle?mxUtils.parseCssNumber(t.borderRightWidth):0),mxUtils.parseCssNumber(t.paddingBottom)+("none"!=t.borderBottomStyle?mxUtils.parseCssNumber(t.borderBottomWidth):0))},mxGraph.prototype.getPreferredPageSize=function(t,e,l){var i=this.view.translate,n=this.pageFormat,s=this.pageScale,o=new mxRectangle(0,0,Math.ceil(n.width*s),Math.ceil(n.height*s));return new mxRectangle(0,0,o.width+2+i.x,o.height+2+i.y)},mxGraph.prototype.fit=function(t,e,l,i,n,s,o){if(null!=this.container){t=null!=t?t:this.getBorder(),e=null!=e&&e,l=null!=l?l:0,i=null==i||i,n=null!=n&&n,s=null!=s&&s;var r=this.getBorderSizes(),a=this.container.offsetWidth-r.x-r.width-1,h=null!=o?o:this.container.offsetHeight-r.y-r.height-1,p=this.view.getGraphBounds();if(p.width>0&&p.height>0){e&&null!=p.x&&null!=p.y&&((p=p.clone()).width+=p.x,p.height+=p.y,p.x=0,p.y=0);var u=this.view.scale,m=p.width/u,d=p.height/u;null!=this.backgroundImage&&(m=Math.max(m,this.backgroundImage.width-p.x/u),d=Math.max(d,this.backgroundImage.height-p.y/u));var c=(e?t:2*t)+l+1;a-=c,h-=c;var g=n?h/d:s?a/m:Math.min(a/m,h/d);if(null!=this.minFitScale&&(g=Math.max(g,this.minFitScale)),null!=this.maxFitScale&&(g=Math.min(g,this.maxFitScale)),!i)return g;if(e)this.view.scale!=g&&this.view.setScale(g);else if(mxUtils.hasScrollbars(this.container)){this.view.setScale(g);var x=this.getGraphBounds();null!=x.x&&(this.container.scrollLeft=x.x),null!=x.y&&(this.container.scrollTop=x.y)}else{var v=null!=p.x?Math.floor(this.view.translate.x-p.x/u+t/g+l/2):t,C=null!=p.y?Math.floor(this.view.translate.y-p.y/u+t/g+l/2):t;this.view.scaleAndTranslate(g,v,C)}}}return this.view.scale},mxGraph.prototype.sizeDidChange=function(){var t=this.getGraphBounds();if(null!=this.container){var e=this.getBorder(),l=Math.max(0,t.x)+t.width+2*e,i=Math.max(0,t.y)+t.height+2*e;if(null!=this.minimumContainerSize&&(l=Math.max(l,this.minimumContainerSize.width),i=Math.max(i,this.minimumContainerSize.height)),this.resizeContainer&&this.doResizeContainer(l,i),this.preferPageSize){var n=this.getPreferredPageSize(t,Math.max(1,l),Math.max(1,i));null!=n&&(l=n.width*this.view.scale,i=n.height*this.view.scale)}if(null!=this.minimumGraphSize&&(l=Math.max(l,this.minimumGraphSize.width*this.view.scale),i=Math.max(i,this.minimumGraphSize.height*this.view.scale)),l=Math.ceil(l),i=Math.ceil(i),this.dialect==mxConstants.DIALECT_SVG){var s=this.view.getDrawPane().ownerSVGElement;null!=s&&(s.style.minWidth=Math.max(1,l)+"px",s.style.minHeight=Math.max(1,i)+"px",s.style.width="100%",s.style.height="100%")}else this.view.canvas.style.minWidth=Math.max(1,l)+"px",this.view.canvas.style.minHeight=Math.max(1,i)+"px"}this.fireEvent(new mxEventObject(mxEvent.SIZE,"bounds",t))},mxGraph.prototype.doResizeContainer=function(t,e){null!=this.maximumContainerSize&&(t=Math.min(this.maximumContainerSize.width,t),e=Math.min(this.maximumContainerSize.height,e)),this.container.style.width=Math.ceil(t)+"px",this.container.style.height=Math.ceil(e)+"px"},mxGraph.prototype.getCurrentCellStyle=function(t,e){var l=e?null:this.view.getState(t);return null!=l?l.style:this.getCellStyle(t)},mxGraph.prototype.getCellStyle=function(t){var e=this.model.getStyle(t),l=null;return l=this.model.isEdge(t)?this.stylesheet.getDefaultEdgeStyle():this.stylesheet.getDefaultVertexStyle(),null!=e&&(l=this.postProcessCellStyle(this.stylesheet.getCellStyle(e,l))),null==l&&(l=new Object),l},mxGraph.prototype.postProcessCellStyle=function(t){if(null!=t){var e=t[mxConstants.STYLE_IMAGE],l=this.getImageFromBundles(e);if(null!=l?t[mxConstants.STYLE_IMAGE]=l:l=e,null!=l&&"data:image/"==l.substring(0,11)){if("data:image/svg+xml,<"==l.substring(0,20))l=l.substring(0,19)+encodeURIComponent(l.substring(19));else if("data:image/svg+xml,%3C"!=l.substring(0,22)){var i=l.indexOf(",");i>0&&";base64,"!=l.substring(i-7,i+1)&&(l=l.substring(0,i)+";base64,"+l.substring(i+1))}t[mxConstants.STYLE_IMAGE]=l}}return t},mxGraph.prototype.setCellStyle=function(t,e){if(null!=(e=e||this.getSelectionCells())){this.model.beginUpdate();try{for(var l=0;l<e.length;l++)this.model.setStyle(e[l],t)}finally{this.model.endUpdate()}}},mxGraph.prototype.toggleCellStyle=function(t,e,l){return l=l||this.getSelectionCell(),this.toggleCellStyles(t,e,[l])},mxGraph.prototype.toggleCellStyles=function(t,e,l){e=null!=e&&e;var i=null;if(null!=(l=l||this.getSelectionCells())&&l.length>0){var n=this.getCurrentCellStyle(l[0]);i=mxUtils.getValue(n,t,e)?0:1,this.setCellStyles(t,i,l)}return i},mxGraph.prototype.setCellStyles=function(t,e,l){l=l||this.getSelectionCells(),mxUtils.setCellStyles(this.model,l,t,e)},mxGraph.prototype.toggleCellStyleFlags=function(t,e,l){this.setCellStyleFlags(t,e,null,l)},mxGraph.prototype.setCellStyleFlags=function(t,e,l,i){if(null!=(i=i||this.getSelectionCells())&&i.length>0){if(null==l){var n=this.getCurrentCellStyle(i[0]);l=!((parseInt(n[t]||0)&e)==e)}mxUtils.setCellStyleFlags(this.model,i,t,e,l)}},mxGraph.prototype.alignCells=function(t,e,l){if(null==e&&(e=this.getSelectionCells()),null!=e&&e.length>1){if(null==l)for(var i=0;i<e.length;i++){if(null!=(s=this.view.getState(e[i]))&&!this.model.isEdge(e[i]))if(null==l){if(t==mxConstants.ALIGN_CENTER){l=s.x+s.width/2;break}if(t==mxConstants.ALIGN_RIGHT)l=s.x+s.width;else if(t==mxConstants.ALIGN_TOP)l=s.y;else{if(t==mxConstants.ALIGN_MIDDLE){l=s.y+s.height/2;break}l=t==mxConstants.ALIGN_BOTTOM?s.y+s.height:s.x}}else l=t==mxConstants.ALIGN_RIGHT?Math.max(l,s.x+s.width):t==mxConstants.ALIGN_TOP?Math.min(l,s.y):t==mxConstants.ALIGN_BOTTOM?Math.max(l,s.y+s.height):Math.min(l,s.x)}if(null!=l){var n=this.view.scale;this.model.beginUpdate();try{for(i=0;i<e.length;i++){var s;if(null!=(s=this.view.getState(e[i]))){var o=this.getCellGeometry(e[i]);null==o||this.model.isEdge(e[i])||(o=o.clone(),t==mxConstants.ALIGN_CENTER?o.x+=(l-s.x-s.width/2)/n:t==mxConstants.ALIGN_RIGHT?o.x+=(l-s.x-s.width)/n:t==mxConstants.ALIGN_TOP?o.y+=(l-s.y)/n:t==mxConstants.ALIGN_MIDDLE?o.y+=(l-s.y-s.height/2)/n:t==mxConstants.ALIGN_BOTTOM?o.y+=(l-s.y-s.height)/n:o.x+=(l-s.x)/n,this.resizeCell(e[i],o))}}this.fireEvent(new mxEventObject(mxEvent.ALIGN_CELLS,"align",t,"cells",e))}finally{this.model.endUpdate()}}}return e},mxGraph.prototype.flipEdge=function(t){if(null!=t&&null!=this.alternateEdgeStyle){this.model.beginUpdate();try{var e=this.model.getStyle(t);null==e||0==e.length?this.model.setStyle(t,this.alternateEdgeStyle):this.model.setStyle(t,null),this.resetEdge(t),this.fireEvent(new mxEventObject(mxEvent.FLIP_EDGE,"edge",t))}finally{this.model.endUpdate()}}return t},mxGraph.prototype.addImageBundle=function(t){this.imageBundles.push(t)},mxGraph.prototype.removeImageBundle=function(t){for(var e=[],l=0;l<this.imageBundles.length;l++)this.imageBundles[l]!=t&&e.push(this.imageBundles[l]);this.imageBundles=e},mxGraph.prototype.getImageFromBundles=function(t){if(null!=t)for(var e=0;e<this.imageBundles.length;e++){var l=this.imageBundles[e].getImage(t);if(null!=l)return l}return null},mxGraph.prototype.orderCells=function(t,e){null==e&&(e=mxUtils.sortCells(this.getSelectionCells(),!0)),this.model.beginUpdate();try{this.cellsOrdered(e,t),this.fireEvent(new mxEventObject(mxEvent.ORDER_CELLS,"back",t,"cells",e))}finally{this.model.endUpdate()}return e},mxGraph.prototype.cellsOrdered=function(t,e){if(null!=t){this.model.beginUpdate();try{for(var l=0;l<t.length;l++){var i=this.model.getParent(t[l]);e?this.model.add(i,t[l],l):this.model.add(i,t[l],this.model.getChildCount(i)-1)}this.fireEvent(new mxEventObject(mxEvent.CELLS_ORDERED,"back",e,"cells",t))}finally{this.model.endUpdate()}}},mxGraph.prototype.groupCells=function(t,e,l){null==l&&(l=mxUtils.sortCells(this.getSelectionCells(),!0)),l=this.getCellsForGroup(l),null==t&&(t=this.createGroupCell(l));var i=this.getBoundsForGroup(t,l,e);if(l.length>0&&null!=i){var n=this.model.getParent(t);null==n&&(n=this.model.getParent(l[0])),this.model.beginUpdate();try{null==this.getCellGeometry(t)&&this.model.setGeometry(t,new mxGeometry);var s=this.model.getChildCount(n);this.cellsAdded([t],n,s,null,null,!1,!1,!1),s=this.model.getChildCount(t),this.cellsAdded(l,t,s,null,null,!1,!1,!1),this.cellsMoved(l,-i.x,-i.y,!1,!1,!1),this.cellsResized([t],[i],!1),this.fireEvent(new mxEventObject(mxEvent.GROUP_CELLS,"group",t,"border",e,"cells",l))}finally{this.model.endUpdate()}}return t},mxGraph.prototype.getCellsForGroup=function(t){var e=[];if(null!=t&&t.length>0){var l=this.model.getParent(t[0]);e.push(t[0]);for(var i=1;i<t.length;i++)this.model.getParent(t[i])==l&&e.push(t[i])}return e},mxGraph.prototype.getBoundsForGroup=function(t,e,l){var i=this.getBoundingBoxFromGeometry(e,!0);if(null!=i){if(this.isSwimlane(t)){var n=this.getStartSize(t);i.x-=n.width,i.y-=n.height,i.width+=n.width,i.height+=n.height}null!=l&&(i.x-=l,i.y-=l,i.width+=2*l,i.height+=2*l)}return i},mxGraph.prototype.createGroupCell=function(t){var e=new mxCell("");return e.setVertex(!0),e.setConnectable(!1),e},mxGraph.prototype.ungroupCells=function(t){var e=[];if(null==t){t=this.getSelectionCells();for(var l=[],i=0;i<t.length;i++)this.model.getChildCount(t[i])>0&&l.push(t[i]);t=l}if(null!=t&&t.length>0){this.model.beginUpdate();try{for(i=0;i<t.length;i++){var n=this.model.getChildren(t[i]);if(null!=n&&n.length>0){n=n.slice();var s=this.model.getParent(t[i]),o=this.model.getChildCount(s);this.cellsAdded(n,s,o,null,null,!0),e=e.concat(n)}}this.removeCellsAfterUngroup(t),this.fireEvent(new mxEventObject(mxEvent.UNGROUP_CELLS,"cells",t))}finally{this.model.endUpdate()}}return e},mxGraph.prototype.removeCellsAfterUngroup=function(t){this.cellsRemoved(this.addAllEdges(t))},mxGraph.prototype.removeCellsFromParent=function(t){null==t&&(t=this.getSelectionCells()),this.model.beginUpdate();try{var e=this.getDefaultParent(),l=this.model.getChildCount(e);this.cellsAdded(t,e,l,null,null,!0),this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS_FROM_PARENT,"cells",t))}finally{this.model.endUpdate()}return t},mxGraph.prototype.updateGroupBounds=function(t,e,l,i,n,s,o){null==t&&(t=this.getSelectionCells()),e=null!=e?e:0,l=null!=l&&l,i=null!=i?i:0,n=null!=n?n:0,s=null!=s?s:0,o=null!=o?o:0,this.model.beginUpdate();try{for(var r=t.length-1;r>=0;r--){var a=this.getCellGeometry(t[r]);if(null!=a){var h=this.getChildCells(t[r]);if(null!=h&&h.length>0){var p=this.getBoundingBoxFromGeometry(h,!0);if(null!=p&&p.width>0&&p.height>0){var u=0,m=0;if(this.isSwimlane(t[r])){var d=this.getStartSize(t[r]);u=d.width,m=d.height}a=a.clone(),l&&(a.x=Math.round(a.x+p.x-e-u-o),a.y=Math.round(a.y+p.y-e-m-i)),a.width=Math.round(p.width+2*e+u+o+n),a.height=Math.round(p.height+2*e+m+i+s),this.model.setGeometry(t[r],a),this.moveCells(h,e+u-p.x+o,e+m-p.y+i)}}}}}finally{this.model.endUpdate()}return t},mxGraph.prototype.getBoundingBox=function(t){var e=null;if(null!=t&&t.length>0)for(var l=0;l<t.length;l++)if(this.model.isVertex(t[l])||this.model.isEdge(t[l])){var i=this.view.getBoundingBox(this.view.getState(t[l]),!0);null!=i&&(null==e?e=mxRectangle.fromRectangle(i):e.add(i))}return e},mxGraph.prototype.cloneCell=function(t,e,l,i){return this.cloneCells([t],e,l,i)[0]},mxGraph.prototype.cloneCells=function(t,e,l,i){e=null==e||e;var n=null;if(null!=t){for(var s=new mxDictionary,o=[],r=0;r<t.length;r++)s.put(t[r],!0),o.push(t[r]);if(o.length>0){var a=this.view.scale,h=this.view.translate;n=this.model.cloneCells(t,!0,l);for(r=0;r<t.length;r++)if(!e&&this.model.isEdge(n[r])&&null!=this.getEdgeValidationError(n[r],this.model.getTerminal(n[r],!0),this.model.getTerminal(n[r],!1)))n[r]=null;else{var p=this.model.getGeometry(n[r]);if(null!=p){var u=this.view.getState(t[r]),m=this.view.getState(this.model.getParent(t[r]));if(null!=u&&null!=m){var d=i?0:m.origin.x,c=i?0:m.origin.y;if(this.model.isEdge(n[r])){var g=u.absolutePoints;if(null!=g){for(var x=this.model.getTerminal(t[r],!0);null!=x&&!s.get(x);)x=this.model.getParent(x);null==x&&null!=g[0]&&p.setTerminalPoint(new mxPoint(g[0].x/a-h.x,g[0].y/a-h.y),!0);for(var v=this.model.getTerminal(t[r],!1);null!=v&&!s.get(v);)v=this.model.getParent(v);var C=g.length-1;null==v&&null!=g[C]&&p.setTerminalPoint(new mxPoint(g[C].x/a-h.x,g[C].y/a-h.y),!1);var y=p.points;if(null!=y)for(var f=0;f<y.length;f++)y[f].x+=d,y[f].y+=c}}else p.translate(d,c)}}}}else n=[]}return n},mxGraph.prototype.insertVertex=function(t,e,l,i,n,s,o,r,a){var h=this.createVertex(t,e,l,i,n,s,o,r,a);return this.addCell(h,t)},mxGraph.prototype.createVertex=function(t,e,l,i,n,s,o,r,a){var h=new mxGeometry(i,n,s,o);h.relative=null!=a&&a;var p=new mxCell(l,h,r);return p.setId(e),p.setVertex(!0),p.setConnectable(!0),p},mxGraph.prototype.insertEdge=function(t,e,l,i,n,s){var o=this.createEdge(t,e,l,i,n,s);return this.addEdge(o,t,i,n)},mxGraph.prototype.createEdge=function(t,e,l,i,n,s){var o=new mxCell(l,new mxGeometry,s);return o.setId(e),o.setEdge(!0),o.geometry.relative=!0,o},mxGraph.prototype.addEdge=function(t,e,l,i,n){return this.addCell(t,e,n,l,i)},mxGraph.prototype.addCell=function(t,e,l,i,n){return this.addCells([t],e,l,i,n)[0]},mxGraph.prototype.addCells=function(t,e,l,i,n,s){null==e&&(e=this.getDefaultParent()),null==l&&(l=this.model.getChildCount(e)),this.model.beginUpdate();try{this.cellsAdded(t,e,l,i,n,null!=s&&s,!0),this.fireEvent(new mxEventObject(mxEvent.ADD_CELLS,"cells",t,"parent",e,"index",l,"source",i,"target",n))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellsAdded=function(t,e,l,i,n,s,o,r){if(null!=t&&null!=e&&null!=l){this.model.beginUpdate();try{for(var a=s?this.view.getState(e):null,h=null!=a?a.origin:null,p=new mxPoint(0,0),u=0;u<t.length;u++)if(null==t[u])l--;else{var m=this.model.getParent(t[u]);if(null!=h&&t[u]!=e&&e!=m){var d=this.view.getState(m),c=null!=d?d.origin:p,g=this.model.getGeometry(t[u]);if(null!=g){var x=c.x-h.x,v=c.y-h.y;(g=g.clone()).translate(x,v),g.relative||!this.model.isVertex(t[u])||this.isAllowNegativeCoordinates()||(g.x=Math.max(0,g.x),g.y=Math.max(0,g.y)),this.model.setGeometry(t[u],g)}}e==m&&l+u>this.model.getChildCount(e)&&l--,this.model.add(e,t[u],l+u),this.autoSizeCellsOnAdd&&this.autoSizeCell(t[u],!0),(null==r||r)&&this.isExtendParentsOnAdd(t[u])&&this.isExtendParent(t[u])&&this.extendParent(t[u]),(null==o||o)&&this.constrainChild(t[u]),null!=i&&this.cellConnected(t[u],i,!0),null!=n&&this.cellConnected(t[u],n,!1)}this.fireEvent(new mxEventObject(mxEvent.CELLS_ADDED,"cells",t,"parent",e,"index",l,"source",i,"target",n,"absolute",s))}finally{this.model.endUpdate()}}},mxGraph.prototype.autoSizeCell=function(t,e){if(e=null==e||e)for(var l=this.model.getChildCount(t),i=0;i<l;i++)this.autoSizeCell(this.model.getChildAt(t,i));this.getModel().isVertex(t)&&this.isAutoSizeCell(t)&&this.updateCellSize(t)},mxGraph.prototype.removeCells=function(t,e){if(e=null==e||e,null==t&&(t=this.getDeletableCells(this.getSelectionCells())),e)t=this.getDeletableCells(this.addAllEdges(t));else{t=t.slice();for(var l=this.getDeletableCells(this.getAllEdges(t)),i=new mxDictionary,n=0;n<t.length;n++)i.put(t[n],!0);for(n=0;n<l.length;n++)null!=this.view.getState(l[n])||i.get(l[n])||(i.put(l[n],!0),t.push(l[n]))}this.model.beginUpdate();try{this.cellsRemoved(t),this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS,"cells",t,"includeEdges",e))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellsRemoved=function(t){if(null!=t&&t.length>0){var e=this.view.scale,l=this.view.translate;this.model.beginUpdate();try{for(var i=new mxDictionary,n=0;n<t.length;n++)i.put(t[n],!0);for(n=0;n<t.length;n++){for(var s=this.getAllEdges([t[n]]),o=mxUtils.bind(this,function(i,s){var o=this.model.getGeometry(i);if(null!=o){for(var r=this.model.getTerminal(i,s),a=!1,h=r;null!=h;){if(t[n]==h){a=!0;break}h=this.model.getParent(h)}if(a){o=o.clone();var p=this.view.getState(i);if(null!=p&&null!=p.absolutePoints){var u=p.absolutePoints,m=s?0:u.length-1;o.setTerminalPoint(new mxPoint(u[m].x/e-l.x-p.origin.x,u[m].y/e-l.y-p.origin.y),s)}else{var d=this.view.getState(r);null!=d&&o.setTerminalPoint(new mxPoint(d.getCenterX()/e-l.x,d.getCenterY()/e-l.y),s)}this.model.setGeometry(i,o),this.model.setTerminal(i,null,s)}}}),r=0;r<s.length;r++)i.get(s[r])||(i.put(s[r],!0),o(s[r],!0),o(s[r],!1));this.model.remove(t[n])}this.fireEvent(new mxEventObject(mxEvent.CELLS_REMOVED,"cells",t))}finally{this.model.endUpdate()}}},mxGraph.prototype.splitEdge=function(t,e,l,i,n,s,o,r){i=i||0,n=n||0,r=null!=r?r:this.model.getParent(t);var a=this.model.getTerminal(t,!0);this.model.beginUpdate();try{if(null==l){l=this.cloneCell(t);var h=this.view.getState(t),p=this.getCellGeometry(l);if(null!=p&&null!=p.points&&null!=h){var u=this.view.translate,m=this.view.scale,d=mxUtils.findNearestSegment(h,(i+u.x)*m,(n+u.y)*m);p.points=p.points.slice(0,d),null!=(p=this.getCellGeometry(t))&&null!=p.points&&((p=p.clone()).points=p.points.slice(d),this.model.setGeometry(t,p))}}this.cellsMoved(e,i,n,!1,!1),this.cellsAdded(e,r,this.model.getChildCount(r),null,null,!0),this.cellsAdded([l],r,this.model.getChildCount(r),a,e[0],!1),this.cellConnected(t,e[0],!0),this.fireEvent(new mxEventObject(mxEvent.SPLIT_EDGE,"edge",t,"cells",e,"newEdge",l,"dx",i,"dy",n))}finally{this.model.endUpdate()}return l},mxGraph.prototype.toggleCells=function(t,e,l){null==e&&(e=this.getSelectionCells()),l&&(e=this.addAllEdges(e)),this.model.beginUpdate();try{this.cellsToggled(e,t),this.fireEvent(new mxEventObject(mxEvent.TOGGLE_CELLS,"show",t,"cells",e,"includeEdges",l))}finally{this.model.endUpdate()}return e},mxGraph.prototype.cellsToggled=function(t,e){if(null!=t&&t.length>0){this.model.beginUpdate();try{for(var l=0;l<t.length;l++)this.model.setVisible(t[l],e)}finally{this.model.endUpdate()}}},mxGraph.prototype.foldCells=function(t,e,l,i,n){e=null!=e&&e,null==l&&(l=this.getFoldableCells(this.getSelectionCells(),t)),this.stopEditing(!1),this.model.beginUpdate();try{this.cellsFolded(l,t,e,i),this.fireEvent(new mxEventObject(mxEvent.FOLD_CELLS,"collapse",t,"recurse",e,"cells",l))}finally{this.model.endUpdate()}return l},mxGraph.prototype.cellsFolded=function(t,e,l,i){if(null!=t&&t.length>0){this.model.beginUpdate();try{for(var n=0;n<t.length;n++)if((!i||this.isCellFoldable(t[n],e))&&e!=this.isCellCollapsed(t[n])){if(this.model.setCollapsed(t[n],e),this.swapBounds(t[n],e),this.isExtendParent(t[n])&&this.extendParent(t[n]),l){var s=this.model.getChildren(t[n]);this.cellsFolded(s,e,l)}this.constrainChild(t[n])}this.fireEvent(new mxEventObject(mxEvent.CELLS_FOLDED,"cells",t,"collapse",e,"recurse",l))}finally{this.model.endUpdate()}}},mxGraph.prototype.swapBounds=function(t,e){if(null!=t){var l=this.model.getGeometry(t);null!=l&&(l=l.clone(),this.updateAlternateBounds(t,l,e),l.swap(),this.model.setGeometry(t,l))}},mxGraph.prototype.updateAlternateBounds=function(t,e,l){if(null!=t&&null!=e){var i=this.getCurrentCellStyle(t);if(null==e.alternateBounds){var n=e;if(this.collapseToPreferredSize){var s=this.getPreferredSizeForCell(t);if(null!=s){n=s;var o=mxUtils.getValue(i,mxConstants.STYLE_STARTSIZE);o>0&&(n.height=Math.max(n.height,o))}}e.alternateBounds=new mxRectangle(0,0,n.width,n.height)}if(null!=e.alternateBounds){e.alternateBounds.x=e.x,e.alternateBounds.y=e.y;var r=mxUtils.toRadians(i[mxConstants.STYLE_ROTATION]||0);if(0!=r){var a=e.alternateBounds.getCenterX()-e.getCenterX(),h=e.alternateBounds.getCenterY()-e.getCenterY(),p=Math.cos(r),u=Math.sin(r),m=p*a-u*h,d=u*a+p*h;e.alternateBounds.x+=m-a,e.alternateBounds.y+=d-h}}}},mxGraph.prototype.addAllEdges=function(t){var e=t.slice();return mxUtils.removeDuplicates(e.concat(this.getAllEdges(t)))},mxGraph.prototype.getAllEdges=function(t){var e=[];if(null!=t)for(var l=0;l<t.length;l++){for(var i=this.model.getEdgeCount(t[l]),n=0;n<i;n++)e.push(this.model.getEdgeAt(t[l],n));var s=this.model.getChildren(t[l]);e=e.concat(this.getAllEdges(s))}return e},mxGraph.prototype.updateCellSize=function(t,e){e=null!=e&&e,this.model.beginUpdate();try{this.cellSizeUpdated(t,e),this.fireEvent(new mxEventObject(mxEvent.UPDATE_CELL_SIZE,"cell",t,"ignoreChildren",e))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellSizeUpdated=function(t,e){if(null!=t){this.model.beginUpdate();try{var l=this.getPreferredSizeForCell(t),i=this.model.getGeometry(t);if(null!=l&&null!=i){var n=this.isCellCollapsed(t);if(i=i.clone(),this.isSwimlane(t)){var s=this.getCellStyle(t),o=this.model.getStyle(t);null==o&&(o=""),mxUtils.getValue(s,mxConstants.STYLE_HORIZONTAL,!0)?(o=mxUtils.setStyle(o,mxConstants.STYLE_STARTSIZE,l.height+8),n&&(i.height=l.height+8),i.width=l.width):(o=mxUtils.setStyle(o,mxConstants.STYLE_STARTSIZE,l.width+8),n&&(i.width=l.width+8),i.height=l.height),this.model.setStyle(t,o)}else{var r=this.view.createState(t),a=r.style[mxConstants.STYLE_ALIGN]||mxConstants.ALIGN_CENTER;a==mxConstants.ALIGN_RIGHT?i.x+=i.width-l.width:a==mxConstants.ALIGN_CENTER&&(i.x+=Math.round((i.width-l.width)/2));var h=this.getVerticalAlign(r);h==mxConstants.ALIGN_BOTTOM?i.y+=i.height-l.height:h==mxConstants.ALIGN_MIDDLE&&(i.y+=Math.round((i.height-l.height)/2)),i.width=l.width,i.height=l.height}if(!e&&!n){var p=this.view.getBounds(this.model.getChildren(t));if(null!=p){var u=this.view.translate,m=this.view.scale,d=(p.x+p.width)/m-i.x-u.x,c=(p.y+p.height)/m-i.y-u.y;i.width=Math.max(i.width,d),i.height=Math.max(i.height,c)}}this.cellsResized([t],[i],!1)}}finally{this.model.endUpdate()}}},mxGraph.prototype.getPreferredSizeForCell=function(t,e){var l=null;if(null!=t){var i=this.view.createState(t),n=i.style;if(!this.model.isEdge(t)){var s=n[mxConstants.STYLE_FONTSIZE]||mxConstants.DEFAULT_FONTSIZE,o=0,r=0;null==this.getImage(i)&&null==n[mxConstants.STYLE_IMAGE]||n[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_LABEL&&(n[mxConstants.STYLE_VERTICAL_ALIGN]==mxConstants.ALIGN_MIDDLE&&(o+=parseFloat(n[mxConstants.STYLE_IMAGE_WIDTH])||mxLabel.prototype.imageSize),n[mxConstants.STYLE_ALIGN]!=mxConstants.ALIGN_CENTER&&(r+=parseFloat(n[mxConstants.STYLE_IMAGE_HEIGHT])||mxLabel.prototype.imageSize)),o+=2*(n[mxConstants.STYLE_SPACING]||0),o+=n[mxConstants.STYLE_SPACING_LEFT]||0,o+=n[mxConstants.STYLE_SPACING_RIGHT]||0,r+=2*(n[mxConstants.STYLE_SPACING]||0),r+=n[mxConstants.STYLE_SPACING_TOP]||0,r+=n[mxConstants.STYLE_SPACING_BOTTOM]||0;var a=this.getFoldingImage(i);null!=a&&(o+=a.width+8);var h=this.cellRenderer.getLabelValue(i);if(null!=h&&h.length>0){this.isHtmlLabel(i.cell)||(h=mxUtils.htmlEntities(h,!1)),h=h.replace(/\n/g,"<br>");var p=mxUtils.getSizeForString(h,s,n[mxConstants.STYLE_FONTFAMILY],e,n[mxConstants.STYLE_FONTSTYLE]),u=p.width+o,m=p.height+r;if(!mxUtils.getValue(n,mxConstants.STYLE_HORIZONTAL,!0)){var d=m;m=u,u=d}this.gridEnabled&&(u=this.snap(u+this.gridSize/2),m=this.snap(m+this.gridSize/2)),l=new mxRectangle(0,0,u,m)}else{var c=4*this.gridSize;l=new mxRectangle(0,0,c,c)}}}return l},mxGraph.prototype.resizeCell=function(t,e,l){return this.resizeCells([t],[e],l)[0]},mxGraph.prototype.resizeCells=function(t,e,l){l=null!=l?l:this.isRecursiveResize(),this.model.beginUpdate();try{var i=this.cellsResized(t,e,l);this.fireEvent(new mxEventObject(mxEvent.RESIZE_CELLS,"cells",t,"bounds",e,"previous",i))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellsResized=function(t,e,l){l=null!=l&&l;var i=[];if(null!=t&&null!=e&&t.length==e.length){this.model.beginUpdate();try{for(var n=0;n<t.length;n++)i.push(this.cellResized(t[n],e[n],!1,l)),this.isExtendParent(t[n])&&this.extendParent(t[n]),this.constrainChild(t[n]);this.resetEdgesOnResize&&this.resetEdges(t),this.fireEvent(new mxEventObject(mxEvent.CELLS_RESIZED,"cells",t,"bounds",e,"previous",i))}finally{this.model.endUpdate()}}return i},mxGraph.prototype.cellResized=function(t,e,l,i){var n=this.model.getGeometry(t);if(null!=n&&(n.x!=e.x||n.y!=e.y||n.width!=e.width||n.height!=e.height)){var s=n.clone();if(!l&&s.relative){var o=s.offset;null!=o&&(o.x+=e.x-s.x,o.y+=e.y-s.y)}else s.x=e.x,s.y=e.y;s.width=e.width,s.height=e.height,s.relative||!this.model.isVertex(t)||this.isAllowNegativeCoordinates()||(s.x=Math.max(0,s.x),s.y=Math.max(0,s.y)),this.model.beginUpdate();try{i&&this.resizeChildCells(t,s),this.model.setGeometry(t,s),this.constrainChildCells(t)}finally{this.model.endUpdate()}}return n},mxGraph.prototype.resizeChildCells=function(t,e){for(var l=this.model.getGeometry(t),i=e.width/l.width,n=e.height/l.height,s=this.model.getChildCount(t),o=0;o<s;o++)this.scaleCell(this.model.getChildAt(t,o),i,n,!0)},mxGraph.prototype.constrainChildCells=function(t){for(var e=this.model.getChildCount(t),l=0;l<e;l++)this.constrainChild(this.model.getChildAt(t,l))},mxGraph.prototype.scaleCell=function(t,e,l,i){var n=this.model.getGeometry(t);if(null!=n){var s=this.getCurrentCellStyle(t),o=(n=n.clone()).x,r=n.y,a=n.width,h=n.height;n.scale(e,l,"fixed"==s[mxConstants.STYLE_ASPECT]),"1"==s[mxConstants.STYLE_RESIZE_WIDTH]?n.width=a*e:"0"==s[mxConstants.STYLE_RESIZE_WIDTH]&&(n.width=a),"1"==s[mxConstants.STYLE_RESIZE_HEIGHT]?n.height=h*l:"0"==s[mxConstants.STYLE_RESIZE_HEIGHT]&&(n.height=h),this.isCellMovable(t)||(n.x=o,n.y=r),this.isCellResizable(t)||(n.width=a,n.height=h),this.model.isVertex(t)?this.cellResized(t,n,!0,i):this.model.setGeometry(t,n)}},mxGraph.prototype.extendParent=function(t){if(null!=t){var e=this.model.getParent(t),l=this.getCellGeometry(e);if(null!=e&&null!=l&&!this.isCellCollapsed(e)){var i=this.getCellGeometry(t);null!=i&&!i.relative&&(l.width<i.x+i.width||l.height<i.y+i.height)&&((l=l.clone()).width=Math.max(l.width,i.x+i.width),l.height=Math.max(l.height,i.y+i.height),this.cellsResized([e],[l],!1))}}},mxGraph.prototype.importCells=function(t,e,l,i,n,s){return this.moveCells(t,e,l,!0,i,n,s)},mxGraph.prototype.moveCells=function(t,e,l,i,n,s,o){if(e=null!=e?e:0,l=null!=l?l:0,i=null!=i&&i,null!=t&&(0!=e||0!=l||i||null!=n)){t=this.model.getTopmostCells(t),this.model.beginUpdate();try{for(var r=new mxDictionary,a=0;a<t.length;a++)r.put(t[a],!0);var h=mxUtils.bind(this,function(t){for(;null!=t;){if(r.get(t))return!0;t=this.model.getParent(t)}return!1}),p=[];for(a=0;a<t.length;a++){var u=this.getCellGeometry(t[a]),m=this.model.getParent(t[a]);null!=u&&u.relative&&this.model.isEdge(m)&&(h(this.model.getTerminal(m,!0))||h(this.model.getTerminal(m,!1)))||p.push(t[a])}t=p,i&&(t=this.cloneCells(t,this.isCloneInvalidEdges(),o),null==n&&(n=this.getDefaultParent()));var d=this.isAllowNegativeCoordinates();if(null!=n&&this.setAllowNegativeCoordinates(!0),this.cellsMoved(t,e,l,!i&&this.isDisconnectOnMove()&&this.isAllowDanglingEdges(),null==n,this.isExtendParentsOnMove()&&null==n),this.setAllowNegativeCoordinates(d),null!=n){var c=this.model.getChildCount(n);this.cellsAdded(t,n,c,null,null,!0)}this.fireEvent(new mxEventObject(mxEvent.MOVE_CELLS,"cells",t,"dx",e,"dy",l,"clone",i,"target",n,"event",s))}finally{this.model.endUpdate()}}return t},mxGraph.prototype.cellsMoved=function(t,e,l,i,n,s){if(null!=t&&(0!=e||0!=l)){s=null!=s&&s,this.model.beginUpdate();try{i&&this.disconnectGraph(t);for(var o=0;o<t.length;o++)this.translateCell(t[o],e,l),s&&this.isExtendParent(t[o])?this.extendParent(t[o]):n&&this.constrainChild(t[o]);this.resetEdgesOnMove&&this.resetEdges(t),this.fireEvent(new mxEventObject(mxEvent.CELLS_MOVED,"cells",t,"dx",e,"dy",l,"disconnect",i))}finally{this.model.endUpdate()}}},mxGraph.prototype.translateCell=function(t,e,l){var i=this.model.getGeometry(t);if(null!=i){if(e=parseFloat(e),l=parseFloat(l),(i=i.clone()).translate(e,l),i.relative||!this.model.isVertex(t)||this.isAllowNegativeCoordinates()||(i.x=Math.max(0,parseFloat(i.x)),i.y=Math.max(0,parseFloat(i.y))),i.relative&&!this.model.isEdge(t)){var n=this.model.getParent(t),s=0;if(this.model.isVertex(n)){var o=this.getCurrentCellStyle(n);s=mxUtils.getValue(o,mxConstants.STYLE_ROTATION,0)}if(0!=s){var r=mxUtils.toRadians(-s),a=Math.cos(r),h=Math.sin(r),p=mxUtils.getRotatedPoint(new mxPoint(e,l),a,h,new mxPoint(0,0));e=p.x,l=p.y}null==i.offset?i.offset=new mxPoint(e,l):(i.offset.x=parseFloat(i.offset.x)+e,i.offset.y=parseFloat(i.offset.y)+l)}this.model.setGeometry(t,i)}},mxGraph.prototype.getCellContainmentArea=function(t){if(null!=t&&!this.model.isEdge(t)){var e=this.model.getParent(t);if(null!=e&&e!=this.getDefaultParent()){var l=this.model.getGeometry(e);if(null!=l){var i=0,n=0,s=l.width,o=l.height;if(this.isSwimlane(e)){var r=this.getStartSize(e),a=this.getCurrentCellStyle(e),h=mxUtils.getValue(a,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST),p=1==mxUtils.getValue(a,mxConstants.STYLE_FLIPH,0),u=1==mxUtils.getValue(a,mxConstants.STYLE_FLIPV,0);if(h==mxConstants.DIRECTION_SOUTH||h==mxConstants.DIRECTION_NORTH){var m=r.width;r.width=r.height,r.height=m}(h==mxConstants.DIRECTION_EAST&&!u||h==mxConstants.DIRECTION_NORTH&&!p||h==mxConstants.DIRECTION_WEST&&u||h==mxConstants.DIRECTION_SOUTH&&p)&&(i=r.width,n=r.height),s-=r.width,o-=r.height}return new mxRectangle(i,n,s,o)}}}return null},mxGraph.prototype.getMaximumGraphBounds=function(){return this.maximumGraphBounds},mxGraph.prototype.constrainChild=function(t,e){if(e=null==e||e,null!=t){var l=this.getCellGeometry(t);if(null!=l&&(this.isConstrainRelativeChildren()||!l.relative)){var i=this.model.getParent(t),n=(this.getCellGeometry(i),this.getMaximumGraphBounds());if(null!=n){var s=this.getBoundingBoxFromGeometry([i],!1);null!=s&&((n=mxRectangle.fromRectangle(n)).x-=s.x,n.y-=s.y)}if(this.isConstrainChild(t)){var o=this.getCellContainmentArea(t);if(null!=o){var r=this.getOverlap(t);r>0&&((o=mxRectangle.fromRectangle(o)).x-=o.width*r,o.y-=o.height*r,o.width+=2*o.width*r,o.height+=2*o.height*r),null==n?n=o:(n=mxRectangle.fromRectangle(n)).intersect(o)}}if(null!=n){var a=[t];if(!this.isCellCollapsed(t))for(var h=this.model.getDescendants(t),p=0;p<h.length;p++)this.isCellVisible(h[p])&&a.push(h[p]);var u=this.getBoundingBoxFromGeometry(a,!1);if(null!=u){var m=0;(l=l.clone()).width>n.width&&(m=l.width-n.width,l.width-=m),u.x+u.width>n.x+n.width&&(m-=u.x+u.width-n.x-n.width-m);var d=0;l.height>n.height&&(d=l.height-n.height,l.height-=d),u.y+u.height>n.y+n.height&&(d-=u.y+u.height-n.y-n.height-d),u.x<n.x&&(m-=u.x-n.x),u.y<n.y&&(d-=u.y-n.y),0==m&&0==d||(l.relative?(null==l.offset&&(l.offset=new mxPoint),l.offset.x+=m,l.offset.y+=d):(l.x+=m,l.y+=d)),this.model.setGeometry(t,l)}}}}},mxGraph.prototype.resetEdges=function(t){if(null!=t){for(var e=new mxDictionary,l=0;l<t.length;l++)e.put(t[l],!0);this.model.beginUpdate();try{for(l=0;l<t.length;l++){var i=this.model.getEdges(t[l]);if(null!=i)for(var n=0;n<i.length;n++){var s=this.view.getState(i[n]),o=null!=s?s.getVisibleTerminal(!0):this.view.getVisibleTerminal(i[n],!0),r=null!=s?s.getVisibleTerminal(!1):this.view.getVisibleTerminal(i[n],!1);e.get(o)&&e.get(r)||this.resetEdge(i[n])}this.resetEdges(this.model.getChildren(t[l]))}}finally{this.model.endUpdate()}}},mxGraph.prototype.resetEdge=function(t){var e=this.model.getGeometry(t);return null!=e&&null!=e.points&&e.points.length>0&&((e=e.clone()).points=[],this.model.setGeometry(t,e)),t},mxGraph.prototype.getOutlineConstraint=function(t,e,l){if(null!=e.shape){var i=this.view.getPerimeterBounds(e),n=e.style[mxConstants.STYLE_DIRECTION];if(n==mxConstants.DIRECTION_NORTH||n==mxConstants.DIRECTION_SOUTH){i.x+=i.width/2-i.height/2,i.y+=i.height/2-i.width/2;var s=i.width;i.width=i.height,i.height=s}var o=mxUtils.toRadians(e.shape.getShapeRotation());if(0!=o){var r=Math.cos(-o),a=Math.sin(-o),h=new mxPoint(i.getCenterX(),i.getCenterY());t=mxUtils.getRotatedPoint(t,r,a,h)}var p=1,u=1,m=0,d=0;if(this.getModel().isVertex(e.cell)){var c=e.style[mxConstants.STYLE_FLIPH],g=e.style[mxConstants.STYLE_FLIPV];if(null!=e.shape&&null!=e.shape.stencil&&(c=1==mxUtils.getValue(e.style,"stencilFlipH",0)||c,g=1==mxUtils.getValue(e.style,"stencilFlipV",0)||g),n==mxConstants.DIRECTION_NORTH||n==mxConstants.DIRECTION_SOUTH){s=c;c=g,g=s}c&&(p=-1,m=-i.width),g&&(u=-1,d=-i.height)}t=new mxPoint((t.x-i.x)*p-m+i.x,(t.y-i.y)*u-d+i.y);var x=0==i.width?0:Math.round(1e3*(t.x-i.x)/i.width)/1e3,v=0==i.height?0:Math.round(1e3*(t.y-i.y)/i.height)/1e3;return new mxConnectionConstraint(new mxPoint(x,v),!1)}return null},mxGraph.prototype.getAllConnectionConstraints=function(t,e){return null!=t&&null!=t.shape&&null!=t.shape.stencil?t.shape.stencil.constraints:null},mxGraph.prototype.getConnectionConstraint=function(t,e,l){var i=null,n=t.style[l?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X];if(null!=n){var s=t.style[l?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y];null!=s&&(i=new mxPoint(parseFloat(n),parseFloat(s)))}var o=!1,r=0,a=0;return null!=i&&(o=mxUtils.getValue(t.style,l?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,!0),r=parseFloat(t.style[l?mxConstants.STYLE_EXIT_DX:mxConstants.STYLE_ENTRY_DX]),a=parseFloat(t.style[l?mxConstants.STYLE_EXIT_DY:mxConstants.STYLE_ENTRY_DY]),r=isFinite(r)?r:0,a=isFinite(a)?a:0),new mxConnectionConstraint(i,o,null,r,a)},mxGraph.prototype.setConnectionConstraint=function(t,e,l,i){if(null!=i){this.model.beginUpdate();try{null==i||null==i.point?(this.setCellStyles(l?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,null,[t]),this.setCellStyles(l?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,null,[t]),this.setCellStyles(l?mxConstants.STYLE_EXIT_DX:mxConstants.STYLE_ENTRY_DX,null,[t]),this.setCellStyles(l?mxConstants.STYLE_EXIT_DY:mxConstants.STYLE_ENTRY_DY,null,[t]),this.setCellStyles(l?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[t])):null!=i.point&&(this.setCellStyles(l?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,i.point.x,[t]),this.setCellStyles(l?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,i.point.y,[t]),this.setCellStyles(l?mxConstants.STYLE_EXIT_DX:mxConstants.STYLE_ENTRY_DX,i.dx,[t]),this.setCellStyles(l?mxConstants.STYLE_EXIT_DY:mxConstants.STYLE_ENTRY_DY,i.dy,[t]),i.perimeter?this.setCellStyles(l?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[t]):this.setCellStyles(l?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,"0",[t]))}finally{this.model.endUpdate()}}},mxGraph.prototype.getConnectionPoint=function(t,e,l){l=null==l||l;var i=null;if(null!=t&&null!=e.point){var n=this.view.getPerimeterBounds(t),s=new mxPoint(n.getCenterX(),n.getCenterY()),o=t.style[mxConstants.STYLE_DIRECTION],r=0;null!=o&&1==mxUtils.getValue(t.style,mxConstants.STYLE_ANCHOR_POINT_DIRECTION,1)&&(o==mxConstants.DIRECTION_NORTH?r+=270:o==mxConstants.DIRECTION_WEST?r+=180:o==mxConstants.DIRECTION_SOUTH&&(r+=90),o!=mxConstants.DIRECTION_NORTH&&o!=mxConstants.DIRECTION_SOUTH||n.rotate90());var a=this.view.scale;i=new mxPoint(n.x+e.point.x*n.width+e.dx*a,n.y+e.point.y*n.height+e.dy*a);var h=t.style[mxConstants.STYLE_ROTATION]||0;if(e.perimeter){if(0!=r){var p=0,u=0;90==r?u=1:180==r?p=-1:270==r&&(u=-1),i=mxUtils.getRotatedPoint(i,p,u,s)}i=this.view.getPerimeterPoint(t,i,!1)}else if(h+=r,this.getModel().isVertex(t.cell)){var m=1==t.style[mxConstants.STYLE_FLIPH],d=1==t.style[mxConstants.STYLE_FLIPV];if(null!=t.shape&&null!=t.shape.stencil&&(m=1==mxUtils.getValue(t.style,"stencilFlipH",0)||m,d=1==mxUtils.getValue(t.style,"stencilFlipV",0)||d),o==mxConstants.DIRECTION_NORTH||o==mxConstants.DIRECTION_SOUTH){var c=m;m=d,d=c}m&&(i.x=2*n.getCenterX()-i.x),d&&(i.y=2*n.getCenterY()-i.y)}if(0!=h&&null!=i){var g=mxUtils.toRadians(h);p=Math.cos(g),u=Math.sin(g);i=mxUtils.getRotatedPoint(i,p,u,s)}}return l&&null!=i&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),i},mxGraph.prototype.connectCell=function(t,e,l,i){this.model.beginUpdate();try{var n=this.model.getTerminal(t,l);this.cellConnected(t,e,l,i),this.fireEvent(new mxEventObject(mxEvent.CONNECT_CELL,"edge",t,"terminal",e,"source",l,"previous",n))}finally{this.model.endUpdate()}return t},mxGraph.prototype.cellConnected=function(t,e,l,i){if(null!=t){this.model.beginUpdate();try{var n=this.model.getTerminal(t,l);if(this.setConnectionConstraint(t,e,l,i),this.isPortsEnabled()){var s=null;this.isPort(e)&&(s=e.getId(),e=this.getTerminalForPort(e,l));var o=l?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT;this.setCellStyles(o,s,[t])}this.model.setTerminal(t,e,l),this.resetEdgesOnConnect&&this.resetEdge(t),this.fireEvent(new mxEventObject(mxEvent.CELL_CONNECTED,"edge",t,"terminal",e,"source",l,"previous",n))}finally{this.model.endUpdate()}}},mxGraph.prototype.disconnectGraph=function(t){if(null!=t){this.model.beginUpdate();try{for(var e=this.view.scale,l=this.view.translate,i=new mxDictionary,n=0;n<t.length;n++)i.put(t[n],!0);for(n=0;n<t.length;n++)if(this.model.isEdge(t[n])){var s=this.model.getGeometry(t[n]);if(null!=s){var o=this.view.getState(t[n]),r=this.view.getState(this.model.getParent(t[n]));if(null!=o&&null!=r){s=s.clone();var a=-r.origin.x,h=-r.origin.y,p=o.absolutePoints,u=this.model.getTerminal(t[n],!0);if(null!=u&&this.isCellDisconnectable(t[n],u,!0)){for(;null!=u&&!i.get(u);)u=this.model.getParent(u);null==u&&(s.setTerminalPoint(new mxPoint(p[0].x/e-l.x+a,p[0].y/e-l.y+h),!0),this.model.setTerminal(t[n],null,!0))}var m=this.model.getTerminal(t[n],!1);if(null!=m&&this.isCellDisconnectable(t[n],m,!1)){for(;null!=m&&!i.get(m);)m=this.model.getParent(m);if(null==m){var d=p.length-1;s.setTerminalPoint(new mxPoint(p[d].x/e-l.x+a,p[d].y/e-l.y+h),!1),this.model.setTerminal(t[n],null,!1)}}this.model.setGeometry(t[n],s)}}}}finally{this.model.endUpdate()}}},mxGraph.prototype.getCurrentRoot=function(){return this.view.currentRoot},mxGraph.prototype.getTranslateForRoot=function(t){return null},mxGraph.prototype.isPort=function(t){return!1},mxGraph.prototype.getTerminalForPort=function(t,e){return this.model.getParent(t)},mxGraph.prototype.getChildOffsetForCell=function(t){return null},mxGraph.prototype.enterGroup=function(t){null!=(t=t||this.getSelectionCell())&&this.isValidRoot(t)&&(this.view.setCurrentRoot(t),this.clearSelection())},mxGraph.prototype.exitGroup=function(){var t=this.model.getRoot(),e=this.getCurrentRoot();if(null!=e){for(var l=this.model.getParent(e);l!=t&&!this.isValidRoot(l)&&this.model.getParent(l)!=t;)l=this.model.getParent(l);l==t||this.model.getParent(l)==t?this.view.setCurrentRoot(null):this.view.setCurrentRoot(l),null!=this.view.getState(e)&&this.setSelectionCell(e)}},mxGraph.prototype.home=function(){var t=this.getCurrentRoot();null!=t&&(this.view.setCurrentRoot(null),null!=this.view.getState(t)&&this.setSelectionCell(t))},mxGraph.prototype.isValidRoot=function(t){return null!=t},mxGraph.prototype.getGraphBounds=function(){return this.view.getGraphBounds()},mxGraph.prototype.getCellBounds=function(t,e,l){var i=[t];e&&(i=i.concat(this.model.getEdges(t)));var n=this.view.getBounds(i);if(l)for(var s=this.model.getChildCount(t),o=0;o<s;o++){var r=this.getCellBounds(this.model.getChildAt(t,o),e,!0);null!=n?n.add(r):n=r}return n},mxGraph.prototype.getBoundingBoxFromGeometry=function(t,e){e=null!=e&&e;var l=null;if(null!=t)for(var i=0;i<t.length;i++)if(e||this.model.isVertex(t[i])){var n=this.getCellGeometry(t[i]);if(null!=n){var s=null;if(this.model.isEdge(t[i])){var o=function(t){null!=t&&(null==a?a=new mxRectangle(t.x,t.y,0,0):a.add(new mxRectangle(t.x,t.y,0,0)))};null==this.model.getTerminal(t[i],!0)&&o(n.getTerminalPoint(!0)),null==this.model.getTerminal(t[i],!1)&&o(n.getTerminalPoint(!1));var r=n.points;if(null!=r&&r.length>0)for(var a=new mxRectangle(r[0].x,r[0].y,0,0),h=1;h<r.length;h++)o(r[h]);s=a}else{var p=this.model.getParent(t[i]);if(n.relative){if(this.model.isVertex(p)&&p!=this.view.currentRoot)null!=(a=this.getBoundingBoxFromGeometry([p],!1))&&(s=new mxRectangle(n.x*a.width,n.y*a.height,n.width,n.height),mxUtils.indexOf(t,p)>=0&&(s.x+=a.x,s.y+=a.y))}else if(s=mxRectangle.fromRectangle(n),this.model.isVertex(p)&&mxUtils.indexOf(t,p)>=0)null!=(a=this.getBoundingBoxFromGeometry([p],!1))&&(s.x+=a.x,s.y+=a.y);null!=s&&null!=n.offset&&(s.x+=n.offset.x,s.y+=n.offset.y);var u=this.getCurrentCellStyle(t[i]);if(null!=s){var m=mxUtils.getValue(u,mxConstants.STYLE_ROTATION,0);0!=m&&(s=mxUtils.getBoundingBox(s,m))}}null!=s&&(null==l?l=mxRectangle.fromRectangle(s):l.add(s))}}return l},mxGraph.prototype.refresh=function(t){this.view.clear(t,null==t),this.view.validate(),this.sizeDidChange(),this.fireEvent(new mxEventObject(mxEvent.REFRESH))},mxGraph.prototype.refreshs=function(t){for(let e=0;e<t.length;e++)this.view.clear(t[e],null==t[e]);this.view.validate(),this.sizeDidChange(),this.fireEvent(new mxEventObject(mxEvent.REFRESH))},mxGraph.prototype.snap=function(t){return this.gridEnabled&&(t=Math.round(t/this.gridSize)*this.gridSize),t},mxGraph.prototype.snapDelta=function(t,e,l,i,n){var s=this.view.translate,o=this.view.scale;if(!l&&this.gridEnabled){var r=this.gridSize*o*.5;if(!i){var a=e.x-(this.snap(e.x/o-s.x)+s.x)*o;Math.abs(t.x-a)<r?t.x=0:t.x=this.snap(t.x/o)*o-a}if(!n){var h=e.y-(this.snap(e.y/o-s.y)+s.y)*o;Math.abs(t.y-h)<r?t.y=0:t.y=this.snap(t.y/o)*o-h}}else{r=.5*o;if(!i){a=e.x-(Math.round(e.x/o-s.x)+s.x)*o;Math.abs(t.x-a)<r?t.x=0:t.x=Math.round(t.x/o)*o-a}if(!n){h=e.y-(Math.round(e.y/o-s.y)+s.y)*o;Math.abs(t.y-h)<r?t.y=0:t.y=Math.round(t.y/o)*o-h}}return t},mxGraph.prototype.panGraph=function(t,e){if(this.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.container))this.container.scrollLeft=-t,this.container.scrollTop=-e;else{var l=this.view.getCanvas();if(this.dialect==mxConstants.DIALECT_SVG)if(0==t&&0==e){if(l.removeAttribute("transform"),null!=this.shiftPreview1){for(var i=this.shiftPreview1.firstChild;null!=i;){var n=i.nextSibling;this.container.appendChild(i),i=n}for(null!=this.shiftPreview1.parentNode&&this.shiftPreview1.parentNode.removeChild(this.shiftPreview1),this.shiftPreview1=null,this.container.appendChild(l.parentNode),i=this.shiftPreview2.firstChild;null!=i;){n=i.nextSibling;this.container.appendChild(i),i=n}null!=this.shiftPreview2.parentNode&&this.shiftPreview2.parentNode.removeChild(this.shiftPreview2),this.shiftPreview2=null}}else{if(l.setAttribute("transform","translate("+t+","+e+")"),null==this.shiftPreview1){this.shiftPreview1=document.createElement("div"),this.shiftPreview1.style.position="absolute",this.shiftPreview1.style.overflow="visible",this.shiftPreview2=document.createElement("div"),this.shiftPreview2.style.position="absolute",this.shiftPreview2.style.overflow="visible";var s=this.shiftPreview1;for(i=this.container.firstChild;null!=i;){n=i.nextSibling;i!=l.parentNode?s.appendChild(i):s=this.shiftPreview2,i=n}null!=this.shiftPreview1.firstChild&&this.container.insertBefore(this.shiftPreview1,l.parentNode),null!=this.shiftPreview2.firstChild&&this.container.appendChild(this.shiftPreview2)}this.shiftPreview1.style.left=t+"px",this.shiftPreview1.style.top=e+"px",this.shiftPreview2.style.left=t+"px",this.shiftPreview2.style.top=e+"px"}else l.style.left=t+"px",l.style.top=e+"px";this.panDx=t,this.panDy=e,this.fireEvent(new mxEventObject(mxEvent.PAN))}},mxGraph.prototype.zoomIn=function(){this.zoom(this.zoomFactor)},mxGraph.prototype.zoomOut=function(){this.zoom(1/this.zoomFactor)},mxGraph.prototype.zoomActual=function(){1==this.view.scale?this.view.setTranslate(0,0):(this.view.translate.x=0,this.view.translate.y=0,this.view.setScale(1))},mxGraph.prototype.zoomTo=function(t,e){this.zoom(t/this.view.scale,e)},mxGraph.prototype.center=function(t,e,l,i){t=null==t||t,e=null==e||e,l=null!=l?l:.5,i=null!=i?i:.5;var n=mxUtils.hasScrollbars(this.container),s=2*this.getBorder(),o=this.container.clientWidth-s,r=this.container.clientHeight-s,a=this.getGraphBounds(),h=this.view.translate,p=this.view.scale,u=t?o-a.width:0,m=e?r-a.height:0;if(n){a.x-=h.x,a.y-=h.y;var d=this.container.scrollWidth,c=this.container.scrollHeight;d>o&&(u=0),c>r&&(m=0),this.view.setTranslate(Math.floor(u/2-a.x),Math.floor(m/2-a.y)),this.container.scrollLeft=(d-o)/2,this.container.scrollTop=(c-r)/2}else this.view.setTranslate(t?Math.floor(h.x-a.x*p+u*l/p):h.x,e?Math.floor(h.y-a.y*p+m*i/p):h.y)},mxGraph.prototype.zoom=function(t,e){e=null!=e?e:this.centerZoom;var l=Math.round(this.view.scale*t*100)/100,i=this.view.getState(this.getSelectionCell());if(t=l/this.view.scale,this.keepSelectionVisibleOnZoom&&null!=i){var n=new mxRectangle(i.x*t,i.y*t,i.width*t,i.height*t);this.view.scale=l,this.scrollRectToVisible(n)||(this.view.revalidate(),this.view.setScale(l))}else{var s=mxUtils.hasScrollbars(this.container);if(e&&!s){var o,r=this.container.offsetWidth,a=this.container.offsetHeight;if(t>1)r*=-(o=(t-1)/(2*l)),a*=-o;else r*=o=(1/t-1)/(2*this.view.scale),a*=o;this.view.scaleAndTranslate(l,this.view.translate.x+r,this.view.translate.y+a)}else{var h=this.view.translate.x,p=this.view.translate.y,u=this.container.scrollLeft,m=this.container.scrollTop;if(this.view.setScale(l),s){r=0,a=0;e&&(r=this.container.offsetWidth*(t-1)/2,a=this.container.offsetHeight*(t-1)/2),this.container.scrollLeft=(this.view.translate.x-h)*this.view.scale+Math.round(u*t+r),this.container.scrollTop=(this.view.translate.y-p)*this.view.scale+Math.round(m*t+a)}}}},mxGraph.prototype.zoomToRect=function(t){var e=this.container.clientWidth/t.width/(this.container.clientHeight/t.height);t.x=Math.max(0,t.x),t.y=Math.max(0,t.y);var l=Math.min(this.container.scrollWidth,t.x+t.width),i=Math.min(this.container.scrollHeight,t.y+t.height);if(t.width=l-t.x,t.height=i-t.y,e<1){var n=t.height/e,s=(n-t.height)/2;t.height=n;var o=Math.min(t.y,s);t.y=t.y-o,i=Math.min(this.container.scrollHeight,t.y+t.height),t.height=i-t.y}else{var r=t.width*e,a=(r-t.width)/2;t.width=r;var h=Math.min(t.x,a);t.x=t.x-h,l=Math.min(this.container.scrollWidth,t.x+t.width),t.width=l-t.x}var p=this.container.clientWidth/t.width,u=this.view.scale*p;mxUtils.hasScrollbars(this.container)?(this.view.setScale(u),this.container.scrollLeft=Math.round(t.x*p),this.container.scrollTop=Math.round(t.y*p)):this.view.scaleAndTranslate(u,this.view.translate.x-t.x/this.view.scale,this.view.translate.y-t.y/this.view.scale)},mxGraph.prototype.scrollCellToVisible=function(t,e){var l=-this.view.translate.x,i=-this.view.translate.y,n=this.view.getState(t);if(null!=n){var s=new mxRectangle(l+n.x,i+n.y,n.width,n.height);if(e&&null!=this.container){var o=this.container.clientWidth,r=this.container.clientHeight;s.x=s.getCenterX()-o/2,s.width=o,s.y=s.getCenterY()-r/2,s.height=r}var a=new mxPoint(this.view.translate.x,this.view.translate.y);if(this.scrollRectToVisible(s)){var h=new mxPoint(this.view.translate.x,this.view.translate.y);this.view.translate.x=a.x,this.view.translate.y=a.y,this.view.setTranslate(h.x,h.y)}}},mxGraph.prototype.scrollRectToVisible=function(t){var e=!1;if(null!=t){var l=this.container.offsetWidth,i=this.container.offsetHeight,n=Math.min(l,t.width),s=Math.min(i,t.height);if(mxUtils.hasScrollbars(this.container)){var o=this.container;t.x+=this.view.translate.x,t.y+=this.view.translate.y;var r=o.scrollLeft-t.x,a=Math.max(r-o.scrollLeft,0);r>0?o.scrollLeft-=r+2:(r=t.x+n-o.scrollLeft-o.clientWidth)>0&&(o.scrollLeft+=r+2);var h=o.scrollTop-t.y,p=Math.max(0,h-o.scrollTop);h>0?o.scrollTop-=h+2:(h=t.y+s-o.scrollTop-o.clientHeight)>0&&(o.scrollTop+=h+2),this.useScrollbarsForPanning||0==a&&0==p||this.view.setTranslate(a,p)}else{var u=-this.view.translate.x,m=-this.view.translate.y,d=this.view.scale;t.x+n>u+l&&(this.view.translate.x-=(t.x+n-l-u)/d,e=!0),t.y+s>m+i&&(this.view.translate.y-=(t.y+s-i-m)/d,e=!0),t.x<u&&(this.view.translate.x+=(u-t.x)/d,e=!0),t.y<m&&(this.view.translate.y+=(m-t.y)/d,e=!0),e&&(this.view.refresh(),null!=this.selectionCellsHandler&&this.selectionCellsHandler.refresh())}}return e},mxGraph.prototype.getCellGeometry=function(t){return this.model.getGeometry(t)},mxGraph.prototype.isCellVisible=function(t){return this.model.isVisible(t)},mxGraph.prototype.isCellCollapsed=function(t){return this.model.isCollapsed(t)},mxGraph.prototype.isCellConnectable=function(t){return this.model.isConnectable(t)},mxGraph.prototype.isOrthogonal=function(t){var e=t.style[mxConstants.STYLE_ORTHOGONAL];if(null!=e)return e;var l=this.view.getEdgeStyle(t);return l==mxEdgeStyle.SegmentConnector||l==mxEdgeStyle.ElbowConnector||l==mxEdgeStyle.SideToSide||l==mxEdgeStyle.TopToBottom||l==mxEdgeStyle.EntityRelation||l==mxEdgeStyle.OrthConnector},mxGraph.prototype.isLoop=function(t){var e=t.getVisibleTerminalState(!0),l=t.getVisibleTerminalState(!1);return null!=e&&e==l},mxGraph.prototype.isCloneEvent=function(t){return mxEvent.isControlDown(t)},mxGraph.prototype.isTransparentClickEvent=function(t){return!1},mxGraph.prototype.isToggleEvent=function(t){return GE.IS_MAC?mxEvent.isMetaDown(t):mxEvent.isControlDown(t)},mxGraph.prototype.isGridEnabledEvent=function(t){return null!=t&&!mxEvent.isAltDown(t)},mxGraph.prototype.isConstrainedEvent=function(t){return mxEvent.isShiftDown(t)},mxGraph.prototype.isIgnoreTerminalEvent=function(t){return!1},mxGraph.prototype.validationAlert=function(t){mxUtils.alert(t)},mxGraph.prototype.isEdgeValid=function(t,e,l){return null==this.getEdgeValidationError(t,e,l)},mxGraph.prototype.getEdgeValidationError=function(t,e,l){if(null!=t&&!this.isAllowDanglingEdges()&&(null==e||null==l))return"";if(null!=t&&null==this.model.getTerminal(t,!0)&&null==this.model.getTerminal(t,!1))return null;if(!this.allowLoops&&e==l&&null!=e)return"";if(!this.isValidConnection(e,l))return"";if(null!=e&&null!=l){var i="";if(!this.multigraph){var n=this.model.getEdgesBetween(e,l,!0);(n.length>1||1==n.length&&n[0]!=t)&&(i+=(mxResources.get(this.alreadyConnectedResource)||this.alreadyConnectedResource)+"\n")}var s=this.model.getDirectedEdgeCount(e,!0,t),o=this.model.getDirectedEdgeCount(l,!1,t);if(null!=this.multiplicities)for(var r=0;r<this.multiplicities.length;r++){var a;null!=(a=this.multiplicities[r].check(this,t,e,l,s,o))&&(i+=a)}return null!=(a=this.validateEdge(t,e,l))&&(i+=a),i.length>0?i:null}return this.allowDanglingEdges?null:""},mxGraph.prototype.validateEdge=function(t,e,l){return null},mxGraph.prototype.validateGraph=function(t,e){t=null!=t?t:this.model.getRoot(),e=null!=e?e:new Object;for(var l=!0,i=this.model.getChildCount(t),n=0;n<i;n++){var s=this.model.getChildAt(t,n),o=e;this.isValidRoot(s)&&(o=new Object);var r=this.validateGraph(s,o);null!=r?this.setCellWarning(s,r.replace(/\n/g,"<br>")):this.setCellWarning(s,null),l=l&&null==r}var a="";this.isCellCollapsed(t)&&!l&&(a+=(mxResources.get(this.containsValidationErrorsResource)||this.containsValidationErrorsResource)+"\n"),this.model.isEdge(t)?a+=this.getEdgeValidationError(t,this.model.getTerminal(t,!0),this.model.getTerminal(t,!1))||"":a+=this.getCellValidationError(t)||"";var h=this.validateCell(t,e);return null!=h&&(a+=h),null==this.model.getParent(t)&&this.view.validate(),a.length>0||!l?a:null},mxGraph.prototype.getCellValidationError=function(t){var e=this.model.getDirectedEdgeCount(t,!0),l=this.model.getDirectedEdgeCount(t,!1),i=this.model.getValue(t),n="";if(null!=this.multiplicities)for(var s=0;s<this.multiplicities.length;s++){var o=this.multiplicities[s];o.source&&mxUtils.isNode(i,o.type,o.attr,o.value)&&(e>o.max||e<o.min)?n+=o.countError+"\n":!o.source&&mxUtils.isNode(i,o.type,o.attr,o.value)&&(l>o.max||l<o.min)&&(n+=o.countError+"\n")}return n.length>0?n:null},mxGraph.prototype.validateCell=function(t,e){return null},mxGraph.prototype.getBackgroundImage=function(){return this.backgroundImage},mxGraph.prototype.setBackgroundImage=function(t){this.backgroundImage=t},mxGraph.prototype.getFoldingImage=function(t){if(null!=t&&this.foldingEnabled&&!this.getModel().isEdge(t.cell)){var e=this.isCellCollapsed(t.cell);if(this.isCellFoldable(t.cell,!e))return e?this.collapsedImage:this.expandedImage}return null},mxGraph.prototype.convertValueToString=function(t){var e=this.model.getValue(t);if(null!=e){if(mxUtils.isNode(e))return e.nodeName;if("function"==typeof e.toString)return e.toString()}return""},mxGraph.prototype.getLabel=function(t){var e="";if(this.labelsVisible&&null!=t){var l=this.getCurrentCellStyle(t);mxUtils.getValue(l,mxConstants.STYLE_NOLABEL,!1)||(e=this.convertValueToString(t))}return e},mxGraph.prototype.isHtmlLabel=function(t){return this.isHtmlLabels()},mxGraph.prototype.isHtmlLabels=function(){return this.htmlLabels},mxGraph.prototype.setHtmlLabels=function(t){this.htmlLabels=t},mxGraph.prototype.isWrapping=function(t){return"wrap"==this.getCurrentCellStyle(t)[mxConstants.STYLE_WHITE_SPACE]},mxGraph.prototype.isLabelClipped=function(t){return"hidden"==this.getCurrentCellStyle(t)[mxConstants.STYLE_OVERFLOW]},mxGraph.prototype.getTooltip=function(t,e,l,i){var n=null;if(null!=t){if(null==t.control||e!=t.control.node&&e.parentNode!=t.control.node||(n=this.collapseExpandResource,n=mxUtils.htmlEntities(mxResources.get(n)||n).replace(/\\n/g,"<br>")),null==n&&null!=t.overlays&&t.overlays.visit(function(t,l){null!=n||e!=l.node&&e.parentNode!=l.node||(n=l.overlay.toString())}),null==n){var s=this.selectionCellsHandler.getHandler(t.cell);null!=s&&"function"==typeof s.getTooltipForNode&&(n=s.getTooltipForNode(e))}null==n&&(n=this.getTooltipForCell(t.cell))}return n},mxGraph.prototype.getTooltipForCell=function(t){return null!=t&&null!=t.getTooltip?t.getTooltip():this.convertValueToString(t)},mxGraph.prototype.getCursorForMouseEvent=function(t){return this.getCursorForCell(t.getCell())},mxGraph.prototype.getCursorForCell=function(t){return null},mxGraph.prototype.getStartSize=function(t,e){var l=new mxRectangle,i=this.getCurrentCellStyle(t,e),n=parseInt(mxUtils.getValue(i,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));return mxUtils.getValue(i,mxConstants.STYLE_HORIZONTAL,!0)?l.height=n:l.width=n,l},mxGraph.prototype.getSwimlaneDirection=function(t){var e=mxUtils.getValue(t,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST),l=1==mxUtils.getValue(t,mxConstants.STYLE_FLIPH,0),i=1==mxUtils.getValue(t,mxConstants.STYLE_FLIPV,0),n=mxUtils.getValue(t,mxConstants.STYLE_HORIZONTAL,!0)?0:3;e==mxConstants.DIRECTION_NORTH?n--:e==mxConstants.DIRECTION_WEST?n+=2:e==mxConstants.DIRECTION_SOUTH&&(n+=1);var s=mxUtils.mod(n,2);return l&&1==s&&(n+=2),i&&0==s&&(n+=2),[mxConstants.DIRECTION_NORTH,mxConstants.DIRECTION_EAST,mxConstants.DIRECTION_SOUTH,mxConstants.DIRECTION_WEST][mxUtils.mod(n,4)]},mxGraph.prototype.getActualStartSize=function(t,e){var l=new mxRectangle;if(this.isSwimlane(t,e)){var i=this.getCurrentCellStyle(t,e),n=parseInt(mxUtils.getValue(i,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE)),s=this.getSwimlaneDirection(i);s==mxConstants.DIRECTION_NORTH?l.y=n:s==mxConstants.DIRECTION_WEST?l.x=n:s==mxConstants.DIRECTION_SOUTH?l.height=n:l.width=n}return l},mxGraph.prototype.getImage=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_IMAGE]:null},mxGraph.prototype.isTransparentState=function(t){var e=!1;if(null!=t){var l=mxUtils.getValue(t.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE),i=mxUtils.getValue(t.style,mxConstants.STYLE_FILLCOLOR,mxConstants.NONE);e=l==mxConstants.NONE&&i==mxConstants.NONE&&null==this.getImage(t)}return e},mxGraph.prototype.getVerticalAlign=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_VERTICAL_ALIGN]||mxConstants.ALIGN_MIDDLE:null},mxGraph.prototype.getIndicatorColor=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_INDICATOR_COLOR]:null},mxGraph.prototype.getIndicatorGradientColor=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_INDICATOR_GRADIENTCOLOR]:null},mxGraph.prototype.getIndicatorShape=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_INDICATOR_SHAPE]:null},mxGraph.prototype.getIndicatorImage=function(t){return null!=t&&null!=t.style?t.style[mxConstants.STYLE_INDICATOR_IMAGE]:null},mxGraph.prototype.getBorder=function(){return this.border},mxGraph.prototype.setBorder=function(t){this.border=t},mxGraph.prototype.isSwimlane=function(t,e){return null!=t&&this.model.getParent(t)!=this.model.getRoot()&&!this.model.isEdge(t)&&this.getCurrentCellStyle(t,e)[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_SWIMLANE},mxGraph.prototype.isResizeContainer=function(){return this.resizeContainer},mxGraph.prototype.setResizeContainer=function(t){this.resizeContainer=t},mxGraph.prototype.isEnabled=function(){return this.enabled},mxGraph.prototype.setEnabled=function(t){this.enabled=t},mxGraph.prototype.isEscapeEnabled=function(){return this.escapeEnabled},mxGraph.prototype.setEscapeEnabled=function(t){this.escapeEnabled=t},mxGraph.prototype.isInvokesStopCellEditing=function(){return this.invokesStopCellEditing},mxGraph.prototype.setInvokesStopCellEditing=function(t){this.invokesStopCellEditing=t},mxGraph.prototype.isEnterStopsCellEditing=function(){return this.enterStopsCellEditing},mxGraph.prototype.setEnterStopsCellEditing=function(t){this.enterStopsCellEditing=t},mxGraph.prototype.isCellLocked=function(t){var e=this.model.getGeometry(t);return this.isCellsLocked()||null!=e&&this.model.isVertex(t)&&e.relative},mxGraph.prototype.isCellsLocked=function(){return this.cellsLocked},mxGraph.prototype.setCellsLocked=function(t){this.cellsLocked=t},mxGraph.prototype.getCloneableCells=function(t){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.isCellCloneable(t)}))},mxGraph.prototype.isCellCloneable=function(t){var e=this.getCurrentCellStyle(t);return this.isCellsCloneable()&&0!=e[mxConstants.STYLE_CLONEABLE]},mxGraph.prototype.isCellsCloneable=function(){return this.cellsCloneable},mxGraph.prototype.setCellsCloneable=function(t){this.cellsCloneable=t},mxGraph.prototype.getExportableCells=function(t){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.canExportCell(t)}))},mxGraph.prototype.canExportCell=function(t){return this.exportEnabled},mxGraph.prototype.getImportableCells=function(t){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.canImportCell(t)}))},mxGraph.prototype.canImportCell=function(t){return this.importEnabled},mxGraph.prototype.isCellSelectable=function(t){return this.isCellsSelectable()},mxGraph.prototype.isCellsSelectable=function(){return this.cellsSelectable},mxGraph.prototype.setCellsSelectable=function(t){this.cellsSelectable=t},mxGraph.prototype.getDeletableCells=function(t){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.isCellDeletable(t)}))},mxGraph.prototype.isCellDeletable=function(t){var e=this.getCurrentCellStyle(t);return this.isCellsDeletable()&&0!=e[mxConstants.STYLE_DELETABLE]},mxGraph.prototype.isCellsDeletable=function(){return this.cellsDeletable},mxGraph.prototype.setCellsDeletable=function(t){this.cellsDeletable=t},mxGraph.prototype.isLabelMovable=function(t){return!this.isCellLocked(t)&&(this.model.isEdge(t)&&this.edgeLabelsMovable||this.model.isVertex(t)&&this.vertexLabelsMovable)},mxGraph.prototype.isCellRotatable=function(t){return 0!=this.getCurrentCellStyle(t)[mxConstants.STYLE_ROTATABLE]},mxGraph.prototype.getMovableCells=function(t){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.isCellMovable(t)}))},mxGraph.prototype.isCellMovable=function(t){var e=this.getCurrentCellStyle(t);return this.isCellsMovable()&&!this.isCellLocked(t)&&0!=e[mxConstants.STYLE_MOVABLE]},mxGraph.prototype.isCellsMovable=function(){return this.cellsMovable},mxGraph.prototype.setCellsMovable=function(t){this.cellsMovable=t},mxGraph.prototype.isGridEnabled=function(){return this.gridEnabled},mxGraph.prototype.setGridEnabled=function(t){this.gridEnabled=t},mxGraph.prototype.isPortsEnabled=function(){return this.portsEnabled},mxGraph.prototype.setPortsEnabled=function(t){this.portsEnabled=t},mxGraph.prototype.getGridSize=function(){return this.gridSize},mxGraph.prototype.setGridSize=function(t){this.gridSize=t},mxGraph.prototype.getTolerance=function(){return this.tolerance},mxGraph.prototype.setTolerance=function(t){this.tolerance=t},mxGraph.prototype.isVertexLabelsMovable=function(){return this.vertexLabelsMovable},mxGraph.prototype.setVertexLabelsMovable=function(t){this.vertexLabelsMovable=t},mxGraph.prototype.isEdgeLabelsMovable=function(){return this.edgeLabelsMovable},mxGraph.prototype.setEdgeLabelsMovable=function(t){this.edgeLabelsMovable=t},mxGraph.prototype.isSwimlaneNesting=function(){return this.swimlaneNesting},mxGraph.prototype.setSwimlaneNesting=function(t){this.swimlaneNesting=t},mxGraph.prototype.isSwimlaneSelectionEnabled=function(){return this.swimlaneSelectionEnabled},mxGraph.prototype.setSwimlaneSelectionEnabled=function(t){this.swimlaneSelectionEnabled=t},mxGraph.prototype.isMultigraph=function(){return this.multigraph},mxGraph.prototype.setMultigraph=function(t){this.multigraph=t},mxGraph.prototype.isAllowLoops=function(){return this.allowLoops},mxGraph.prototype.setAllowDanglingEdges=function(t){this.allowDanglingEdges=t},mxGraph.prototype.isAllowDanglingEdges=function(){return this.allowDanglingEdges},mxGraph.prototype.setConnectableEdges=function(t){this.connectableEdges=t},mxGraph.prototype.isConnectableEdges=function(){return this.connectableEdges},mxGraph.prototype.setCloneInvalidEdges=function(t){this.cloneInvalidEdges=t},mxGraph.prototype.isCloneInvalidEdges=function(){return this.cloneInvalidEdges},mxGraph.prototype.setAllowLoops=function(t){this.allowLoops=t},mxGraph.prototype.isDisconnectOnMove=function(){return this.disconnectOnMove},mxGraph.prototype.setDisconnectOnMove=function(t){this.disconnectOnMove=t},mxGraph.prototype.isDropEnabled=function(){return this.dropEnable},mxGraph.prototype.setDropEnabled=function(t){this.dropEnable=t},mxGraph.prototype.isSplitEnabled=function(){return this.splitEnabled},mxGraph.prototype.setSplitEnabled=function(t){this.splitEnabled=t},mxGraph.prototype.isCellResizable=function(t){var e=this.getCurrentCellStyle(t);return this.isCellsResizable()&&!this.isCellLocked(t)&&"0"!=mxUtils.getValue(e,mxConstants.STYLE_RESIZABLE,"1")},mxGraph.prototype.isCellsResizable=function(){return this.cellsResizable},mxGraph.prototype.setCellsResizable=function(t){this.cellsResizable=t},mxGraph.prototype.isTerminalPointMovable=function(t,e){return!0},mxGraph.prototype.isCellBendable=function(t){var e=this.getCurrentCellStyle(t);return this.isCellsBendable()&&!this.isCellLocked(t)&&0!=e[mxConstants.STYLE_BENDABLE]},mxGraph.prototype.isCellsBendable=function(){return this.cellsBendable},mxGraph.prototype.setCellsBendable=function(t){this.cellsBendable=t},mxGraph.prototype.isCellEditable=function(t){var e=this.getCurrentCellStyle(t);return this.isCellsEditable()&&!this.isCellLocked(t)&&0!=e[mxConstants.STYLE_EDITABLE]},mxGraph.prototype.isCellsEditable=function(){return this.cellsEditable},mxGraph.prototype.setCellsEditable=function(t){this.cellsEditable=t},mxGraph.prototype.isCellDisconnectable=function(t,e,l){return this.isCellsDisconnectable()&&!this.isCellLocked(t)},mxGraph.prototype.isCellsDisconnectable=function(){return this.cellsDisconnectable},mxGraph.prototype.setCellsDisconnectable=function(t){this.cellsDisconnectable=t},mxGraph.prototype.isValidSource=function(t){return null==t&&this.allowDanglingEdges||null!=t&&(!this.model.isEdge(t)||this.connectableEdges)&&this.isCellConnectable(t)},mxGraph.prototype.isValidTarget=function(t){return this.isValidSource(t)},mxGraph.prototype.isValidConnection=function(t,e){return this.isValidSource(t)&&this.isValidTarget(e)},mxGraph.prototype.setConnectable=function(t){this.connectionHandler.setEnabled(t)},mxGraph.prototype.isConnectable=function(){return this.connectionHandler.isEnabled()},mxGraph.prototype.setTooltips=function(t){this.tooltipHandler.setEnabled(t)},mxGraph.prototype.setPanning=function(t){this.panningHandler.panningEnabled=t},mxGraph.prototype.isEditing=function(t){if(null!=this.cellEditor){var e=this.cellEditor.getEditingCell();return null==t?null!=e:t==e}return!1},mxGraph.prototype.isAutoSizeCell=function(t){var e=this.getCurrentCellStyle(t);return this.isAutoSizeCells()||1==e[mxConstants.STYLE_AUTOSIZE]},mxGraph.prototype.isAutoSizeCells=function(){return this.autoSizeCells},mxGraph.prototype.setAutoSizeCells=function(t){this.autoSizeCells=t},mxGraph.prototype.isExtendParent=function(t){return!this.getModel().isEdge(t)&&this.isExtendParents()},mxGraph.prototype.isExtendParents=function(){return this.extendParents},mxGraph.prototype.setExtendParents=function(t){this.extendParents=t},mxGraph.prototype.isExtendParentsOnAdd=function(t){return this.extendParentsOnAdd},mxGraph.prototype.setExtendParentsOnAdd=function(t){this.extendParentsOnAdd=t},mxGraph.prototype.isExtendParentsOnMove=function(){return this.extendParentsOnMove},mxGraph.prototype.setExtendParentsOnMove=function(t){this.extendParentsOnMove=t},mxGraph.prototype.isRecursiveResize=function(t){return this.recursiveResize},mxGraph.prototype.setRecursiveResize=function(t){this.recursiveResize=t},mxGraph.prototype.isConstrainChild=function(t){return this.isConstrainChildren()&&!this.getModel().isEdge(this.getModel().getParent(t))},mxGraph.prototype.isConstrainChildren=function(){return this.constrainChildren},mxGraph.prototype.setConstrainChildren=function(t){this.constrainChildren=t},mxGraph.prototype.isConstrainRelativeChildren=function(){return this.constrainRelativeChildren},mxGraph.prototype.setConstrainRelativeChildren=function(t){this.constrainRelativeChildren=t},mxGraph.prototype.isAllowNegativeCoordinates=function(){return this.allowNegativeCoordinates},mxGraph.prototype.setAllowNegativeCoordinates=function(t){this.allowNegativeCoordinates=t},mxGraph.prototype.getOverlap=function(t){return this.isAllowOverlapParent(t)?this.defaultOverlap:0},mxGraph.prototype.isAllowOverlapParent=function(t){return!1},mxGraph.prototype.getFoldableCells=function(t,e){return this.model.filterCells(t,mxUtils.bind(this,function(t){return this.isCellFoldable(t,e)}))},mxGraph.prototype.isCellFoldable=function(t,e){var l=this.getCurrentCellStyle(t);return this.model.getChildCount(t)>0&&0!=l[mxConstants.STYLE_FOLDABLE]},mxGraph.prototype.isValidDropTarget=function(t,e,l){return null!=t&&(this.isSplitEnabled()&&this.isSplitTarget(t,e,l)||!this.model.isEdge(t)&&(this.isSwimlane(t)||this.model.getChildCount(t)>0&&!this.isCellCollapsed(t)))},mxGraph.prototype.isSplitTarget=function(t,e,l){if(this.model.isEdge(t)&&null!=e&&1==e.length&&this.isCellConnectable(e[0])&&null==this.getEdgeValidationError(t,this.model.getTerminal(t,!0),e[0])){var i=this.model.getTerminal(t,!0),n=this.model.getTerminal(t,!1);return!this.model.isAncestor(e[0],i)&&!this.model.isAncestor(e[0],n)}return!1},mxGraph.prototype.getDropTarget=function(t,e,l,i){if(!this.isSwimlaneNesting())for(var n=0;n<t.length;n++)if(this.isSwimlane(t[n]))return null;var s=mxUtils.convertPoint(this.container,mxEvent.getClientX(e),mxEvent.getClientY(e));s.x-=this.panDx,s.y-=this.panDy;var o=this.getSwimlaneAt(s.x,s.y);if(null==l)l=o;else if(null!=o){for(var r=this.model.getParent(o);null!=r&&this.isSwimlane(r)&&r!=l;)r=this.model.getParent(r);r==l&&(l=o)}for(;null!=l&&!this.isValidDropTarget(l,t,e)&&!this.model.isLayer(l);)l=this.model.getParent(l);if(null==i||!i)for(var a=l;null!=a&&mxUtils.indexOf(t,a)<0;)a=this.model.getParent(a);return this.model.isLayer(l)||null!=a?null:l},mxGraph.prototype.getDefaultParent=function(){var t=this.getCurrentRoot();if(null==t&&null==(t=this.defaultParent)){var e=this.model.getRoot();t=this.model.getChildAt(e,0)}return t},mxGraph.prototype.setDefaultParent=function(t){this.defaultParent=t},mxGraph.prototype.getSwimlane=function(t){for(;null!=t&&!this.isSwimlane(t);)t=this.model.getParent(t);return t},mxGraph.prototype.getSwimlaneAt=function(t,e,l){if(null==l&&null==(l=this.getCurrentRoot())&&(l=this.model.getRoot()),null!=l)for(var i=this.model.getChildCount(l),n=0;n<i;n++){var s=this.model.getChildAt(l,n);if(null!=s){var o=this.getSwimlaneAt(t,e,s);if(null!=o)return o;if(this.isCellVisible(s)&&this.isSwimlane(s)){var r=this.view.getState(s);if(this.intersects(r,t,e))return s}}}return null},mxGraph.prototype.getCellAt=function(t,e,l,i,n,s){if(i=null==i||i,n=null==n||n,null==l&&null==(l=this.getCurrentRoot())&&(l=this.getModel().getRoot()),null!=l)for(var o=this.model.getChildCount(l)-1;o>=0;o--){var r=this.model.getChildAt(l,o),a=this.getCellAt(t,e,r,i,n,s);if(null!=a)return a;if(this.isCellVisible(r)&&(n&&this.model.isEdge(r)||i&&this.model.isVertex(r))){var h=this.view.getState(r);if(null!=h&&(null==s||!s(h,t,e))&&this.intersects(h,t,e))return r}}return null},mxGraph.prototype.intersects=function(t,e,l){if(null!=t){var i=t.absolutePoints;if(null!=i)for(var n=this.tolerance*this.tolerance,s=i[0],o=1;o<i.length;o++){var r=i[o];if(mxUtils.ptSegDistSq(s.x,s.y,r.x,r.y,e,l)<=n)return!0;s=r}else{var a=mxUtils.toRadians(mxUtils.getValue(t.style,mxConstants.STYLE_ROTATION)||0);if(0!=a){var h=Math.cos(-a),p=Math.sin(-a),u=new mxPoint(t.getCenterX(),t.getCenterY());e=(s=mxUtils.getRotatedPoint(new mxPoint(e,l),h,p,u)).x,l=s.y}if(mxUtils.contains(t,e,l))return!0}}return!1},mxGraph.prototype.hitsSwimlaneContent=function(t,e,l){var i=this.getView().getState(t),n=this.getStartSize(t);if(null!=i){var s=this.getView().getScale();if(e-=i.x,l-=i.y,n.width>0&&e>0&&e>n.width*s)return!0;if(n.height>0&&l>0&&l>n.height*s)return!0}return!1},mxGraph.prototype.getChildVertices=function(t){return this.getChildCells(t,!0,!1)},mxGraph.prototype.getChildEdges=function(t){return this.getChildCells(t,!1,!0)},mxGraph.prototype.getChildCells=function(t,e,l){t=null!=t?t:this.getDefaultParent(),e=null!=e&&e,l=null!=l&&l;for(var i=this.model.getChildCells(t,e,l),n=[],s=0;s<i.length;s++)this.isCellVisible(i[s])&&n.push(i[s]);return n},mxGraph.prototype.getConnections=function(t,e){return this.getEdges(t,e,!0,!0,!1)},mxGraph.prototype.getIncomingEdges=function(t,e){return this.getEdges(t,e,!0,!1,!1)},mxGraph.prototype.getOutgoingEdges=function(t,e){return this.getEdges(t,e,!1,!0,!1)},mxGraph.prototype.getEdges=function(t,e,l,i,n,s){l=null==l||l,i=null==i||i,n=null==n||n,s=null!=s&&s;for(var o=[],r=this.isCellCollapsed(t),a=this.model.getChildCount(t),h=0;h<a;h++){var p=this.model.getChildAt(t,h);!r&&this.isCellVisible(p)||(o=o.concat(this.model.getEdges(p,l,i)))}o=o.concat(this.model.getEdges(t,l,i));var u=[];for(h=0;h<o.length;h++){var m=this.view.getState(o[h]),d=null!=m?m.getVisibleTerminal(!0):this.view.getVisibleTerminal(o[h],!0),c=null!=m?m.getVisibleTerminal(!1):this.view.getVisibleTerminal(o[h],!1);(n&&d==c||d!=c&&(l&&c==t&&(null==e||this.isValidAncestor(d,e,s))||i&&d==t&&(null==e||this.isValidAncestor(c,e,s))))&&u.push(o[h])}return u},mxGraph.prototype.isValidAncestor=function(t,e,l){return l?this.model.isAncestor(e,t):this.model.getParent(t)==e},mxGraph.prototype.getOpposites=function(t,e,l,i){l=null==l||l,i=null==i||i;var n=[],s=new mxDictionary;if(null!=t)for(var o=0;o<t.length;o++){var r=this.view.getState(t[o]),a=null!=r?r.getVisibleTerminal(!0):this.view.getVisibleTerminal(t[o],!0),h=null!=r?r.getVisibleTerminal(!1):this.view.getVisibleTerminal(t[o],!1);a==e&&null!=h&&h!=e&&i?s.get(h)||(s.put(h,!0),n.push(h)):h==e&&null!=a&&a!=e&&l&&(s.get(a)||(s.put(a,!0),n.push(a)))}return n},mxGraph.prototype.getEdgesBetween=function(t,e,l){l=null!=l&&l;for(var i=this.getEdges(t),n=[],s=0;s<i.length;s++){var o=this.view.getState(i[s]),r=null!=o?o.getVisibleTerminal(!0):this.view.getVisibleTerminal(i[s],!0),a=null!=o?o.getVisibleTerminal(!1):this.view.getVisibleTerminal(i[s],!1);(r==t&&a==e||!l&&r==e&&a==t)&&n.push(i[s])}return n},mxGraph.prototype.getPointForEvent=function(t,e){var l=mxUtils.convertPoint(this.container,mxEvent.getClientX(t),mxEvent.getClientY(t)),i=this.view.scale,n=this.view.translate,s=0!=e?this.gridSize/2:0;return l.x=this.snap(l.x/i-n.x-s),l.y=this.snap(l.y/i-n.y-s),l},mxGraph.prototype.getCells=function(t,e,l,i,n,s){if(s=null!=s?s:[],l>0||i>0){var o=this.getModel(),r=t+l,a=e+i;if(null==n&&null==(n=this.getCurrentRoot())&&(n=o.getRoot()),null!=n)for(var h=o.getChildCount(n),p=0;p<h;p++){var u=o.getChildAt(n,p),m=this.view.getState(u);if(null!=m&&this.isCellVisible(u)){var d=mxUtils.getValue(m.style,mxConstants.STYLE_ROTATION)||0,c=m;0!=d&&(c=mxUtils.getBoundingBox(c,d)),(o.isEdge(u)||o.isVertex(u))&&c.x>=t&&c.y+c.height<=a&&c.y>=e&&c.x+c.width<=r?s.push(u):this.getCells(t,e,l,i,u,s)}}}return s},mxGraph.prototype.getCellsBeyond=function(t,e,l,i,n){var s=[];if((i||n)&&(null==l&&(l=this.getDefaultParent()),null!=l))for(var o=this.model.getChildCount(l),r=0;r<o;r++){var a=this.model.getChildAt(l,r),h=this.view.getState(a);this.isCellVisible(a)&&null!=h&&(!i||h.x>=t)&&(!n||h.y>=e)&&s.push(a)}return s},mxGraph.prototype.findTreeRoots=function(t,e,l){e=null!=e&&e,l=null!=l&&l;var i=[];if(null!=t){for(var n=this.getModel(),s=n.getChildCount(t),o=null,r=0,a=0;a<s;a++){var h=n.getChildAt(t,a);if(this.model.isVertex(h)&&this.isCellVisible(h)){for(var p=this.getConnections(h,e?t:null),u=0,m=0,d=0;d<p.length;d++){this.view.getVisibleTerminal(p[d],!0)==h?u++:m++}(l&&0==u&&m>0||!l&&0==m&&u>0)&&i.push(h);var c=l?m-u:u-m;c>r&&(r=c,o=h)}}0==i.length&&null!=o&&i.push(o)}return i},mxGraph.prototype.traverse=function(t,e,l,i,n,s){if(null!=l&&null!=t&&(e=null==e||e,s=null!=s&&s,!(n=n||new mxDictionary).get(t))){n.put(t,!0);var o=l(t,i);if(null==o||o){var r=this.model.getEdgeCount(t);if(r>0)for(var a=0;a<r;a++){var h=this.model.getEdgeAt(t,a),p=this.model.getTerminal(h,!0)==t;if(!e||!s==p){var u=this.model.getTerminal(h,!p);this.traverse(u,e,l,h,n,s)}}}}},mxGraph.prototype.isCellSelected=function(t){return this.getSelectionModel().isSelected(t)},mxGraph.prototype.isSelectionEmpty=function(){return this.getSelectionModel().isEmpty()},mxGraph.prototype.clearSelection=function(){return this.getSelectionModel().clear()},mxGraph.prototype.getSelectionCount=function(){return this.getSelectionModel().cells.length},mxGraph.prototype.getSelectionCell=function(){return this.getSelectionModel().cells[0]},mxGraph.prototype.getSelectionCells=function(){return this.getSelectionModel().cells.slice()},mxGraph.prototype.setSelectionCell=function(t){this.getSelectionModel().setCell(t)},mxGraph.prototype.setSelectionCells=function(t){this.getSelectionModel().setCells(t)},mxGraph.prototype.addSelectionCell=function(t){this.getSelectionModel().addCell(t)},mxGraph.prototype.addSelectionCells=function(t){this.getSelectionModel().addCells(t)},mxGraph.prototype.removeSelectionCell=function(t){this.getSelectionModel().removeCell(t)},mxGraph.prototype.removeSelectionCells=function(t){this.getSelectionModel().removeCells(t)},mxGraph.prototype.selectRegion=function(t,e){var l=this.getCells(t.x,t.y,t.width,t.height);return this.selectCellsForEvent(l,e),l},mxGraph.prototype.selectNextCell=function(){this.selectCell(!0)},mxGraph.prototype.selectPreviousCell=function(){this.selectCell()},mxGraph.prototype.selectParentCell=function(){this.selectCell(!1,!0)},mxGraph.prototype.selectChildCell=function(){this.selectCell(!1,!1,!0)},mxGraph.prototype.selectCell=function(t,e,l){var i=this.selectionModel,n=i.cells.length>0?i.cells[0]:null;i.cells.length>1&&i.clear();var s=null!=n?this.model.getParent(n):this.getDefaultParent(),o=this.model.getChildCount(s);if(null==n&&o>0){var r=this.model.getChildAt(s,0);this.setSelectionCell(r)}else if(null!=n&&!e||null==this.view.getState(s)||null==this.model.getGeometry(s)){if(null!=n&&l){if(this.model.getChildCount(n)>0){r=this.model.getChildAt(n,0);this.setSelectionCell(r)}}else if(o>0){var a=s.getIndex(n);if(t){a++;r=this.model.getChildAt(s,a%o);this.setSelectionCell(r)}else{var h=--a<0?o-1:a;r=this.model.getChildAt(s,h);this.setSelectionCell(r)}}}else this.getCurrentRoot()!=s&&this.setSelectionCell(s)},mxGraph.prototype.selectAll=function(t,e){t=t||this.getDefaultParent();var l=e?this.model.filterDescendants(mxUtils.bind(this,function(e){return e!=t&&null!=this.view.getState(e)}),t):this.model.getChildren(t);null!=l&&this.setSelectionCells(l)},mxGraph.prototype.selectVertices=function(t,e){this.selectCells(!0,!1,t,e)},mxGraph.prototype.selectEdges=function(t){this.selectCells(!1,!0,t)},mxGraph.prototype.selectCells=function(t,e,l,i){l=l||this.getDefaultParent();var n=mxUtils.bind(this,function(l){return null!=this.view.getState(l)&&((i||0==this.model.getChildCount(l))&&this.model.isVertex(l)&&t&&!this.model.isEdge(this.model.getParent(l))||this.model.isEdge(l)&&e)}),s=this.model.filterDescendants(n,l);null!=s&&this.setSelectionCells(s)},mxGraph.prototype.selectCellForEvent=function(t,e){var l=this.isCellSelected(t);this.isToggleEvent(e)?l?this.removeSelectionCell(t):this.addSelectionCell(t):l&&1==this.getSelectionCount()||this.setSelectionCell(t)},mxGraph.prototype.selectCellsForEvent=function(t,e){this.isToggleEvent(e)?this.addSelectionCells(t):this.setSelectionCells(t)},mxGraph.prototype.createHandler=function(t){var e=null;if(null!=t)if(this.model.isEdge(t.cell)){var l=t.getVisibleTerminalState(!0),i=t.getVisibleTerminalState(!1),n=this.getCellGeometry(t.cell),s=this.view.getEdgeStyle(t,null!=n?n.points:null,l,i);e=this.createEdgeHandler(t,s)}else e=this.createVertexHandler(t);return e},mxGraph.prototype.createVertexHandler=function(t){return new mxVertexHandler(t)},mxGraph.prototype.createEdgeHandler=function(t,e){return e==mxEdgeStyle.Loop||e==mxEdgeStyle.ElbowConnector||e==mxEdgeStyle.SideToSide||e==mxEdgeStyle.TopToBottom?this.createElbowEdgeHandler(t):e==mxEdgeStyle.SegmentConnector||e==mxEdgeStyle.OrthConnector?this.createEdgeSegmentHandler(t):new mxEdgeHandler(t)},mxGraph.prototype.createEdgeSegmentHandler=function(t){return new mxEdgeSegmentHandler(t)},mxGraph.prototype.createElbowEdgeHandler=function(t){return new mxElbowEdgeHandler(t)},mxGraph.prototype.addMouseListener=function(t){null==this.mouseListeners&&(this.mouseListeners=[]),this.mouseListeners.push(t)},mxGraph.prototype.removeMouseListener=function(t){if(null!=this.mouseListeners)for(var e=0;e<this.mouseListeners.length;e++)if(this.mouseListeners[e]==t){this.mouseListeners.splice(e,1);break}},mxGraph.prototype.updateMouseEvent=function(t,e){if(null==t.graphX||null==t.graphY){var l=mxUtils.convertPoint(this.container,t.getX(),t.getY());t.graphX=l.x-this.panDx,t.graphY=l.y-this.panDy,null==t.getCell()&&this.isMouseDown&&e==mxEvent.MOUSE_MOVE&&(t.state=this.view.getState(this.getCellAt(l.x,l.y,null,null,null,function(t){return null==t.shape||t.shape.paintBackground!=mxRectangleShape.prototype.paintBackground||"1"==mxUtils.getValue(t.style,mxConstants.STYLE_POINTER_EVENTS,"1")||null!=t.shape.fill&&t.shape.fill!=mxConstants.NONE})))}return t},mxGraph.prototype.getStateForTouchEvent=function(t){var e=mxEvent.getClientX(t),l=mxEvent.getClientY(t),i=mxUtils.convertPoint(this.container,e,l);return this.view.getState(this.getCellAt(i.x,i.y))},mxGraph.prototype.isEventIgnored=function(t,e,l){var i=mxEvent.isMouseEvent(e.getEvent()),n=!1;return e.getEvent()==this.lastEvent?n=!0:this.lastEvent=e.getEvent(),null!=this.eventSource&&t!=mxEvent.MOUSE_MOVE?(mxEvent.removeGestureListeners(this.eventSource,null,this.mouseMoveRedirect,this.mouseUpRedirect),this.mouseMoveRedirect=null,this.mouseUpRedirect=null,this.eventSource=null):GE.IS_GC||null==this.eventSource||e.getSource()==this.eventSource||(n=!0),this.isSyntheticEventIgnored(t,e,l)&&(n=!0),!mxEvent.isPopupTrigger(this.lastEvent)&&t!=mxEvent.MOUSE_MOVE&&2==this.lastEvent.detail||(t==mxEvent.MOUSE_UP&&this.isMouseDown?this.isMouseDown=!1:t!=mxEvent.MOUSE_DOWN||this.isMouseDown?!n&&((!GE.IS_FF||t!=mxEvent.MOUSE_MOVE)&&this.isMouseDown&&this.isMouseTrigger!=i||t==mxEvent.MOUSE_DOWN&&this.isMouseDown||t==mxEvent.MOUSE_UP&&!this.isMouseDown)&&(n=!0):(this.isMouseDown=!0,this.isMouseTrigger=i),n||t!=mxEvent.MOUSE_DOWN||(this.lastMouseX=e.getX(),this.lastMouseY=e.getY()),n)},mxGraph.prototype.isSyntheticEventIgnored=function(t,e,l){var i=!1,n=mxEvent.isMouseEvent(e.getEvent());return this.ignoreMouseEvents&&n&&t!=mxEvent.MOUSE_MOVE?(this.ignoreMouseEvents=t!=mxEvent.MOUSE_UP,i=!0):GE.IS_FF&&!n&&t==mxEvent.MOUSE_UP&&(this.ignoreMouseEvents=!0),i},mxGraph.prototype.isEventSourceIgnored=function(t,e){var l=e.getSource(),i=null!=l.nodeName?l.nodeName.toLowerCase():"",n=!mxEvent.isMouseEvent(e.getEvent())||mxEvent.isLeftMouseButton(e.getEvent());return t==mxEvent.MOUSE_DOWN&&n&&("select"==i||"option"==i||"input"==i&&"checkbox"!=l.type&&"radio"!=l.type&&"button"!=l.type&&"submit"!=l.type&&"file"!=l.type)},mxGraph.prototype.getEventState=function(t){return t},mxGraph.prototype.fireMouseEvent=function(t,e,l){if(this.isEventSourceIgnored(t,e))null!=this.tooltipHandler&&this.tooltipHandler.hide();else{if(null==l&&(l=this),e=this.updateMouseEvent(e,t),!this.nativeDblClickEnabled&&!mxEvent.isPopupTrigger(e.getEvent())||this.doubleTapEnabled&&(mxEvent.isTouchEvent(e.getEvent())||mxEvent.isPenEvent(e.getEvent()))){var i=(new Date).getTime();if(t==mxEvent.MOUSE_DOWN){if(null!=this.lastTouchEvent&&this.lastTouchEvent!=e.getEvent()&&i-this.lastTouchTime<this.doubleTapTimeout&&Math.abs(this.lastTouchX-e.getX())<this.doubleTapTolerance&&Math.abs(this.lastTouchY-e.getY())<this.doubleTapTolerance&&this.doubleClickCounter<2){this.doubleClickCounter++;if(t==mxEvent.MOUSE_UP){if(e.getCell()==this.lastTouchCell&&null!=this.lastTouchCell){this.lastTouchTime=0;var n=this.lastTouchCell;this.lastTouchCell=null,this.dblClick(e.getEvent(),n),!0}}else this.fireDoubleClick=!0,this.lastTouchTime=0;return void mxEvent.consume(e.getEvent())}null!=this.lastTouchEvent&&this.lastTouchEvent==e.getEvent()||(this.lastTouchCell=e.getCell(),this.lastTouchX=e.getX(),this.lastTouchY=e.getY(),this.lastTouchTime=i,this.lastTouchEvent=e.getEvent(),this.doubleClickCounter=0)}else if((this.isMouseDown||t==mxEvent.MOUSE_UP)&&this.fireDoubleClick){this.fireDoubleClick=!1;n=this.lastTouchCell;return this.lastTouchCell=null,this.isMouseDown=!1,void((null!=n||(mxEvent.isTouchEvent(e.getEvent())||mxEvent.isPenEvent(e.getEvent()))&&(GE.IS_GC||GE.IS_SF))&&Math.abs(this.lastTouchX-e.getX())<this.doubleTapTolerance&&Math.abs(this.lastTouchY-e.getY())<this.doubleTapTolerance?this.dblClick(e.getEvent(),n):mxEvent.consume(e.getEvent()))}}if(!this.isEventIgnored(t,e,l)){if(e.state=this.getEventState(e.getState()),this.fireEvent(new mxEventObject(mxEvent.FIRE_MOUSE_EVENT,"eventName",t,"event",e)),GE.IS_OP||GE.IS_SF||GE.IS_GC||GE.IS_IE11||e.getEvent().target!=this.container){if(t==mxEvent.MOUSE_MOVE&&this.isMouseDown&&this.autoScroll&&!mxEvent.isMultiTouchEvent(e.getEvent))this.scrollPointToVisible(e.getGraphX(),e.getGraphY(),this.autoExtend);else if(t==mxEvent.MOUSE_UP&&this.ignoreScrollbars&&this.translateToScrollPosition&&(0!=this.container.scrollLeft||0!=this.container.scrollTop)){var s=this.view.scale,o=this.view.translate;this.view.setTranslate(o.x-this.container.scrollLeft/s,o.y-this.container.scrollTop/s),this.container.scrollLeft=0,this.container.scrollTop=0}if(null!=this.mouseListeners){var r=[l,e];e.getEvent().preventDefault||(e.getEvent().returnValue=!0);for(var a=0;a<this.mouseListeners.length;a++){var h=this.mouseListeners[a];t==mxEvent.MOUSE_DOWN?h.mouseDown.apply(h,r):t==mxEvent.MOUSE_MOVE?h.mouseMove.apply(h,r):t==mxEvent.MOUSE_UP&&h.mouseUp.apply(h,r)}}t==mxEvent.MOUSE_UP&&this.click(e)}if((mxEvent.isTouchEvent(e.getEvent())||mxEvent.isPenEvent(e.getEvent()))&&t==mxEvent.MOUSE_DOWN&&this.tapAndHoldEnabled&&!this.tapAndHoldInProgress){this.tapAndHoldInProgress=!0,this.initialTouchX=e.getGraphX(),this.initialTouchY=e.getGraphY();this.tapAndHoldThread&&window.clearTimeout(this.tapAndHoldThread),this.tapAndHoldThread=window.setTimeout(mxUtils.bind(this,function(){this.tapAndHoldValid&&this.tapAndHold(e),this.tapAndHoldInProgress=!1,this.tapAndHoldValid=!1}),this.tapAndHoldDelay),this.tapAndHoldValid=!0}else t==mxEvent.MOUSE_UP?(this.tapAndHoldInProgress=!1,this.tapAndHoldValid=!1):this.tapAndHoldValid&&(this.tapAndHoldValid=Math.abs(this.initialTouchX-e.getGraphX())<this.tolerance&&Math.abs(this.initialTouchY-e.getGraphY())<this.tolerance);t==mxEvent.MOUSE_DOWN&&this.isEditing()&&!this.cellEditor.isEventSource(e.getEvent())&&this.stopEditing(!this.isInvokesStopCellEditing()),this.consumeMouseEvent(t,e,l)}}},mxGraph.prototype.consumeMouseEvent=function(t,e,l){t==mxEvent.MOUSE_DOWN&&mxEvent.isTouchEvent(e.getEvent())&&e.consume(!1)},mxGraph.prototype.fireGestureEvent=function(t,e){this.lastTouchTime=0,this.fireEvent(new mxEventObject(mxEvent.GESTURE,"event",t,"cell",e))},mxGraph.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,null!=this.tooltipHandler&&this.tooltipHandler.destroy(),null!=this.selectionCellsHandler&&this.selectionCellsHandler.destroy(),null!=this.panningHandler&&this.panningHandler.destroy(),null!=this.popupMenuHandler&&this.popupMenuHandler.destroy(),null!=this.connectionHandler&&this.connectionHandler.destroy(),null!=this.graphHandler&&this.graphHandler.destroy(),null!=this.cellEditor&&this.cellEditor.destroy(),null!=this.view&&this.view.destroy(),null!=this.model&&null!=this.graphModelChangeListener&&(this.model.removeListener(this.graphModelChangeListener),this.graphModelChangeListener=null),this.container=null)};