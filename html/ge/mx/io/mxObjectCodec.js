function mxObjectCodec(e,t,o){this.template=e,this.exclude=null!=t?t:[],this.idrefs=null!=o?o:[]}mxObjectCodec.allowEval=!1,mxObjectCodec.prototype.template=null,mxObjectCodec.prototype.exclude=null,mxObjectCodec.prototype.idrefs=null,mxObjectCodec.prototype.getName=function(){return mxUtils.getFunctionName(this.template.constructor)},mxObjectCodec.prototype.cloneTemplate=function(){return new this.template.constructor},mxObjectCodec.prototype.isExcluded=function(e,t,o,n){return t==mxObjectIdentity.FIELD_NAME||mxUtils.indexOf(this.exclude,t)>=0},mxObjectCodec.prototype.isReference=function(e,t,o,n){return mxUtils.indexOf(this.idrefs,t)>=0},mxObjectCodec.prototype.encode=function(e,t){var o=e.document.createElement(this.getName());return t=this.beforeEncode(e,t,o),this.encodeObject(e,t,o),this.afterEncode(e,t,o)},mxObjectCodec.prototype.encodeObject=function(e,t,o){for(var n in e.setAttribute(o,"id",e.getId(t)),t){var c=n,r=t[c];null==r||this.isExcluded(t,c,r,!0)||(mxUtils.isInteger(c)&&(c=null),this.encodeValue(e,t,c,r,o))}},mxObjectCodec.prototype.encodeValue=function(e,t,o,n,c){if(null!=n){if(this.isReference(t,o,n,!0)){var r=e.getId(n);if(null==r)return void mxLog.warn("mxObjectCodec.encode: No ID for "+this.getName()+"."+o+"="+n);n=r}var i=this.template[o];(null==o||e.encodeDefaults||i!=n)&&this.writeAttribute(e,t,o,n,c)}},mxObjectCodec.prototype.writeAttribute=function(e,t,o,n,c){"object"!=typeof n?this.writePrimitiveAttribute(e,t,o,n,c):this.writeComplexAttribute(e,t,o,n,c)},mxObjectCodec.prototype.writePrimitiveAttribute=function(e,t,o,n,c){if(n=this.convertAttributeToXml(e,t,o,n,c),null==o){var r=e.document.createElement("add");"function"==typeof n?r.appendChild(e.document.createTextNode(n)):e.setAttribute(r,"value",n),c.appendChild(r)}else"function"!=typeof n&&e.setAttribute(c,o,n)},mxObjectCodec.prototype.writeComplexAttribute=function(e,t,o,n,c){var r=e.encode(n);null!=r?(null!=o&&r.setAttribute("as",o),c.appendChild(r)):mxLog.warn("mxObjectCodec.encode: No node for "+this.getName()+"."+o+": "+n)},mxObjectCodec.prototype.convertAttributeToXml=function(e,t,o,n){return this.isBooleanAttribute(e,t,o,n)&&(n=1==n?"1":"0"),n},mxObjectCodec.prototype.isBooleanAttribute=function(e,t,o,n){return void 0===n.length&&(1==n||0==n)},mxObjectCodec.prototype.convertAttributeFromXml=function(e,t,o){var n=t.value;return this.isNumericAttribute(e,t,o)&&(n=parseFloat(n),!isNaN(n)&&isFinite(n)||(n=0)),n},mxObjectCodec.prototype.isNumericAttribute=function(e,t,o){return o.constructor==mxGeometry&&("x"==t.name||"y"==t.name||"width"==t.name||"height"==t.name)||o.constructor==mxPoint&&("x"==t.name||"y"==t.name)||mxUtils.isNumeric(t.value)},mxObjectCodec.prototype.beforeEncode=function(e,t,o){return t},mxObjectCodec.prototype.afterEncode=function(e,t,o){return o},mxObjectCodec.prototype.decode=function(e,t,o){var n=t.getAttribute("id"),c=e.objects[n];return null==c&&(c=o||this.cloneTemplate(),null!=n&&e.putObject(n,c)),t=this.beforeDecode(e,t,c),this.decodeNode(e,t,c),this.afterDecode(e,t,c)},mxObjectCodec.prototype.decodeNode=function(e,t,o){null!=t&&(this.decodeAttributes(e,t,o),this.decodeChildren(e,t,o))},mxObjectCodec.prototype.decodeAttributes=function(e,t,o){var n=t.attributes;if(null!=n)for(var c=0;c<n.length;c++)this.decodeAttribute(e,n[c],o)},mxObjectCodec.prototype.isIgnoredAttribute=function(e,t,o){return"as"==t.nodeName||"id"==t.nodeName},mxObjectCodec.prototype.decodeAttribute=function(e,t,o){if(!this.isIgnoredAttribute(e,t,o)){var n=t.nodeName,c=this.convertAttributeFromXml(e,t,o),r=n;if(this.isReference(o,r,c,!1)){var i=e.getObject(c);if(null==i)return void mxLog.warn("mxObjectCodec.decode: No object for "+this.getName()+"."+n+"="+c);c=i}this.isExcluded(o,n,c,!1)||(o[n]=c)}},mxObjectCodec.prototype.decodeChildren=function(e,t,o){for(var n=t.firstChild;null!=n;){var c=n.nextSibling;n.nodeType!=mxConstants.NODETYPE_ELEMENT||this.processInclude(e,n,o)||this.decodeChild(e,n,o),n=c}},mxObjectCodec.prototype.decodeChild=function(e,t,o){var n=t.getAttribute("as");if(null==n||!this.isExcluded(o,n,t,!1)){var c=this.getFieldTemplate(o,n,t),r=null;"add"==t.nodeName?null==(r=t.getAttribute("value"))&&mxObjectCodec.allowEval&&(r=mxUtils.eval(mxUtils.getTextContent(t))):r=e.decode(t,c);try{this.addObjectValue(o,n,r,c)}catch(e){throw new Error(e.message+" for "+t.nodeName)}}},mxObjectCodec.prototype.getFieldTemplate=function(e,t,o){var n=e[t];return n instanceof Array&&n.length>0&&(n=null),n},mxObjectCodec.prototype.addObjectValue=function(e,t,o,n){null!=o&&o!=n&&(null!=t&&t.length>0?e[t]=o:e.push(o))},mxObjectCodec.prototype.processInclude=function(e,t,o){if("include"==t.nodeName){var n=t.getAttribute("name");if(null!=n)try{var c=mxUtils.load(n).getDocumentElement();null!=c&&e.decode(c,o)}catch(e){}return!0}return!1},mxObjectCodec.prototype.beforeDecode=function(e,t,o){return t},mxObjectCodec.prototype.afterDecode=function(e,t,o){return o};