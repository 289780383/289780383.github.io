function mxSvgCanvas2D(t,e){mxAbstractCanvas2D.call(this),this.root=t,this.gradients=[],this.defs=null,this.styleEnabled=null!=e&&e;var n=null;if(t.ownerDocument!=document){for(var s=t;null!=s&&"svg"!=s.nodeName;)s=s.parentNode;n=s}null!=n&&(n.getElementsByTagName("defs").length>0&&(this.defs=n.getElementsByTagName("defs")[0]),null==this.defs&&(this.defs=this.createElement("defs"),null!=n.firstChild?n.insertBefore(this.defs,n.firstChild):n.appendChild(this.defs)),this.styleEnabled&&this.defs.appendChild(this.createStyle()))}mxUtils.extend(mxSvgCanvas2D,mxAbstractCanvas2D),function(){if(mxSvgCanvas2D.prototype.useDomParser="function"==typeof DOMParser&&"function"==typeof XMLSerializer,mxSvgCanvas2D.prototype.useDomParser)try{var t=(new DOMParser).parseFromString("test text","text/html");mxSvgCanvas2D.prototype.useDomParser=null!=t}catch(t){mxSvgCanvas2D.prototype.useDomParser=!1}}(),mxSvgCanvas2D.prototype.node=null,mxSvgCanvas2D.prototype.matchHtmlAlignment=!0,mxSvgCanvas2D.prototype.textEnabled=!0,mxSvgCanvas2D.prototype.foEnabled=!0,mxSvgCanvas2D.prototype.foAltText="[Object]",mxSvgCanvas2D.prototype.foOffset=0,mxSvgCanvas2D.prototype.textOffset=0,mxSvgCanvas2D.prototype.imageOffset=0,mxSvgCanvas2D.prototype.strokeTolerance=0,mxSvgCanvas2D.prototype.minStrokeWidth=1,mxSvgCanvas2D.prototype.refCount=0,mxSvgCanvas2D.prototype.lineHeightCorrection=1,mxSvgCanvas2D.prototype.pointerEventsValue="all",mxSvgCanvas2D.prototype.fontMetricsPadding=10,mxSvgCanvas2D.prototype.cacheOffsetSize=!0,mxSvgCanvas2D.prototype.format=function(t){return parseFloat(parseFloat(t).toFixed(2))},mxSvgCanvas2D.prototype.getBaseUrl=function(){var t=window.location.href,e=t.lastIndexOf("#");return e>0&&(t=t.substring(0,e)),t},mxSvgCanvas2D.prototype.reset=function(){mxAbstractCanvas2D.prototype.reset.apply(this,arguments),this.gradients=[]},mxSvgCanvas2D.prototype.createStyle=function(t){var e=this.createElement("style");return e.setAttribute("type","text/css"),mxUtils.write(e,"svg{font-family:"+mxConstants.DEFAULT_FONTFAMILY+";font-size:"+mxConstants.DEFAULT_FONTSIZE+";fill:none;stroke-miterlimit:10}"),e},mxSvgCanvas2D.prototype.createElement=function(t,e){if(null!=this.root.ownerDocument.createElementNS)return this.root.ownerDocument.createElementNS(e||mxConstants.NS_SVG,t);var n=this.root.ownerDocument.createElement(t);return null!=e&&n.setAttribute("xmlns",e),n},mxSvgCanvas2D.prototype.getAlternateText=function(t,e,n,s,i,r,a,o,l,h,m,u,d){return null!=r?this.foAltText:null},mxSvgCanvas2D.prototype.createAlternateContent=function(t,e,n,s,i,r,a,o,l,h,m,u,d){var p=this.getAlternateText(t,e,n,s,i,r,a,o,l,h,m,u,d),f=this.state;if(null!=p&&f.fontSize>0){var c=o==mxConstants.ALIGN_TOP?1:o==mxConstants.ALIGN_BOTTOM?0:.3,x=a==mxConstants.ALIGN_RIGHT?"end":a==mxConstants.ALIGN_LEFT?"start":"middle",v=this.createElement("text");v.setAttribute("x",Math.round(e+f.dx)),v.setAttribute("y",Math.round(n+f.dy+c*f.fontSize)),v.setAttribute("fill",f.fontColor||"black"),v.setAttribute("font-family",f.fontFamily),v.setAttribute("font-size",Math.round(f.fontSize)+"px"),"start"!=x&&v.setAttribute("text-anchor",x),(f.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&v.setAttribute("font-weight","bold"),(f.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&v.setAttribute("font-style","italic");var C=[];return(f.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&C.push("underline"),(f.fontStyle&mxConstants.FONT_STRIKETHROUGH)==mxConstants.FONT_STRIKETHROUGH&&C.push("line-through"),C.length>0&&v.setAttribute("text-decoration",C.join(" ")),mxUtils.write(v,p),v}return null},mxSvgCanvas2D.prototype.createGradientId=function(t,e,n,s,i){"#"==t.charAt(0)&&(t=t.substring(1)),"#"==e.charAt(0)&&(e=e.substring(1)),t=t.toLowerCase()+"-"+n,e=e.toLowerCase()+"-"+s;var r=null;if(null==i||i==mxConstants.DIRECTION_SOUTH)r="s";else if(i==mxConstants.DIRECTION_EAST)r="e";else{var a=t;t=e,e=a,i==mxConstants.DIRECTION_NORTH?r="s":i==mxConstants.DIRECTION_WEST&&(r="e")}return"mx-gradient-"+t+"-"+e+"-"+r},mxSvgCanvas2D.prototype.getSvgGradient=function(t,e,n,s,i){var r=this.createGradientId(t,e,n,s,i),a=this.gradients[r];if(null==a){var o=this.root.ownerSVGElement,l=0,h=r+"-"+l;if(null!=o)for(a=o.ownerDocument.getElementById(h);null!=a&&a.ownerSVGElement!=o;)h=r+"-"+l++,a=o.ownerDocument.getElementById(h);else h="id"+ ++this.refCount;null==a&&((a=this.createSvgGradient(t,e,n,s,i)).setAttribute("id",h),null!=this.defs?this.defs.appendChild(a):o.appendChild(a)),this.gradients[r]=a}return a.getAttribute("id")},mxSvgCanvas2D.prototype.createSvgGradient=function(t,e,n,s,i){if(i==mxConstants.DIRECTION_RADIAL){(a=this.createElement("radialGradient")).setAttribute("x1","0%"),a.setAttribute("y1","0%"),a.setAttribute("x2","100%"),a.setAttribute("y2","100%");var r=n<1?";stop-opacity:"+n:"";return(o=this.createElement("stop")).setAttribute("offset","0%"),o.setAttribute("style","stop-color:"+t+r),a.appendChild(o),r=s<1?";stop-opacity:"+s:"",(o=this.createElement("stop")).setAttribute("offset","100%"),o.setAttribute("style","stop-color:"+e+r),a.appendChild(o),a}var a;(a=this.createElement("linearGradient")).setAttribute("x1","0%"),a.setAttribute("y1","0%"),a.setAttribute("x2","0%"),a.setAttribute("y2","0%"),null==i||i==mxConstants.DIRECTION_SOUTH?a.setAttribute("y2","100%"):i==mxConstants.DIRECTION_EAST?a.setAttribute("x2","100%"):i==mxConstants.DIRECTION_NORTH?a.setAttribute("y1","100%"):i==mxConstants.DIRECTION_WEST&&a.setAttribute("x1","100%");var o;r=n<1?";stop-opacity:"+n:"";return(o=this.createElement("stop")).setAttribute("offset","0%"),o.setAttribute("style","stop-color:"+t+r),a.appendChild(o),r=s<1?";stop-opacity:"+s:"",(o=this.createElement("stop")).setAttribute("offset","100%"),o.setAttribute("style","stop-color:"+e+r),a.appendChild(o),a},mxSvgCanvas2D.prototype.addNode=function(t,e){var n=this.node,s=this.state;if(null!=n){if("path"==n.nodeName){if(!(null!=this.path&&this.path.length>0))return;n.setAttribute("d",this.path.join(" "))}t&&null!=s.fillColor?this.updateFill():this.styleEnabled||("ellipse"==n.nodeName&&GE.IS_FF?n.setAttribute("fill","transparent"):n.setAttribute("fill","none"),t=!1),e&&null!=s.strokeColor?this.updateStroke():this.styleEnabled||n.setAttribute("stroke","none"),null!=s.transform&&s.transform.length>0&&n.setAttribute("transform",s.transform),s.shadow&&this.root.appendChild(this.createShadow(n)),this.strokeTolerance>0&&!t&&this.root.appendChild(this.createTolerance(n)),this.pointerEvents?n.setAttribute("pointer-events",this.pointerEventsValue):this.pointerEvents||null!=this.originalRoot||n.setAttribute("pointer-events","none"),("rect"!=n.nodeName&&"path"!=n.nodeName&&"ellipse"!=n.nodeName||"none"!=n.getAttribute("fill")&&"transparent"!=n.getAttribute("fill")||"none"!=n.getAttribute("stroke")||"none"!=n.getAttribute("pointer-events"))&&this.root.appendChild(n),this.node=null}},mxSvgCanvas2D.prototype.updateFill=function(){var t=this.state;if((t.alpha<1||t.fillAlpha<1)&&this.node.setAttribute("fill-opacity",t.alpha*t.fillAlpha),null!=t.fillColor)if(null!=t.gradientColor){var e=this.getSvgGradient(String(t.fillColor),String(t.gradientColor),t.gradientFillAlpha,t.gradientAlpha,t.gradientDirection);if(GE.IS_CHROMEAPP||GE.IS_IE11||GE.IS_EDGE||this.root.ownerDocument!=document)this.node.setAttribute("fill","url(#"+e+")");else{var n=this.getBaseUrl().replace(/([\(\)])/g,"\\$1");this.node.setAttribute("fill","url("+n+"#"+e+")")}}else this.node.setAttribute("fill",String(t.fillColor).toLowerCase())},mxSvgCanvas2D.prototype.getCurrentStrokeWidth=function(){return Math.max(this.minStrokeWidth,Math.max(.01,this.format(this.state.strokeWidth*this.state.scale)))},mxSvgCanvas2D.prototype.updateStroke=function(){var t=this.state;this.node.setAttribute("stroke",String(t.strokeColor).toLowerCase()),(t.alpha<1||t.strokeAlpha<1)&&this.node.setAttribute("stroke-opacity",t.alpha*t.strokeAlpha);var e=this.getCurrentStrokeWidth();1!=e&&this.node.setAttribute("stroke-width",e),"path"==this.node.nodeName&&this.updateStrokeAttributes(),t.dashed&&this.node.setAttribute("stroke-dasharray",this.createDashPattern((t.fixDash?1:t.strokeWidth)*t.scale))},mxSvgCanvas2D.prototype.updateStrokeAttributes=function(){var t=this.state;if(null!=t.lineJoin&&"miter"!=t.lineJoin&&this.node.setAttribute("stroke-linejoin",t.lineJoin),null!=t.lineCap){var e=t.lineCap;"flat"==e&&(e="butt"),"butt"!=e&&this.node.setAttribute("stroke-linecap",e)}null==t.miterLimit||this.styleEnabled&&10==t.miterLimit||this.node.setAttribute("stroke-miterlimit",t.miterLimit)},mxSvgCanvas2D.prototype.createDashPattern=function(t){var e=[];if("string"==typeof this.state.dashPattern){var n=this.state.dashPattern.split(" ");if(n.length>0)for(var s=0;s<n.length;s++)e[s]=Number(n[s])*t}return e.join(" ")},mxSvgCanvas2D.prototype.createTolerance=function(t){var e=t.cloneNode(!0),n=parseFloat(e.getAttribute("stroke-width")||1)+this.strokeTolerance;return e.setAttribute("pointer-events","stroke"),e.setAttribute("visibility","hidden"),e.removeAttribute("stroke-dasharray"),e.setAttribute("stroke-width",n),e.setAttribute("fill","none"),e.setAttribute("stroke",GE.IS_OT?"none":"white"),e},mxSvgCanvas2D.prototype.createShadow=function(t){var e=t.cloneNode(!0),n=this.state;return"none"==e.getAttribute("fill")||GE.IS_FF&&"transparent"==e.getAttribute("fill")||e.setAttribute("fill",n.shadowColor),"none"!=e.getAttribute("stroke")&&e.setAttribute("stroke",n.shadowColor),e.setAttribute("transform","translate("+this.format(n.shadowDx*n.scale)+","+this.format(n.shadowDy*n.scale)+")"+(n.transform||"")),e.setAttribute("opacity",n.shadowAlpha),e},mxSvgCanvas2D.prototype.setLink=function(t){if(null==t)this.root=this.originalRoot;else{this.originalRoot=this.root;var e=this.createElement("a");null==e.setAttributeNS||this.root.ownerDocument!=document&&null==document.documentMode?e.setAttribute("xlink:href",t):e.setAttributeNS(mxConstants.NS_XLINK,"xlink:href",t),this.root.appendChild(e),this.root=e}},mxSvgCanvas2D.prototype.rotate=function(t,e,n,s,i){if(0!=t||e||n){var r=this.state;if(s+=r.dx,i+=r.dy,s*=r.scale,i*=r.scale,r.transform=r.transform||"",e&&n)t+=180;else if(e!=n){var a=e?s:0,o=e?-1:1,l=n?i:0,h=n?-1:1;r.transform+="translate("+this.format(a)+","+this.format(l)+")scale("+this.format(o)+","+this.format(h)+")translate("+this.format(-a)+","+this.format(-l)+")"}(e?!n:n)&&(t*=-1),0!=t&&(r.transform+="rotate("+this.format(t)+","+this.format(s)+","+this.format(i)+")"),r.rotation=r.rotation+t,r.rotationCx=s,r.rotationCy=i}},mxSvgCanvas2D.prototype.begin=function(){mxAbstractCanvas2D.prototype.begin.apply(this,arguments),this.node=this.createElement("path")},mxSvgCanvas2D.prototype.rect=function(t,e,n,s){var i=this.state,r=this.createElement("rect");r.setAttribute("x",this.format((t+i.dx)*i.scale)),r.setAttribute("y",this.format((e+i.dy)*i.scale)),r.setAttribute("width",this.format(n*i.scale)),r.setAttribute("height",this.format(s*i.scale)),this.node=r},mxSvgCanvas2D.prototype.roundrect=function(t,e,n,s,i,r){this.rect(t,e,n,s),i>0&&this.node.setAttribute("rx",this.format(i*this.state.scale)),r>0&&this.node.setAttribute("ry",this.format(r*this.state.scale))},mxSvgCanvas2D.prototype.ellipse=function(t,e,n,s){var i=this.state,r=this.createElement("ellipse");r.setAttribute("cx",this.format((t+n/2+i.dx)*i.scale)),r.setAttribute("cy",this.format((e+s/2+i.dy)*i.scale)),r.setAttribute("rx",n/2*i.scale),r.setAttribute("ry",s/2*i.scale),this.node=r},mxSvgCanvas2D.prototype.image=function(t,e,n,s,i,r,a,o){i=this.converter.convert(i),r=null==r||r,a=null!=a&&a,o=null!=o&&o;var l=this.state;t+=l.dx,e+=l.dy;var h=this.createElement("image");h.setAttribute("x",this.format(t*l.scale)+this.imageOffset),h.setAttribute("y",this.format(e*l.scale)+this.imageOffset),h.setAttribute("width",this.format(n*l.scale)),h.setAttribute("height",this.format(s*l.scale)),null==h.setAttributeNS?h.setAttribute("xlink:href",i):h.setAttributeNS(mxConstants.NS_XLINK,"xlink:href",i),r||h.setAttribute("preserveAspectRatio","none"),(l.alpha<1||l.fillAlpha<1)&&h.setAttribute("opacity",l.alpha*l.fillAlpha);var m=this.state.transform||"";if(a||o){var u=1,d=1,p=0,f=0;a&&(u=-1,p=-n-2*t),o&&(d=-1,f=-s-2*e),m+="scale("+u+","+d+")translate("+p*l.scale+","+f*l.scale+")"}m.length>0&&h.setAttribute("transform",m),this.pointerEvents||h.setAttribute("pointer-events","none"),this.root.appendChild(h)},mxSvgCanvas2D.prototype.convertHtml=function(t){if(this.useDomParser){var e=(new DOMParser).parseFromString(t,"text/html");null!=e&&("<body"==(t=(new XMLSerializer).serializeToString(e.body)).substring(0,5)&&(t=t.substring(t.indexOf(">",5)+1)),"</body>"==t.substring(t.length-7,t.length)&&(t=t.substring(0,t.length-7)))}else{if(null!=document.implementation&&null!=document.implementation.createDocument){var n=document.implementation.createDocument("http://www.w3.org/1999/xhtml","html",null),s=n.createElement("body");n.documentElement.appendChild(s);var i=document.createElement("div");i.innerHTML=t;for(var r=i.firstChild;null!=r;){var a=r.nextSibling;s.appendChild(n.adoptNode(r)),r=a}return s.innerHTML}var o=document.createElement("textarea");o.innerHTML=t.replace(/&amp;/g,"&amp;amp;").replace(/&#60;/g,"&amp;lt;").replace(/&#62;/g,"&amp;gt;").replace(/&lt;/g,"&amp;lt;").replace(/&gt;/g,"&amp;gt;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),t=o.value.replace(/&/g,"&amp;").replace(/&amp;lt;/g,"&lt;").replace(/&amp;gt;/g,"&gt;").replace(/&amp;amp;/g,"&amp;").replace(/<br>/g,"<br />").replace(/<hr>/g,"<hr />").replace(/(<img[^>]+)>/gm,"$1 />")}return t},mxSvgCanvas2D.prototype.createDiv=function(t){var e=t;if(mxUtils.isNode(e)||(e="<div><div>"+this.convertHtml(e)+"</div></div>"),!GE.IS_IE11&&document.createElementNS){var n=document.createElementNS("http://www.w3.org/1999/xhtml","div");if(mxUtils.isNode(e)){var s=document.createElement("div"),i=s.cloneNode(!1);this.root.ownerDocument!=document?s.appendChild(e.cloneNode(!0)):s.appendChild(e),i.appendChild(s),n.appendChild(i)}else n.innerHTML=e;return n}return mxUtils.isNode(e)&&(e="<div><div>"+mxUtils.getXml(e)+"</div></div>"),e='<div xmlns="http://www.w3.org/1999/xhtml">'+e+"</div>",mxUtils.parseXml(e).documentElement},mxSvgCanvas2D.prototype.updateText=function(t,e,n,s,i,r,a,o,l,h,m){null!=m&&null!=m.firstChild&&null!=m.firstChild.firstChild&&this.updateTextNodes(t,e,n,s,i,r,a,o,l,h,m.firstChild)},mxSvgCanvas2D.prototype.addForeignObject=function(t,e,n,s,i,r,a,o,l,h,m,u,d,p,f){var c=this.createElement("g"),x=this.createElement("foreignObject");if(x.setAttribute("style","overflow: visible; text-align: left;"),x.setAttribute("pointer-events","none"),p.ownerDocument!=document&&(p=mxUtils.importNodeImplementation(x.ownerDocument,p,!0)),x.appendChild(p),c.appendChild(x),this.updateTextNodes(t,e,n,s,r,a,o,h,m,u,c),this.root.ownerDocument!=document){var v=this.createAlternateContent(x,t,e,n,s,i,r,a,o,l,h,m,u);if(null!=v){x.setAttribute("requiredFeatures","http://www.w3.org/TR/SVG11/feature#Extensibility");var C=this.createElement("switch");C.appendChild(x),C.appendChild(v),c.appendChild(C)}}f.appendChild(c)},mxSvgCanvas2D.prototype.updateTextNodes=function(t,e,n,s,i,r,a,o,l,h,m){var u=this.state.scale;mxSvgCanvas2D.createCss(n+2,s,i,r,a,o,l,null!=this.state.fontBackgroundColor?this.state.fontBackgroundColor:null,null!=this.state.fontBorderColor?this.state.fontBorderColor:null,"display: flex; align-items: unsafe "+(r==mxConstants.ALIGN_TOP?"flex-start":r==mxConstants.ALIGN_BOTTOM?"flex-end":"center")+"; justify-content: unsafe "+(i==mxConstants.ALIGN_LEFT?"flex-start":i==mxConstants.ALIGN_RIGHT?"flex-end":"center")+"; ",this.getTextCss(),u,mxUtils.bind(this,function(n,s,i,r,a){t+=this.state.dx,e+=this.state.dy;var o=m.firstChild,l=o.firstChild,d=l.firstChild,p=d.firstChild,f=(this.rotateHtml?this.state.rotation:0)+(null!=h?h:0),c=(0!=this.foOffset?"translate("+this.foOffset+" "+this.foOffset+")":"")+(1!=u?"scale("+u+")":"");p.setAttribute("style",a),d.setAttribute("style",r),o.setAttribute("width",Math.ceil(1/Math.min(1,u)*100)+"%"),o.setAttribute("height",Math.ceil(1/Math.min(1,u)*100)+"%");var x=Math.round(e+s);x<0?o.setAttribute("y",x):(o.removeAttribute("y"),i+="padding-top: "+x+"px; "),l.setAttribute("style",i+"margin-left: "+Math.round(t+n)+"px;"),""!=(c+=0!=f?"rotate("+f+" "+t+" "+e+")":"")?m.setAttribute("transform",c):m.removeAttribute("transform"),1!=this.state.alpha?m.setAttribute("opacity",this.state.alpha):m.removeAttribute("opacity")}))},mxSvgCanvas2D.createCss=function(t,e,n,s,i,r,a,o,l,h,m,u,d){var p="box-sizing: border-box; font-size: 0; text-align: "+(n==mxConstants.ALIGN_LEFT?"left":n==mxConstants.ALIGN_RIGHT?"right":"center")+"; ",f=mxUtils.getAlignmentAsPoint(n,s),c="overflow: hidden; ",x="width: 1px; ",v="height: 1px; ",C=f.x*t,g=f.y*e;a?(x="width: "+Math.round(t)+"px; ",p+="max-height: "+Math.round(e)+"px; ",g=0):"fill"==r?(m+="width: 100%; height: 100%; ",p+=(x="width: "+Math.round(t)+"px; ")+(v="height: "+Math.round(e)+"px; ")):"width"==r?(m+="width: 100%; ",p+=x="width: "+Math.round(t)+"px; ",g=0,e>0&&(p+="max-height: "+Math.round(e)+"px; ")):(c="",g=0);var A="";null!=o&&(A+="background-color: "+o+"; "),null!=l&&(A+="border: 1px solid "+l+"; "),""==c||a?m+=A:p+=A,i&&t>0?(m+="white-space: normal; word-wrap: "+mxConstants.WORD_WRAP+"; ",x="width: "+Math.round(t)+"px; ",""!=c&&"fill"!=r&&(g=0)):(m+="white-space: nowrap; ",""==c&&(C=0)),d(C,g,h+x+v,p+c,m,c)},mxSvgCanvas2D.prototype.getTextCss=function(){var t=this.state,e=mxConstants.ABSOLUTE_LINE_HEIGHT?t.fontSize*mxConstants.LINE_HEIGHT+"px":mxConstants.LINE_HEIGHT*this.lineHeightCorrection,n="display: inline-block; font-size: "+t.fontSize+"px; font-family: "+t.fontFamily+"; color: "+t.fontColor+"; line-height: "+e+"; pointer-events: "+(this.pointerEvents?this.pointerEventsValue:"none")+"; ";(t.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(n+="font-weight: bold; "),(t.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(n+="font-style: italic; ");var s=[];return(t.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&s.push("underline"),(t.fontStyle&mxConstants.FONT_STRIKETHROUGH)==mxConstants.FONT_STRIKETHROUGH&&s.push("line-through"),s.length>0&&(n+="text-decoration: "+s.join(" ")+"; "),n},mxSvgCanvas2D.prototype.text=function(t,e,n,s,i,r,a,o,l,h,m,u,d){if(this.textEnabled&&null!=i){if(u=null!=u?u:0,this.foEnabled&&"html"==l){var p=this.createDiv(i);return null!=p&&(null!=d&&p.setAttribute("dir",d),this.addForeignObject(t,e,n,s,i,r,a,o,l,h,m,u,d,p,this.root)),p}this.plainText(t+this.state.dx,e+this.state.dy,n,s,i,r,a,o,h,m,u,d)}},mxSvgCanvas2D.prototype.createClip=function(t,e,n,s){for(var i="mx-clip-"+(t=Math.round(t))+"-"+(e=Math.round(e))+"-"+(n=Math.round(n))+"-"+(s=Math.round(s)),r=0,a=i+"-"+r;null!=document.getElementById(a);)a=i+"-"+ ++r;clip=this.createElement("clipPath"),clip.setAttribute("id",a);var o=this.createElement("rect");return o.setAttribute("x",t),o.setAttribute("y",e),o.setAttribute("width",n),o.setAttribute("height",s),clip.appendChild(o),clip},mxSvgCanvas2D.prototype.plainText=function(t,e,n,s,i,r,a,o,l,h,m,u){m=null!=m?m:0;var d=this.state,p=d.fontSize,f=this.createElement("g"),c=d.transform||"";if(this.updateFont(f),0!=m&&(c+="rotate("+m+","+this.format(t*d.scale)+","+this.format(e*d.scale)+")"),null!=u&&f.setAttribute("direction",u),h&&n>0&&s>0){var x=t,v=e;r==mxConstants.ALIGN_CENTER?x-=n/2:r==mxConstants.ALIGN_RIGHT&&(x-=n),"fill"!=l&&(a==mxConstants.ALIGN_MIDDLE?v-=s/2:a==mxConstants.ALIGN_BOTTOM&&(v-=s));var C=this.createClip(x*d.scale-2,v*d.scale-2,n*d.scale+4,s*d.scale+4);if(null!=this.defs?this.defs.appendChild(C):this.root.appendChild(C),GE.IS_CHROMEAPP||GE.IS_IE11||GE.IS_EDGE||this.root.ownerDocument!=document)f.setAttribute("clip-path","url(#"+C.getAttribute("id")+")");else{var g=this.getBaseUrl().replace(/([\(\)])/g,"\\$1");f.setAttribute("clip-path","url("+g+"#"+C.getAttribute("id")+")")}}var A=r==mxConstants.ALIGN_RIGHT?"end":r==mxConstants.ALIGN_CENTER?"middle":"start";"start"!=A&&f.setAttribute("text-anchor",A),this.styleEnabled&&p==mxConstants.DEFAULT_FONTSIZE||f.setAttribute("font-size",p*d.scale+"px"),c.length>0&&f.setAttribute("transform",c),d.alpha<1&&f.setAttribute("opacity",d.alpha);var b=i.split("\n"),y=Math.round(p*mxConstants.LINE_HEIGHT),S=p+(b.length-1)*y;v=e+p-1;if(a==mxConstants.ALIGN_MIDDLE)v-="fill"==l?s/2:(this.matchHtmlAlignment&&h&&s>0?Math.min(S,s):S)/2;else if(a==mxConstants.ALIGN_BOTTOM){if("fill"==l)v-=s;else v-=(this.matchHtmlAlignment&&h&&s>0?Math.min(S,s):S)+1}for(var E=0;E<b.length;E++){if(b[E].length>0&&mxUtils.trim(b[E]).length>0){var T=this.createElement("text");T.setAttribute("x",this.format(t*d.scale)+this.textOffset),T.setAttribute("y",this.format(v*d.scale)+this.textOffset),mxUtils.write(T,b[E]),f.appendChild(T)}v+=y}this.root.appendChild(f),this.addTextBackground(f,i,t,e,n,"fill"==l?s:S,r,a,l)},mxSvgCanvas2D.prototype.updateFont=function(t){var e=this.state;t.setAttribute("fill",e.fontColor),this.styleEnabled&&e.fontFamily==mxConstants.DEFAULT_FONTFAMILY||t.setAttribute("font-family",e.fontFamily),(e.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&t.setAttribute("font-weight","bold"),(e.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&t.setAttribute("font-style","italic");var n=[];(e.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&n.push("underline"),(e.fontStyle&mxConstants.FONT_STRIKETHROUGH)==mxConstants.FONT_STRIKETHROUGH&&n.push("line-through"),n.length>0&&t.setAttribute("text-decoration",n.join(" "))},mxSvgCanvas2D.prototype.addTextBackground=function(t,e,n,s,i,r,a,o,l){var h=this.state;if(null!=h.fontBackgroundColor||null!=h.fontBorderColor){var m=null;if("fill"==l||"width"==l)a==mxConstants.ALIGN_CENTER?n-=i/2:a==mxConstants.ALIGN_RIGHT&&(n-=i),o==mxConstants.ALIGN_MIDDLE?s-=r/2:o==mxConstants.ALIGN_BOTTOM&&(s-=r),m=new mxRectangle((n+1)*h.scale,s*h.scale,(i-2)*h.scale,(r+2)*h.scale);else if(null!=t.getBBox&&this.root.ownerDocument==document)try{m=t.getBBox(),m=new mxRectangle(m.x,m.y+(ie?0:1),m.width,m.height)}catch(t){}else{var u=document.createElement("div");u.style.lineHeight=mxConstants.ABSOLUTE_LINE_HEIGHT?h.fontSize*mxConstants.LINE_HEIGHT+"px":mxConstants.LINE_HEIGHT,u.style.fontSize=h.fontSize+"px",u.style.fontFamily=h.fontFamily,u.style.whiteSpace="nowrap",u.style.position="absolute",u.style.visibility="hidden",u.style.display="inline-block",u.style.zoom="1",(h.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(u.style.fontWeight="bold"),(h.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(u.style.fontStyle="italic"),e=mxUtils.htmlEntities(e,!1),u.innerHTML=e.replace(/\n/g,"<br/>"),document.body.appendChild(u);i=u.offsetWidth,r=u.offsetHeight;u.parentNode.removeChild(u),a==mxConstants.ALIGN_CENTER?n-=i/2:a==mxConstants.ALIGN_RIGHT&&(n-=i),o==mxConstants.ALIGN_MIDDLE?s-=r/2:o==mxConstants.ALIGN_BOTTOM&&(s-=r),m=new mxRectangle((n+1)*h.scale,(s+2)*h.scale,i*h.scale,(r+1)*h.scale)}if(null!=m){var d=this.createElement("rect");d.setAttribute("fill",h.fontBackgroundColor||"none"),d.setAttribute("stroke",h.fontBorderColor||"none"),d.setAttribute("x",Math.floor(m.x-1)),d.setAttribute("y",Math.floor(m.y-1)),d.setAttribute("width",Math.ceil(m.width+2)),d.setAttribute("height",Math.ceil(m.height));var p=null!=h.fontBorderColor?Math.max(1,this.format(h.scale)):0;d.setAttribute("stroke-width",p),this.root.ownerDocument==document&&1==mxUtils.mod(p,2)&&d.setAttribute("transform","translate(0.5, 0.5)"),t.insertBefore(d,t.firstChild)}}},mxSvgCanvas2D.prototype.stroke=function(){this.addNode(!1,!0)},mxSvgCanvas2D.prototype.fill=function(){this.addNode(!0,!1)},mxSvgCanvas2D.prototype.fillAndStroke=function(){this.addNode(!0,!0)};