function mxStackLayout(t,i,e,a,h,o){mxGraphLayout.call(this,t),this.horizontal=null==i||i,this.spacing=null!=e?e:0,this.x0=null!=a?a:0,this.y0=null!=h?h:0,this.border=null!=o?o:0}mxStackLayout.prototype=new mxGraphLayout,mxStackLayout.prototype.constructor=mxStackLayout,mxStackLayout.prototype.horizontal=null,mxStackLayout.prototype.spacing=null,mxStackLayout.prototype.x0=null,mxStackLayout.prototype.y0=null,mxStackLayout.prototype.border=0,mxStackLayout.prototype.marginTop=0,mxStackLayout.prototype.marginLeft=0,mxStackLayout.prototype.marginRight=0,mxStackLayout.prototype.marginBottom=0,mxStackLayout.prototype.keepFirstLocation=!1,mxStackLayout.prototype.fill=!1,mxStackLayout.prototype.resizeParent=!1,mxStackLayout.prototype.resizeParentMax=!1,mxStackLayout.prototype.resizeLast=!1,mxStackLayout.prototype.wrap=null,mxStackLayout.prototype.borderCollapse=!0,mxStackLayout.prototype.allowGaps=!1,mxStackLayout.prototype.gridSize=0,mxStackLayout.prototype.isHorizontal=function(){return this.horizontal},mxStackLayout.prototype.moveCell=function(t,i,e){var a=this.graph.getModel(),h=a.getParent(t),o=this.isHorizontal();if(null!=t&&null!=h){var r=0,s=0,l=a.getChildCount(h),n=o?i:e,p=this.graph.getView().getState(h);for(null!=p&&(n-=o?p.x:p.y),n/=this.graph.view.scale,r=0;r<l;r++){var g=a.getChildAt(h,r);if(g!=t){var y=a.getGeometry(g);if(null!=y){var m=o?y.x+y.width/2:y.y+y.height/2;if(s<=n&&m>n)break;s=m}}}var u=h.getIndex(t);a.add(h,t,u)}},mxStackLayout.prototype.getParentSize=function(t){var i=this.graph.getModel(),e=i.getGeometry(t);if(null!=this.graph.container&&(null==e&&i.isLayer(t)||t==this.graph.getView().currentRoot)){var a=this.graph.container.offsetWidth-1,h=this.graph.container.offsetHeight-1;e=new mxRectangle(0,0,a,h)}return e},mxStackLayout.prototype.getLayoutCells=function(t){for(var i=this.graph.getModel(),e=i.getChildCount(t),a=[],h=0;h<e;h++){var o=i.getChildAt(t,h);!this.isVertexIgnored(o)&&this.isVertexMovable(o)&&a.push(o)}return this.allowGaps&&a.sort(mxUtils.bind(this,function(t,i){var e=this.graph.getCellGeometry(t),a=this.graph.getCellGeometry(i);return e.y==a.y?0:e.y>a.y>0?1:-1})),a},mxStackLayout.prototype.snap=function(t){if(null!=this.gridSize&&this.gridSize>0&&(t=Math.max(t,this.gridSize))/this.gridSize>1){var i=t%this.gridSize;t+=i>this.gridSize/2?this.gridSize-i:-i}return t},mxStackLayout.prototype.execute=function(t){if(null!=t){var i=this.getParentSize(t),e=this.isHorizontal(),a=this.graph.getModel(),h=null;null!=i&&(h=e?i.height-this.marginTop-this.marginBottom:i.width-this.marginLeft-this.marginRight),h-=2*this.border;var o=this.x0+this.border+this.marginLeft,r=this.y0+this.border+this.marginTop;if(this.graph.isSwimlane(t)){var s=this.graph.getCellStyle(t),l=mxUtils.getNumber(s,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE),n=1==mxUtils.getValue(s,mxConstants.STYLE_HORIZONTAL,!0);null!=i&&(l=n?Math.min(l,i.height):Math.min(l,i.width)),e==n&&(h-=l),n?r+=l:o+=l}a.beginUpdate();try{for(var p=0,g=null,y=0,m=null,u=this.getLayoutCells(t),x=0;x<u.length;x++){var c=u[x],d=a.getGeometry(c);if(null!=d){d=d.clone(),null!=this.wrap&&null!=g&&(e&&g.x+g.width+d.width+2*this.spacing>this.wrap||!e&&g.y+g.height+d.height+2*this.spacing>this.wrap)&&(g=null,e?r+=p+this.spacing:o+=p+this.spacing,p=0),p=Math.max(p,e?d.height:d.width);var L=0;if(!this.borderCollapse){var S=this.graph.getCellStyle(c);L=mxUtils.getNumber(S,mxConstants.STYLE_STROKEWIDTH,1)}if(null!=g){var f=y+this.spacing+Math.floor(L/2);e?d.x=this.snap((this.allowGaps?Math.max(f,d.x):f)-this.marginLeft)+this.marginLeft:d.y=this.snap((this.allowGaps?Math.max(f,d.y):f)-this.marginTop)+this.marginTop}else this.keepFirstLocation||(e?d.x=this.allowGaps&&d.x>o?Math.max(this.snap(d.x-this.marginLeft)+this.marginLeft,o):o:d.y=this.allowGaps&&d.y>r?Math.max(this.snap(d.y-this.marginTop)+this.marginTop,r):r);e?d.y=r:d.x=o,this.fill&&null!=h&&(e?d.height=h:d.width=h),e?d.width=this.snap(d.width):d.height=this.snap(d.height),this.setChildGeometry(c,d),m=c,g=d,y=e?g.x+g.width+Math.floor(L/2):g.y+g.height+Math.floor(L/2)}}this.resizeParent&&null!=i&&null!=g&&!this.graph.isCellCollapsed(t)?this.updateParentGeometry(t,i,g):this.resizeLast&&null!=i&&null!=g&&null!=m&&(e?g.width=i.width-g.x-this.spacing-this.marginRight-this.marginLeft:g.height=i.height-g.y-this.spacing-this.marginBottom,this.setChildGeometry(m,g))}finally{a.endUpdate()}}},mxStackLayout.prototype.setChildGeometry=function(t,i){var e=this.graph.getCellGeometry(t);null!=e&&i.x==e.x&&i.y==e.y&&i.width==e.width&&i.height==e.height||this.graph.getModel().setGeometry(t,i)},mxStackLayout.prototype.updateParentGeometry=function(t,i,e){var a=this.isHorizontal(),h=this.graph.getModel(),o=i.clone();if(a){var r=e.x+e.width+this.marginRight+this.border;this.resizeParentMax?o.width=Math.max(o.width,r):o.width=r}else{r=e.y+e.height+this.marginBottom+this.border;this.resizeParentMax?o.height=Math.max(o.height,r):o.height=r}i.x==o.x&&i.y==o.y&&i.width==o.width&&i.height==o.height||h.setGeometry(t,o)};