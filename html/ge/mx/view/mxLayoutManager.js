function mxLayoutManager(t){this.undoHandler=mxUtils.bind(this,function(t,e){this.isEnabled()&&this.beforeUndo(e.getProperty("edit"))}),this.moveHandler=mxUtils.bind(this,function(t,e){this.isEnabled()&&this.cellsMoved(e.getProperty("cells"),e.getProperty("event"))}),this.resizeHandler=mxUtils.bind(this,function(t,e){this.isEnabled()&&this.cellsResized(e.getProperty("cells"),e.getProperty("bounds"),e.getProperty("previous"))}),this.setGraph(t)}mxLayoutManager.prototype=new mxEventSource,mxLayoutManager.prototype.constructor=mxLayoutManager,mxLayoutManager.prototype.graph=null,mxLayoutManager.prototype.bubbling=!0,mxLayoutManager.prototype.enabled=!0,mxLayoutManager.prototype.undoHandler=null,mxLayoutManager.prototype.moveHandler=null,mxLayoutManager.prototype.resizeHandler=null,mxLayoutManager.prototype.isEnabled=function(){return this.enabled},mxLayoutManager.prototype.setEnabled=function(t){this.enabled=t},mxLayoutManager.prototype.isBubbling=function(){return this.bubbling},mxLayoutManager.prototype.setBubbling=function(t){this.bubbling=t},mxLayoutManager.prototype.getGraph=function(){return this.graph},mxLayoutManager.prototype.setGraph=function(t){null!=this.graph&&(this.graph.getModel().removeListener(this.undoHandler),this.graph.removeListener(this.moveHandler),this.graph.removeListener(this.resizeHandler));(this.graph=t,null!=this.graph)&&(this.graph.getModel().addListener(mxEvent.BEFORE_UNDO,this.undoHandler),this.graph.addListener(mxEvent.MOVE_CELLS,this.moveHandler),this.graph.addListener(mxEvent.RESIZE_CELLS,this.resizeHandler))},mxLayoutManager.prototype.hasLayout=function(t){return this.getLayout(t,mxEvent.LAYOUT_CELLS)},mxLayoutManager.prototype.getLayout=function(t,e){return null},mxLayoutManager.prototype.beforeUndo=function(t){this.executeLayoutForCells(this.getCellsForChanges(t.changes))},mxLayoutManager.prototype.cellsMoved=function(t,e){if(null!=t&&null!=e)for(var n=mxUtils.convertPoint(this.getGraph().container,mxEvent.getClientX(e),mxEvent.getClientY(e)),a=0;a<t.length;a++){var o=this.getAncestorLayout(t[a],mxEvent.MOVE_CELLS);null!=o&&o.moveCell(t[a],n.x,n.y)}},mxLayoutManager.prototype.cellsResized=function(t,e,n){if(null!=t&&null!=e)for(var a=0;a<t.length;a++){var o=this.getAncestorLayout(t[a],mxEvent.RESIZE_CELLS);null!=o&&o.resizeCell(t[a],e[a],n[a])}},mxLayoutManager.prototype.getAncestorLayout=function(t,e){for(var n=this.getGraph().getModel();null!=t;){var a=this.getLayout(t,e);if(null!=a)return a;t=n.getParent(t)}return null},mxLayoutManager.prototype.getCellsForChanges=function(t){for(var e=[],n=0;n<t.length;n++){var a=t[n];if(a instanceof mxRootChange)return[];e=e.concat(this.getCellsForChange(a))}return e},mxLayoutManager.prototype.getCellsForChange=function(t){return t instanceof mxChildChange?this.addCellsWithLayout(t.child,this.addCellsWithLayout(t.previous)):t instanceof mxTerminalChange||t instanceof mxGeometryChange?this.addCellsWithLayout(t.cell):t instanceof mxVisibleChange||t instanceof mxStyleChange?this.addCellsWithLayout(t.cell):[]},mxLayoutManager.prototype.addCellsWithLayout=function(t,e){return this.addDescendantsWithLayout(t,this.addAncestorsWithLayout(t,e))},mxLayoutManager.prototype.addAncestorsWithLayout=function(t,e){if((e=null!=e?e:[],null!=t)&&(null!=this.hasLayout(t)&&e.push(t),this.isBubbling())){var n=this.getGraph().getModel();this.addAncestorsWithLayout(n.getParent(t),e)}return e},mxLayoutManager.prototype.addDescendantsWithLayout=function(t,e){if(e=null!=e?e:[],null!=t&&this.hasLayout(t))for(var n=this.getGraph().getModel(),a=0;a<n.getChildCount(t);a++){var o=n.getChildAt(t,a);this.hasLayout(o)&&(e.push(o),this.addDescendantsWithLayout(o,e))}return e},mxLayoutManager.prototype.executeLayoutForCells=function(t){var e=mxUtils.sortCells(t,!1);this.layoutCells(e,!0),this.layoutCells(e.reverse(),!1)},mxLayoutManager.prototype.layoutCells=function(t,e){if(t.length>0){var n=this.getGraph().getModel();n.beginUpdate();try{for(var a=null,o=0;o<t.length;o++)t[o]!=n.getRoot()&&t[o]!=a&&(this.executeLayout(t[o],e),a=t[o]);this.fireEvent(new mxEventObject(mxEvent.LAYOUT_CELLS,"cells",t))}finally{n.endUpdate()}}},mxLayoutManager.prototype.executeLayout=function(t,e){var n=this.getLayout(t,e?mxEvent.BEGIN_UPDATE:mxEvent.END_UPDATE);null!=n&&n.execute(t)},mxLayoutManager.prototype.destroy=function(){this.setGraph(null)};