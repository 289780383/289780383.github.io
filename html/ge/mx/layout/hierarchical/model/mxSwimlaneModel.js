function mxSwimlaneModel(e,t,n,l,a){e.getGraph();this.tightenToSource=a,this.roots=n,this.parent=l,this.vertexMapper=new mxDictionary,this.edgeMapper=new mxDictionary,this.maxRank=0;var r=[];null==t&&(t=this.graph.getChildVertices(l)),this.maxRank=this.SOURCESCANSTARTRANK,this.createInternalCells(e,t,r);for(var s=0;s<t.length;s++){for(var i=r[s].connectsAsSource,o=0;o<i.length;o++){var h=i[o],m=h.edges;if(null!=m&&m.length>0){var p=m[0],u=e.getVisibleTerminal(p,!1),d=this.vertexMapper.get(u);r[s]==d&&(u=e.getVisibleTerminal(p,!0),d=this.vertexMapper.get(u)),null!=d&&r[s]!=d&&(h.target=d,0==d.connectsAsTarget.length&&(d.connectsAsTarget=[]),mxUtils.indexOf(d.connectsAsTarget,h)<0&&d.connectsAsTarget.push(h))}}r[s].temp[0]=1}}mxSwimlaneModel.prototype.maxRank=null,mxSwimlaneModel.prototype.vertexMapper=null,mxSwimlaneModel.prototype.edgeMapper=null,mxSwimlaneModel.prototype.ranks=null,mxSwimlaneModel.prototype.roots=null,mxSwimlaneModel.prototype.parent=null,mxSwimlaneModel.prototype.dfsCount=0,mxSwimlaneModel.prototype.SOURCESCANSTARTRANK=1e8,mxSwimlaneModel.prototype.tightenToSource=!1,mxSwimlaneModel.prototype.ranksPerGroup=null,mxSwimlaneModel.prototype.createInternalCells=function(e,t,n){for(var l=e.getGraph(),a=e.swimlanes,r=0;r<t.length;r++){n[r]=new mxGraphHierarchyNode(t[r]),this.vertexMapper.put(t[r],n[r]),n[r].swimlaneIndex=-1;for(var s=0;s<a.length;s++)if(l.model.getParent(t[r])==a[s]){n[r].swimlaneIndex=s;break}var i=e.getEdges(t[r]);n[r].connectsAsSource=[];for(var o=0;o<i.length;o++){var h=e.getVisibleTerminal(i[o],!1);if(h!=t[r]&&e.graph.model.isVertex(h)&&!e.isVertexIgnored(h)){var m=e.getEdgesBetween(t[r],h,!1),p=e.getEdgesBetween(t[r],h,!0);if(null!=m&&m.length>0&&null==this.edgeMapper.get(m[0])&&2*p.length>=m.length){for(var u=new mxGraphHierarchyEdge(m),d=0;d<m.length;d++){var x=m[d];this.edgeMapper.put(x,u),l.resetEdge(x),e.disableEdgeStyle&&(e.setEdgeStyleEnabled(x,!1),e.setOrthogonalEdge(x,!0))}u.source=n[r],mxUtils.indexOf(n[r].connectsAsSource,u)<0&&n[r].connectsAsSource.push(u)}}}n[r].temp[0]=0}},mxSwimlaneModel.prototype.initialRank=function(){this.ranksPerGroup=[];var e=[],t=new Object;if(null!=this.roots)for(var n=0;n<this.roots.length;n++){var l=this.vertexMapper.get(this.roots[n]);this.maxChainDfs(null,l,null,t,0),null!=l&&e.push(l)}var a=[],r=[];for(n=this.ranksPerGroup.length-1;n>=0;n--)n==this.ranksPerGroup.length-1?a[n]=0:a[n]=r[n+1]+1,r[n]=a[n]+this.ranksPerGroup[n];this.maxRank=r[0];var s=this.vertexMapper.getValues();for(n=0;n<s.length;n++)s[n].temp[0]=-1;for(e.slice();e.length>0;){var i,o;i=(l=e[0]).connectsAsTarget,o=l.connectsAsSource;var h=!0,m=r[0];for(n=0;n<i.length;n++){if(5270620!=(u=i[n]).temp[0]){h=!1;break}var p=u.source;m=Math.min(m,p.temp[0]-1)}if(h){if(m>r[l.swimlaneIndex]&&(m=r[l.swimlaneIndex]),l.temp[0]=m,null!=o)for(n=0;n<o.length;n++){var u;(u=o[n]).temp[0]=5270620,-1==(p=u.target).temp[0]&&(e.push(p),p.temp[0]=-2)}e.shift()}else{var d=e.shift();if(e.push(l),d==l&&1==e.length)break}}},mxSwimlaneModel.prototype.maxChainDfs=function(e,t,n,l,a){if(null!=t){var r=mxCellPath.create(t.cell);if(null==l[r]){l[r]=t;var s=t.swimlaneIndex;(null==this.ranksPerGroup[s]||this.ranksPerGroup[s]<a)&&(this.ranksPerGroup[s]=a);for(var i=t.connectsAsSource.slice(),o=0;o<i.length;o++){var h=i[o],m=h.target;t.swimlaneIndex<m.swimlaneIndex?this.maxChainDfs(t,m,h,mxUtils.clone(l,null,!0),0):t.swimlaneIndex==m.swimlaneIndex&&this.maxChainDfs(t,m,h,mxUtils.clone(l,null,!0),a+1)}}}},mxSwimlaneModel.prototype.fixRanks=function(){var e=[];this.ranks=[];for(var t=0;t<this.maxRank+1;t++)e[t]=[],this.ranks[t]=e[t];var n=null;if(null!=this.roots){var l=this.roots;n=[];for(t=0;t<l.length;t++){var a=l[t],r=this.vertexMapper.get(a);n[t]=r}}this.visit(function(t,n,l,a,r){if((0==r&&n.maxRank<0&&n.minRank<0&&(e[n.temp[0]].push(n),n.maxRank=n.temp[0],n.minRank=n.temp[0],n.temp[0]=e[n.maxRank].length-1),null!=t&&null!=l)&&t.maxRank-n.maxRank>1){l.maxRank=t.maxRank,l.minRank=n.maxRank,l.temp=[],l.x=[],l.y=[];for(var s=l.minRank+1;s<l.maxRank;s++)e[s].push(l),l.setGeneralPurposeVariable(s,e[s].length-1)}},n,!1,null)},mxSwimlaneModel.prototype.visit=function(e,t,n,l){if(null!=t){for(var a=0;a<t.length;a++){var r=t[a];null!=r&&(null==l&&(l=new Object),n?(r.hashCode=[],r.hashCode[0]=this.dfsCount,r.hashCode[1]=a,this.extendedDfs(null,r,null,e,l,r.hashCode,a,0)):this.dfs(null,r,null,e,l,0))}this.dfsCount++}},mxSwimlaneModel.prototype.dfs=function(e,t,n,l,a,r){if(null!=t){var s=t.id;if(null==a[s]){a[s]=t,l(e,t,n,r,0);for(var i=t.connectsAsSource.slice(),o=0;o<i.length;o++){var h=i[o],m=h.target;this.dfs(t,m,h,l,a,r+1)}}else l(e,t,n,r,1)}},mxSwimlaneModel.prototype.extendedDfs=function(e,t,n,l,a,r,s,i){if(null!=t){if(null!=e&&(null==t.hashCode||t.hashCode[0]!=e.hashCode[0])){var o=e.hashCode.length+1;t.hashCode=e.hashCode.slice(),t.hashCode[o-1]=s}var h=t.id;if(null==a[h]){a[h]=t,l(e,t,n,i,0);for(var m=t.connectsAsSource.slice(),p=t.connectsAsTarget.slice(),u=0;u<m.length;u++){var d=(x=m[u]).target;t.swimlaneIndex<=d.swimlaneIndex&&this.extendedDfs(t,d,x,l,a,t.hashCode,u,i+1)}for(u=0;u<p.length;u++){var x;d=(x=p[u]).source;t.swimlaneIndex<d.swimlaneIndex&&this.extendedDfs(t,d,x,l,a,t.hashCode,u,i+1)}}else l(e,t,n,i,1)}};