function mxPopupMenu(e){this.factoryMethod=e,null!=e&&this.init()}mxPopupMenu.prototype=new mxEventSource,mxPopupMenu.prototype.constructor=mxPopupMenu,mxPopupMenu.prototype.submenuImage=GE.imageBasePath+"/submenu.gif",mxPopupMenu.prototype.zIndex=10006,mxPopupMenu.prototype.factoryMethod=null,mxPopupMenu.prototype.useLeftButtonForPopup=!1,mxPopupMenu.prototype.enabled=!0,mxPopupMenu.prototype.itemCount=0,mxPopupMenu.prototype.autoExpand=!1,mxPopupMenu.prototype.smartSeparators=!1,mxPopupMenu.prototype.labels=!0,mxPopupMenu.prototype.init=function(){this.table=document.createElement("table"),this.table.className="mxPopupMenu",this.tbody=document.createElement("tbody"),this.table.appendChild(this.tbody),this.div=document.createElement("div"),this.div.className="mxPopupMenu",this.div.style.display="inline",this.div.style.zIndex=this.zIndex,this.div.appendChild(this.table),mxEvent.disableContextMenu(this.div)},mxPopupMenu.prototype.isEnabled=function(){return this.enabled},mxPopupMenu.prototype.setEnabled=function(e){this.enabled=e},mxPopupMenu.prototype.isPopupTrigger=function(e){return e.isPopupTrigger()||this.useLeftButtonForPopup&&mxEvent.isLeftMouseButton(e.getEvent())},mxPopupMenu.prototype.addItem=function(e,t,i,n,o,u,d,p){n=n||this,this.itemCount++,n.willAddSeparator&&(n.containsItems&&this.addSeparator(n,!0),n.willAddSeparator=!1),n.containsItems=!0;var l=document.createElement("tr");l.className="mxPopupMenuItem";var s=document.createElement("td");if(s.className="mxPopupMenuIcon",null!=t){var a=document.createElement("img");a.src=t,s.appendChild(a)}else if(null!=o){var m=document.createElement("div");m.className=o,s.appendChild(m)}if(l.appendChild(s),this.labels){var r=document.createElement("td");r.className="mxPopupMenuItem"+(null==u||u?"":" mxDisabled"),mxUtils.write(r,e),r.align="left",l.appendChild(r);var h=document.createElement("td");h.className="mxPopupMenuItem"+(null==u||u?"":" mxDisabled"),h.style.paddingRight="6px",h.style.textAlign="right",l.appendChild(h),null==n.div&&this.createSubmenu(n)}if(n.tbody.appendChild(l),0!=d&&0!=u){var c=null;mxEvent.addGestureListeners(l,mxUtils.bind(this,function(e){this.eventReceiver=l,n.activeRow!=l&&n.activeRow!=n&&(null!=n.activeRow&&null!=n.activeRow.div.parentNode&&this.hideSubmenu(n),null!=l.div&&(this.showSubmenu(n,l),n.activeRow=l)),mxEvent.consume(e)}),mxUtils.bind(this,function(e){n.activeRow!=l&&n.activeRow!=n&&(null!=n.activeRow&&null!=n.activeRow.div.parentNode&&this.hideSubmenu(n),this.autoExpand&&null!=l.div&&(this.showSubmenu(n,l),n.activeRow=l)),p||(l.className="mxPopupMenuItemHover")}),mxUtils.bind(this,function(e){if(this.eventReceiver==l){if(n.activeRow!=l&&this.hideMenu(),null!=c){try{c.select()}catch(e){}c=null}null!=i&&i(e)}this.eventReceiver=null,mxEvent.consume(e)})),p||mxEvent.addListener(l,"mouseout",mxUtils.bind(this,function(e){l.className="mxPopupMenuItem"}))}return l},mxPopupMenu.prototype.addCheckmark=function(e,t){var i=e.firstChild.nextSibling;i.style.backgroundImage="url('"+t+"')",i.style.backgroundRepeat="no-repeat",i.style.backgroundPosition="2px 50%"},mxPopupMenu.prototype.createSubmenu=function(e){e.table=document.createElement("table"),e.table.className="mxPopupMenu",e.tbody=document.createElement("tbody"),e.table.appendChild(e.tbody),e.div=document.createElement("div"),e.div.className="mxPopupMenu",e.div.style.position="absolute",e.div.style.display="inline",e.div.style.zIndex=this.zIndex,e.div.appendChild(e.table);var t=document.createElement("img");t.setAttribute("src",this.submenuImage),td=e.firstChild.nextSibling.nextSibling,td.appendChild(t)},mxPopupMenu.prototype.showSubmenu=function(e,t){if(null!=t.div){t.div.style.left=e.div.offsetLeft+t.offsetLeft+t.offsetWidth-1+"px",t.div.style.top=e.div.offsetTop+t.offsetTop+"px",document.body.appendChild(t.div);var i=parseInt(t.div.offsetLeft),n=parseInt(t.div.offsetWidth),o=mxUtils.getDocumentScrollOrigin(document),u=document.body,d=document.documentElement;i+n>o.x+(u.clientWidth||d.clientWidth)&&(t.div.style.left=Math.max(0,e.div.offsetLeft-n-6)+"px"),mxUtils.fit(t.div)}},mxPopupMenu.prototype.addSeparator=function(e,t){if(e=e||this,this.smartSeparators&&!t)e.willAddSeparator=!0;else if(null!=e.tbody){e.willAddSeparator=!1;var i=document.createElement("tr"),n=document.createElement("td");n.className="mxPopupMenuIcon",n.style.padding="0 0 0 0px",i.appendChild(n);var o=document.createElement("td");o.style.padding="0 0 0 0px",o.setAttribute("colSpan","2");var u=document.createElement("hr");u.setAttribute("size","1"),o.appendChild(u),i.appendChild(o),e.tbody.appendChild(i)}},mxPopupMenu.prototype.popup=function(e,t,i,n){if(null!=this.div&&null!=this.tbody&&null!=this.factoryMethod){for(this.div.style.left=e+"px",this.div.style.top=t+"px";null!=this.tbody.firstChild;)mxEvent.release(this.tbody.firstChild),this.tbody.removeChild(this.tbody.firstChild);this.itemCount=0,this.factoryMethod(this,i,n),this.itemCount>0&&(this.showMenu(),this.fireEvent(new mxEventObject(mxEvent.SHOW)))}},mxPopupMenu.prototype.isMenuShowing=function(){return null!=this.div&&this.div.parentNode==document.body},mxPopupMenu.prototype.showMenu=function(){document.documentMode>=9&&(this.div.style.filter="none"),document.body.appendChild(this.div),mxUtils.fit(this.div)},mxPopupMenu.prototype.hideMenu=function(){null!=this.div&&(null!=this.div.parentNode&&this.div.parentNode.removeChild(this.div),this.hideSubmenu(this),this.containsItems=!1,this.fireEvent(new mxEventObject(mxEvent.HIDE)))},mxPopupMenu.prototype.hideSubmenu=function(e){null!=e.activeRow&&(this.hideSubmenu(e.activeRow),null!=e.activeRow.div.parentNode&&e.activeRow.div.parentNode.removeChild(e.activeRow.div),e.activeRow=null)},mxPopupMenu.prototype.destroy=function(){null!=this.div&&(mxEvent.release(this.div),null!=this.div.parentNode&&this.div.parentNode.removeChild(this.div),this.div=null)};