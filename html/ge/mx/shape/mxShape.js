function mxShape(t){this.stencil=t,this.initStyles()}mxShape.prototype.dialect=null,mxShape.prototype.scale=1,mxShape.prototype.antiAlias=!0,mxShape.prototype.minSvgStrokeWidth=1,mxShape.prototype.bounds=null,mxShape.prototype.points=null,mxShape.prototype.node=null,mxShape.prototype.state=null,mxShape.prototype.style=null,mxShape.prototype.boundingBox=null,mxShape.prototype.stencil=null,mxShape.prototype.svgStrokeTolerance=8,mxShape.prototype.pointerEvents=!0,mxShape.prototype.svgPointerEvents="all",mxShape.prototype.shapePointerEvents=!1,mxShape.prototype.stencilPointerEvents=!1,mxShape.prototype.vmlScale=1,mxShape.prototype.outline=!1,mxShape.prototype.visible=!0,mxShape.prototype.useSvgBoundingBox=!1,mxShape.prototype.init=function(t){null==this.node&&(this.node=this.create(t),null!=t&&t.appendChild(this.node))},mxShape.prototype.initStyles=function(t){this.strokewidth=1,this.rotation=0,this.opacity=100,this.fillOpacity=100,this.strokeOpacity=100,this.flipH=!1,this.flipV=!1},mxShape.prototype.isParseVml=function(){return!0},mxShape.prototype.isHtmlAllowed=function(){return!1},mxShape.prototype.getSvgScreenOffset=function(){var t=this.stencil&&"inherit"!=this.stencil.strokewidth?Number(this.stencil.strokewidth):this.strokewidth;return 1==mxUtils.mod(Math.max(1,Math.round(t*this.scale)),2)?.5:0},mxShape.prototype.create=function(t){return null!=t&&null!=t.ownerSVGElement?this.createSvg(t):!GE.IS_VML||this.dialect!=mxConstants.DIALECT_VML&&this.isHtmlAllowed()?this.createHtml(t):this.createVml(t)},mxShape.prototype.createSvg=function(){return document.createElementNS(mxConstants.NS_SVG,"g")},mxShape.prototype.createVml=function(){var t=document.createElement(GE.VML_PREFIX+":group");return t.style.position="absolute",t},mxShape.prototype.createHtml=function(){var t=document.createElement("div");return t.style.position="absolute",t},mxShape.prototype.reconfigure=function(){this.redraw()},mxShape.prototype.redraw=function(){this.updateBoundsFromPoints(),this.visible&&this.checkBounds()?(this.node.style.visibility="visible",this.clear(),"DIV"!=this.node.nodeName||!this.isHtmlAllowed()&&GE.IS_VML?this.redrawShape():this.redrawHtmlShape(),this.updateBoundingBox()):(this.node.style.visibility="hidden",this.boundingBox=null)},mxShape.prototype.clear=function(){if(null!=this.node.ownerSVGElement)for(;null!=this.node.lastChild;)this.node.removeChild(this.node.lastChild);else this.node.style.cssText="position:absolute;"+(null!=this.cursor?"cursor:"+this.cursor+";":""),this.node.innerHTML=""},mxShape.prototype.updateBoundsFromPoints=function(){var t=this.points;if(null!=t&&t.length>0&&null!=t[0]){this.bounds=new mxRectangle(Number(t[0].x),Number(t[0].y),1,1);for(var e=1;e<this.points.length;e++)null!=t[e]&&this.bounds.add(new mxRectangle(Number(t[e].x),Number(t[e].y),1,1))}},mxShape.prototype.getLabelBounds=function(t){var e=mxUtils.getValue(this.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST),s=t;if(e!=mxConstants.DIRECTION_SOUTH&&e!=mxConstants.DIRECTION_NORTH&&null!=this.state&&null!=this.state.text&&this.state.text.isPaintBoundsInverted()){var i=(s=s.clone()).width;s.width=s.height,s.height=i}var n=this.getLabelMargins(s);if(null!=n){var o="1"==mxUtils.getValue(this.style,mxConstants.STYLE_FLIPH,!1),a="1"==mxUtils.getValue(this.style,mxConstants.STYLE_FLIPV,!1);if(null!=this.state&&null!=this.state.text&&this.state.text.isPaintBoundsInverted()){i=n.x;n.x=n.height,n.height=n.width,n.width=n.y,n.y=i,i=o,o=a,a=i}return mxUtils.getDirectedBounds(t,n,this.style,o,a)}return t},mxShape.prototype.getLabelMargins=function(t){return null},mxShape.prototype.checkBounds=function(){return!isNaN(this.scale)&&isFinite(this.scale)&&this.scale>0&&null!=this.bounds&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)&&this.bounds.width>0&&this.bounds.height>0},mxShape.prototype.createVmlGroup=function(){var t=document.createElement(GE.VML_PREFIX+":group");return t.style.position="absolute",t.style.width=this.node.style.width,t.style.height=this.node.style.height,t},mxShape.prototype.redrawShape=function(){var t=this.createCanvas();null!=t&&(t.pointerEvents=this.pointerEvents,this.paint(t),this.node!=t.root&&this.node.insertAdjacentHTML("beforeend",t.root.outerHTML),this.destroyCanvas(t))},mxShape.prototype.createCanvas=function(){var t=null;return null!=this.node.ownerSVGElement?t=this.createSvgCanvas():GE.IS_VML&&(this.updateVmlContainer(),t=this.createVmlCanvas()),null!=t&&this.outline&&(t.setStrokeWidth(this.strokewidth),t.setStrokeColor(this.stroke),null!=this.isDashed&&t.setDashed(this.isDashed),t.setStrokeWidth=function(){},t.setStrokeColor=function(){},t.setFillColor=function(){},t.setGradient=function(){},t.setDashed=function(){},t.text=function(){}),t},mxShape.prototype.createSvgCanvas=function(){var t=new mxSvgCanvas2D(this.node,!1);t.strokeTolerance=this.pointerEvents?this.svgStrokeTolerance:0,t.pointerEventsValue=this.svgPointerEvents;var e=this.getSvgScreenOffset();return 0!=e?this.node.setAttribute("transform","translate("+e+","+e+")"):this.node.removeAttribute("transform"),t.minStrokeWidth=this.minSvgStrokeWidth,this.antiAlias||(t.format=function(t){return Math.round(parseFloat(t))}),t},mxShape.prototype.createVmlCanvas=function(){var t=this.node,e=new mxVmlCanvas2D(t,!1);if(""!=t.tagUrn){var s=Math.max(1,Math.round(this.bounds.width)),i=Math.max(1,Math.round(this.bounds.height));t.coordsize=s*this.vmlScale+","+i*this.vmlScale,e.scale(this.vmlScale),e.vmlScale=this.vmlScale}var n=this.scale;return e.translate(-Math.round(this.bounds.x/n),-Math.round(this.bounds.y/n)),e},mxShape.prototype.updateVmlContainer=function(){this.node.style.left=Math.round(this.bounds.x)+"px",this.node.style.top=Math.round(this.bounds.y)+"px";var t=Math.max(1,Math.round(this.bounds.width)),e=Math.max(1,Math.round(this.bounds.height));this.node.style.width=t+"px",this.node.style.height=e+"px",this.node.style.overflow="visible"},mxShape.prototype.redrawHtmlShape=function(){this.updateHtmlBounds(this.node),this.updateHtmlFilters(this.node),this.updateHtmlColors(this.node)},mxShape.prototype.updateHtmlFilters=function(t){var e="";if(this.opacity<100&&(e+="alpha(opacity="+this.opacity+")"),this.isShadow&&(e+="progid:DXImageTransform.Microsoft.dropShadow (OffX='"+Math.round(mxConstants.SHADOW_OFFSET_X*this.scale)+"', OffY='"+Math.round(mxConstants.SHADOW_OFFSET_Y*this.scale)+"', Color='"+mxConstants.VML_SHADOWCOLOR+"')"),null!=this.fill&&this.fill!=mxConstants.NONE&&this.gradient&&this.gradient!=mxConstants.NONE){var s=this.fill,i=this.gradient,n="0",o={east:0,south:1,west:2,north:3},a=null!=this.direction?o[this.direction]:0;if(null!=this.gradientDirection&&(a=mxUtils.mod(a+o[this.gradientDirection]-1,4)),1==a){n="1";var h=s;s=i,i=h}else if(2==a){h=s;s=i,i=h}else 3==a&&(n="1");e+="progid:DXImageTransform.Microsoft.gradient(startColorStr='"+s+"', endColorStr='"+i+"', gradientType='"+n+"')"}t.style.filter=e},mxShape.prototype.updateHtmlColors=function(t){var e=this.stroke;null!=e&&e!=mxConstants.NONE?(t.style.borderColor=e,this.isDashed?t.style.borderStyle="dashed":this.strokewidth>0&&(t.style.borderStyle="solid"),t.style.borderWidth=Math.max(1,Math.ceil(this.strokewidth*this.scale))+"px"):t.style.borderWidth="0px",null!=(e=this.outline?null:this.fill)&&e!=mxConstants.NONE?(t.style.backgroundColor=e,t.style.backgroundImage="none"):this.pointerEvents?t.style.backgroundColor="transparent":this.setTransparentBackgroundImage(t)},mxShape.prototype.updateHtmlBounds=function(t){var e=document.documentMode>=9?0:Math.ceil(this.strokewidth*this.scale);t.style.borderWidth=Math.max(1,e)+"px",t.style.overflow="hidden",t.style.left=Math.round(this.bounds.x-e/2)+"px",t.style.top=Math.round(this.bounds.y-e/2)+"px","CSS1Compat"==document.compatMode&&(e=-e),t.style.width=Math.round(Math.max(0,this.bounds.width+e))+"px",t.style.height=Math.round(Math.max(0,this.bounds.height+e))+"px"},mxShape.prototype.destroyCanvas=function(t){if(t instanceof mxSvgCanvas2D){for(var e in t.gradients){var s=t.gradients[e];null!=s&&(s.mxRefCount=(s.mxRefCount||0)+1)}this.releaseSvgGradients(this.oldGradients),this.oldGradients=t.gradients}},mxShape.prototype.paint=function(t){var e=!1;if(null!=t&&this.outline){var s=t.stroke;t.stroke=function(){e=!0,s.apply(this,arguments)};var i=t.fillAndStroke;t.fillAndStroke=function(){e=!0,i.apply(this,arguments)}}var n=this.scale,o=this.bounds.x/n,a=this.bounds.y/n,h=this.bounds.width/n,l=this.bounds.height/n;if(this.isPaintBoundsInverted()){var r=(h-l)/2;o+=r,a-=r;var d=h;h=l,l=d}this.updateTransform(t,o,a,h,l),this.configureCanvas(t,o,a,h,l);var u=null;if(null==this.stencil&&null==this.points&&this.shapePointerEvents||null!=this.stencil&&this.stencilPointerEvents){var p=this.createBoundingBox();if(this.dialect==mxConstants.DIALECT_SVG)u=this.createTransparentSvgRectangle(p.x,p.y,p.width,p.height),this.node.appendChild(u);else{var m=t.createRect("rect",p.x/n,p.y/n,p.width/n,p.height/n);m.appendChild(t.createTransparentFill()),m.stroked="false",t.root.appendChild(m)}}if(null!=this.stencil)this.stencil.drawShape(t,this,o,a,h,l);else if(t.setStrokeWidth(this.strokewidth),null!=this.points){for(var x=[],c=0;c<this.points.length;c++)null!=this.points[c]&&x.push(new mxPoint(this.points[c].x/n,this.points[c].y/n));this.paintEdgeShape(t,x)}else this.paintVertexShape(t,o,a,h,l);null!=u&&null!=t.state&&null!=t.state.transform&&u.setAttribute("transform",t.state.transform),null!=t&&this.outline&&!e&&(t.rect(o,a,h,l),t.stroke())},mxShape.prototype.configureCanvas=function(t,e,s,i,n){var o=null;if(null!=this.style&&(o=this.style.dashPattern),t.setAlpha(this.opacity/100),t.setFillAlpha(this.fillOpacity/100),t.setStrokeAlpha(this.strokeOpacity/100),null!=this.isShadow&&t.setShadow(this.isShadow),null!=this.isDashed&&t.setDashed(this.isDashed,null!=this.style&&1==mxUtils.getValue(this.style,mxConstants.STYLE_FIX_DASH,!1)),null!=o&&t.setDashPattern(o),null!=this.fill&&this.fill!=mxConstants.NONE&&this.gradient&&this.gradient!=mxConstants.NONE){var a=this.getGradientBounds(t,e,s,i,n);t.setGradient(this.fill,this.gradient,a.x,a.y,a.width,a.height,this.gradientDirection)}else t.setFillColor(this.fill);t.setStrokeColor(this.stroke)},mxShape.prototype.getGradientBounds=function(t,e,s,i,n){return new mxRectangle(e,s,i,n)},mxShape.prototype.updateTransform=function(t,e,s,i,n){t.scale(this.scale),t.rotate(this.getShapeRotation(),this.flipH,this.flipV,e+i/2,s+n/2)},mxShape.prototype.paintVertexShape=function(t,e,s,i,n){this.paintBackground(t,e,s,i,n),this.outline&&null!=this.style&&0!=mxUtils.getValue(this.style,mxConstants.STYLE_BACKGROUND_OUTLINE,0)||(t.setShadow(!1),this.paintForeground(t,e,s,i,n))},mxShape.prototype.paintBackground=function(t,e,s,i,n){},mxShape.prototype.paintForeground=function(t,e,s,i,n){},mxShape.prototype.paintEdgeShape=function(t,e){},mxShape.prototype.getArcSize=function(t,e){var s=0;if("1"==mxUtils.getValue(this.style,mxConstants.STYLE_ABSOLUTE_ARCSIZE,0))s=Math.min(t/2,Math.min(e/2,mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2));else{var i=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,100*mxConstants.RECTANGLE_ROUNDING_FACTOR)/100;s=Math.min(t*i,e*i)}return s},mxShape.prototype.paintGlassEffect=function(t,e,s,i,n,o){var a=Math.ceil(this.strokewidth/2);t.setGradient("#ffffff","#ffffff",e,s,i,.6*n,"south",.9,.1),t.begin(),o+=2*a,this.isRounded?(t.moveTo(e-a+o,s-a),t.quadTo(e-a,s-a,e-a,s-a+o),t.lineTo(e-a,s+.4*n),t.quadTo(e+.5*i,s+.7*n,e+i+a,s+.4*n),t.lineTo(e+i+a,s-a+o),t.quadTo(e+i+a,s-a,e+i+a-o,s-a)):(t.moveTo(e-a,s-a),t.lineTo(e-a,s+.4*n),t.quadTo(e+.5*i,s+.7*n,e+i+a,s+.4*n),t.lineTo(e+i+a,s-a)),t.close(),t.fill()},mxShape.prototype.addPoints=function(t,e,s,i,n,o,a){if(null!=e&&e.length>0){a=null==a||a;var h=e[e.length-1];if(n&&s){var l=(e=e.slice())[0],r=new mxPoint(h.x+(l.x-h.x)/2,h.y+(l.y-h.y)/2);e.splice(0,0,r)}var d=e[0],u=1;for(a?t.moveTo(d.x,d.y):t.lineTo(d.x,d.y);u<(n?e.length:e.length-1);){var p=e[mxUtils.mod(u,e.length)],m=d.x-p.x,x=d.y-p.y;if(s&&(0!=m||0!=x)&&(null==o||mxUtils.indexOf(o,u-1)<0)){var c=Math.sqrt(m*m+x*x),S=m*Math.min(i,c/2)/c,y=x*Math.min(i,c/2)/c,g=p.x+S,f=p.y+y;t.lineTo(g,f);for(var C=e[mxUtils.mod(u+1,e.length)];u<e.length-2&&0==Math.round(C.x-p.x)&&0==Math.round(C.y-p.y);)C=e[mxUtils.mod(u+2,e.length)],u++;m=C.x-p.x,x=C.y-p.y,c=Math.max(1,Math.sqrt(m*m+x*x));var v=m*Math.min(i,c/2)/c,T=x*Math.min(i,c/2)/c,E=p.x+v,O=p.y+T;t.quadTo(p.x,p.y,E,O),p=new mxPoint(E,O)}else t.lineTo(p.x,p.y);d=p,u++}n?t.close():t.lineTo(h.x,h.y)}},mxShape.prototype.resetStyles=function(){this.initStyles(),this.spacing=0,delete this.fill,delete this.gradient,delete this.gradientDirection,delete this.stroke,delete this.startSize,delete this.endSize,delete this.startArrow,delete this.endArrow,delete this.direction,delete this.isShadow,delete this.isDashed,delete this.isRounded,delete this.glass},mxShape.prototype.apply=function(t){if(this.state=t,this.style=t.style,null!=this.style){if(this.fill=mxUtils.getValue(this.style,mxConstants.STYLE_FILLCOLOR,this.fill),this.gradient=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENTCOLOR,this.gradient),this.gradientDirection=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENT_DIRECTION,this.gradientDirection),this.opacity=mxUtils.getValue(this.style,mxConstants.STYLE_OPACITY,this.opacity),this.fillOpacity=mxUtils.getValue(this.style,mxConstants.STYLE_FILL_OPACITY,this.fillOpacity),this.strokeOpacity=mxUtils.getValue(this.style,mxConstants.STYLE_STROKE_OPACITY,this.strokeOpacity),this.stroke=mxUtils.getValue(this.style,mxConstants.STYLE_STROKECOLOR,this.stroke),this.strokewidth=mxUtils.getNumber(this.style,mxConstants.STYLE_STROKEWIDTH,this.strokewidth),this.spacing=mxUtils.getValue(this.style,mxConstants.STYLE_SPACING,this.spacing),this.startSize=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,this.startSize),this.endSize=mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,this.endSize),this.startArrow=mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,this.startArrow),this.endArrow=mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,this.endArrow),this.rotation=mxUtils.getValue(this.style,mxConstants.STYLE_ROTATION,this.rotation),this.direction=mxUtils.getValue(this.style,mxConstants.STYLE_DIRECTION,this.direction),this.flipH=1==mxUtils.getValue(this.style,mxConstants.STYLE_FLIPH,0),this.flipV=1==mxUtils.getValue(this.style,mxConstants.STYLE_FLIPV,0),null!=this.stencil&&(this.flipH=1==mxUtils.getValue(this.style,"stencilFlipH",0)||this.flipH,this.flipV=1==mxUtils.getValue(this.style,"stencilFlipV",0)||this.flipV),this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH){var e=this.flipH;this.flipH=this.flipV,this.flipV=e}this.isShadow=1==mxUtils.getValue(this.style,mxConstants.STYLE_SHADOW,this.isShadow),this.isDashed=1==mxUtils.getValue(this.style,mxConstants.STYLE_DASHED,this.isDashed),this.isRounded=1==mxUtils.getValue(this.style,mxConstants.STYLE_ROUNDED,this.isRounded),this.glass=1==mxUtils.getValue(this.style,mxConstants.STYLE_GLASS,this.glass),this.fill==mxConstants.NONE&&(this.fill=null),this.gradient==mxConstants.NONE&&(this.gradient=null),this.stroke==mxConstants.NONE&&(this.stroke=null)}},mxShape.prototype.setCursor=function(t){null==t&&(t=""),this.cursor=t,null!=this.node&&(this.node.style.cursor=t)},mxShape.prototype.getCursor=function(){return this.cursor},mxShape.prototype.isRoundable=function(){return!1},mxShape.prototype.updateBoundingBox=function(){if(this.useSvgBoundingBox&&null!=this.node&&null!=this.node.ownerSVGElement)try{var t=this.node.getBBox();if(t.width>0&&t.height>0)return this.boundingBox=new mxRectangle(t.x,t.y,t.width,t.height),void this.boundingBox.grow(this.strokewidth*this.scale/2)}catch(t){}if(null!=this.bounds){var e=this.createBoundingBox();if(null!=e){this.augmentBoundingBox(e);var s=this.getShapeRotation();0!=s&&(e=mxUtils.getBoundingBox(e,s))}this.boundingBox=e}},mxShape.prototype.createBoundingBox=function(){var t=this.bounds.clone();return(null!=this.stencil&&(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH)||this.isPaintBoundsInverted())&&t.rotate90(),t},mxShape.prototype.augmentBoundingBox=function(t){this.isShadow&&(t.width+=Math.ceil(mxConstants.SHADOW_OFFSET_X*this.scale),t.height+=Math.ceil(mxConstants.SHADOW_OFFSET_Y*this.scale)),t.grow(this.strokewidth*this.scale/2)},mxShape.prototype.isPaintBoundsInverted=function(){return null==this.stencil&&(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH)},mxShape.prototype.getRotation=function(){return null!=this.rotation?this.rotation:0},mxShape.prototype.getTextRotation=function(){var t=this.getRotation();return 1!=mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)&&(t+=mxText.prototype.verticalTextRotation),t},mxShape.prototype.getShapeRotation=function(){var t=this.getRotation();return null!=this.direction&&(this.direction==mxConstants.DIRECTION_NORTH?t+=270:this.direction==mxConstants.DIRECTION_WEST?t+=180:this.direction==mxConstants.DIRECTION_SOUTH&&(t+=90)),t},mxShape.prototype.createTransparentSvgRectangle=function(t,e,s,i){var n=document.createElementNS(mxConstants.NS_SVG,"rect");return n.setAttribute("x",t),n.setAttribute("y",e),n.setAttribute("width",s),n.setAttribute("height",i),n.setAttribute("fill","none"),n.setAttribute("stroke","none"),n.setAttribute("pointer-events","all"),n},mxShape.prototype.setTransparentBackgroundImage=function(t){t.style.backgroundImage="url('"+GE.imageBasePath+"/transparent.gif')"},mxShape.prototype.releaseSvgGradients=function(t){if(null!=t)for(var e in t){var s=t[e];null!=s&&(s.mxRefCount=(s.mxRefCount||0)-1,0==s.mxRefCount&&null!=s.parentNode&&s.parentNode.removeChild(s))}},mxShape.prototype.destroy=function(){null!=this.node&&(mxEvent.release(this.node),null!=this.node.parentNode&&this.node.parentNode.removeChild(this.node),this.node=null),this.releaseSvgGradients(this.oldGradients),this.oldGradients=null};